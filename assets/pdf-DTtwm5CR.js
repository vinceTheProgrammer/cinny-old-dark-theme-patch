var oo=Object.defineProperty;var ho=(Ne,ke,Pe)=>ke in Ne?oo(Ne,ke,{enumerable:!0,configurable:!0,writable:!0,value:Pe}):Ne[ke]=Pe;var Ae=(Ne,ke,Pe)=>(ho(Ne,typeof ke!="symbol"?ke+"":ke,Pe),Pe),rn=(Ne,ke,Pe)=>{if(!ke.has(Ne))throw TypeError("Cannot "+Pe)};var t=(Ne,ke,Pe)=>(rn(Ne,ke,"read from private field"),Pe?Pe.call(Ne):ke.get(Ne)),r=(Ne,ke,Pe)=>{if(ke.has(Ne))throw TypeError("Cannot add the same private member more than once");ke instanceof WeakSet?ke.add(Ne):ke.set(Ne,Pe)},w=(Ne,ke,Pe,oe)=>(rn(Ne,ke,"write to private field"),oe?oe.call(Ne,Pe):ke.set(Ne,Pe),Pe);var ps=(Ne,ke,Pe,oe)=>({set _(le){w(Ne,ke,le,Pe)},get _(){return t(Ne,ke,oe)}}),v=(Ne,ke,Pe)=>(rn(Ne,ke,"access private method"),Pe);import{t as ir,a1 as vs,__tla as lo}from"./index-J3ZDATS2.js";let nr,rr,ar,or,hr,lr,cr,dr,ur,pr,gr,fr,mr,Ar,br,vr,yr,wr,Er,_r,xr,Sr,Cr,Tr,Mr,Rr,Lr,kr,Pr,Ir,Dr,Fr,Nr,Or,Br,Ur,Hr,zr,Vr,jr,qr,Gr,Wr,$r,Xr,co=Promise.all([(()=>{try{return lo}catch{}})()]).then(async()=>{var Ne={976:(le,Wt,ut)=>{var ce,fe,ne,an,Yt,Rs,te,Kr,s,Yr,a,l,n,g,u,p,b,d,o,h,x,S,K,Y,gt,mt,ot,At,Jr,R,Di,W,on,J,hn,P,H,ht,Et,Tt,Bt,Zt,ln,me,Ee,de,Me,Qr,ze,cn;ut.d(Wt,{AnnotationLayer:()=>Oe,FreeTextAnnotationElement:()=>Ct,InkAnnotationElement:()=>St,StampAnnotationElement:()=>he});var c=ut(292),at=ut(419),U=ut(792);function nt(Jt){return Math.floor(Math.max(0,Math.min(1,Jt))*255).toString(16).padStart(2,"0")}function bt(Jt){return Math.max(0,Math.min(255,255*Jt))}class V{static CMYK_G([m,f,B,Z]){return["G",1-Math.min(1,.3*m+.59*B+.11*f+Z)]}static G_CMYK([m]){return["CMYK",0,0,0,1-m]}static G_RGB([m]){return["RGB",m,m,m]}static G_rgb([m]){return m=bt(m),[m,m,m]}static G_HTML([m]){const f=nt(m);return`#${f}${f}${f}`}static RGB_G([m,f,B]){return["G",.3*m+.59*f+.11*B]}static RGB_rgb(m){return m.map(bt)}static RGB_HTML(m){return`#${m.map(nt).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([m,f,B,Z]){return["RGB",1-Math.min(1,m+Z),1-Math.min(1,B+Z),1-Math.min(1,f+Z)]}static CMYK_rgb([m,f,B,Z]){return[bt(1-Math.min(1,m+Z)),bt(1-Math.min(1,B+Z)),bt(1-Math.min(1,f+Z))]}static CMYK_HTML(m){const f=this.CMYK_RGB(m).slice(1);return this.RGB_HTML(f)}static RGB_CMYK([m,f,B]){const Z=1-m,st=1-f,dt=1-B,ft=Math.min(Z,st,dt);return["CMYK",Z,st,dt,ft]}}var O=ut(284);const k=1e3,j=9,I=new WeakSet;function C(Jt){return{width:Jt[2]-Jt[0],height:Jt[3]-Jt[1]}}class F{static create(m){switch(m.data.annotationType){case c.AnnotationType.LINK:return new z(m);case c.AnnotationType.TEXT:return new pt(m);case c.AnnotationType.WIDGET:switch(m.data.fieldType){case"Tx":return new L(m);case"Btn":return m.data.radioButton?new M(m):m.data.checkBox?new T(m):new $(m);case"Ch":return new et(m);case"Sig":return new N(m)}return new tt(m);case c.AnnotationType.POPUP:return new wt(m);case c.AnnotationType.FREETEXT:return new Ct(m);case c.AnnotationType.LINE:return new Nt(m);case c.AnnotationType.SQUARE:return new Mt(m);case c.AnnotationType.CIRCLE:return new qt(m);case c.AnnotationType.POLYLINE:return new $t(m);case c.AnnotationType.CARET:return new it(m);case c.AnnotationType.INK:return new St(m);case c.AnnotationType.POLYGON:return new Kt(m);case c.AnnotationType.HIGHLIGHT:return new Gt(m);case c.AnnotationType.UNDERLINE:return new zt(m);case c.AnnotationType.SQUIGGLY:return new ie(m);case c.AnnotationType.STRIKEOUT:return new ae(m);case c.AnnotationType.STAMP:return new he(m);case c.AnnotationType.FILEATTACHMENT:return new ye(m);default:return new D(m)}}}const Re=class Re{constructor(m,{isRenderable:f=!1,ignoreBorder:B=!1,createQuadrilaterals:Z=!1}={}){r(this,ne);r(this,ce,null);r(this,fe,!1);this.isRenderable=f,this.data=m.data,this.layer=m.layer,this.linkService=m.linkService,this.downloadManager=m.downloadManager,this.imageResourcesPath=m.imageResourcesPath,this.renderForms=m.renderForms,this.svgFactory=m.svgFactory,this.annotationStorage=m.annotationStorage,this.enableScripting=m.enableScripting,this.hasJSActions=m.hasJSActions,this._fieldObjects=m.fieldObjects,this.parent=m.parent,f&&(this.container=this._createContainer(B)),Z&&this._createQuadrilaterals()}static _hasPopupData({titleObj:m,contentsObj:f,richText:B}){return!!(m!=null&&m.str||f!=null&&f.str||B!=null&&B.str)}get hasPopupData(){return Re._hasPopupData(this.data)}updateEdited(m){if(!this.container)return;t(this,ce)||w(this,ce,{rect:this.data.rect.slice(0)});const{rect:f}=m;f&&v(this,ne,an).call(this,f)}resetEdited(){t(this,ce)&&(v(this,ne,an).call(this,t(this,ce).rect),w(this,ce,null))}_createContainer(m){const{data:f,parent:{page:B,viewport:Z}}=this,st=document.createElement("section");st.setAttribute("data-annotation-id",f.id),this instanceof tt||(st.tabIndex=k);const{style:dt}=st;if(dt.zIndex=this.parent.zIndex++,f.popupRef&&st.setAttribute("aria-haspopup","dialog"),f.alternativeText&&(st.title=f.alternativeText),f.noRotate&&st.classList.add("norotate"),!f.rect||this instanceof wt){const{rotation:Xt}=f;return!f.hasOwnCanvas&&Xt!==0&&this.setRotation(Xt,st),st}const{width:ft,height:Ht}=C(f.rect);if(!m&&f.borderStyle.width>0){dt.borderWidth=`${f.borderStyle.width}px`;const Xt=f.borderStyle.horizontalCornerRadius,pe=f.borderStyle.verticalCornerRadius;if(Xt>0||pe>0){const Ce=`calc(${Xt}px * var(--scale-factor)) / calc(${pe}px * var(--scale-factor))`;dt.borderRadius=Ce}else if(this instanceof M){const Ce=`calc(${ft}px * var(--scale-factor)) / calc(${Ht}px * var(--scale-factor))`;dt.borderRadius=Ce}switch(f.borderStyle.style){case c.AnnotationBorderStyleType.SOLID:dt.borderStyle="solid";break;case c.AnnotationBorderStyleType.DASHED:dt.borderStyle="dashed";break;case c.AnnotationBorderStyleType.BEVELED:(0,c.warn)("Unimplemented border style: beveled");break;case c.AnnotationBorderStyleType.INSET:(0,c.warn)("Unimplemented border style: inset");break;case c.AnnotationBorderStyleType.UNDERLINE:dt.borderBottomStyle="solid";break}const ge=f.borderColor||null;ge?(w(this,fe,!0),dt.borderColor=c.Util.makeHexColor(ge[0]|0,ge[1]|0,ge[2]|0)):dt.borderWidth=0}const It=c.Util.normalizeRect([f.rect[0],B.view[3]-f.rect[1]+B.view[1],f.rect[2],B.view[3]-f.rect[3]+B.view[1]]),{pageWidth:yt,pageHeight:Lt,pageX:Ft,pageY:Dt}=Z.rawDims;dt.left=`${100*(It[0]-Ft)/yt}%`,dt.top=`${100*(It[1]-Dt)/Lt}%`;const{rotation:ee}=f;return f.hasOwnCanvas||ee===0?(dt.width=`${100*ft/yt}%`,dt.height=`${100*Ht/Lt}%`):this.setRotation(ee,st),st}setRotation(m,f=this.container){if(!this.data.rect)return;const{pageWidth:B,pageHeight:Z}=this.parent.viewport.rawDims,{width:st,height:dt}=C(this.data.rect);let ft,Ht;m%180===0?(ft=100*st/B,Ht=100*dt/Z):(ft=100*dt/B,Ht=100*st/Z),f.style.width=`${ft}%`,f.style.height=`${Ht}%`,f.setAttribute("data-main-rotation",(360-m)%360)}get _commonActions(){const m=(f,B,Z)=>{const st=Z.detail[f],dt=st[0],ft=st.slice(1);Z.target.style[B]=V[`${dt}_HTML`](ft),this.annotationStorage.setValue(this.data.id,{[B]:V[`${dt}_rgb`](ft)})};return(0,c.shadow)(this,"_commonActions",{display:f=>{const{display:B}=f.detail,Z=B%2===1;this.container.style.visibility=Z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:Z,noPrint:B===1||B===2})},print:f=>{this.annotationStorage.setValue(this.data.id,{noPrint:!f.detail.print})},hidden:f=>{const{hidden:B}=f.detail;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:B,noView:B})},focus:f=>{setTimeout(()=>f.target.focus({preventScroll:!1}),0)},userName:f=>{f.target.title=f.detail.userName},readonly:f=>{f.target.disabled=f.detail.readonly},required:f=>{this._setRequired(f.target,f.detail.required)},bgColor:f=>{m("bgColor","backgroundColor",f)},fillColor:f=>{m("fillColor","backgroundColor",f)},fgColor:f=>{m("fgColor","color",f)},textColor:f=>{m("textColor","color",f)},borderColor:f=>{m("borderColor","borderColor",f)},strokeColor:f=>{m("strokeColor","borderColor",f)},rotation:f=>{const B=f.detail.rotation;this.setRotation(B),this.annotationStorage.setValue(this.data.id,{rotation:B})}})}_dispatchEventFromSandbox(m,f){var Z;const B=this._commonActions;for(const st of Object.keys(f.detail))(Z=m[st]||B[st])==null||Z(f)}_setDefaultPropertiesFromJS(m){if(!this.enableScripting)return;const f=this.annotationStorage.getRawValue(this.data.id);if(!f)return;const B=this._commonActions;for(const[Z,st]of Object.entries(f)){const dt=B[Z];if(dt){const ft={detail:{[Z]:st},target:m};dt(ft),delete f[Z]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:m}=this.data;if(!m)return;const[f,B,Z,st]=this.data.rect;if(m.length===1){const[,{x:Xt,y:pe},{x:ge,y:Ce}]=m[0];if(Z===Xt&&st===pe&&f===ge&&B===Ce)return}const{style:dt}=this.container;let ft;if(t(this,fe)){const{borderColor:Xt,borderWidth:pe}=dt;dt.borderWidth=0,ft=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Xt}" stroke-width="${pe}">`],this.container.classList.add("hasBorder")}const Ht=Z-f,It=st-B,{svgFactory:yt}=this,Lt=yt.createElement("svg");Lt.classList.add("quadrilateralsContainer"),Lt.setAttribute("width",0),Lt.setAttribute("height",0);const Ft=yt.createElement("defs");Lt.append(Ft);const Dt=yt.createElement("clipPath"),ee=`clippath_${this.data.id}`;Dt.setAttribute("id",ee),Dt.setAttribute("clipPathUnits","objectBoundingBox"),Ft.append(Dt);for(const[,{x:Xt,y:pe},{x:ge,y:Ce}]of m){const Ie=yt.createElement("rect"),is=(ge-f)/Ht,qe=(st-pe)/It,We=(Xt-ge)/Ht,_=(pe-Ce)/It;Ie.setAttribute("x",is),Ie.setAttribute("y",qe),Ie.setAttribute("width",We),Ie.setAttribute("height",_),Dt.append(Ie),ft==null||ft.push(`<rect vector-effect="non-scaling-stroke" x="${is}" y="${qe}" width="${We}" height="${_}"/>`)}t(this,fe)&&(ft.push("</g></svg>')"),dt.backgroundImage=ft.join("")),this.container.append(Lt),this.container.style.clipPath=`url(#${ee})`}_createPopup(){const{container:m,data:f}=this;m.setAttribute("aria-haspopup","dialog");const B=new wt({data:{color:f.color,titleObj:f.titleObj,modificationDate:f.modificationDate,contentsObj:f.contentsObj,richText:f.richText,parentRect:f.rect,borderStyle:0,id:`popup_${f.id}`,rotation:f.rotation},parent:this.parent,elements:[this]});this.parent.div.append(B.render())}render(){(0,c.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(m,f=null){const B=[];if(this._fieldObjects){const Z=this._fieldObjects[m];if(Z)for(const{page:st,id:dt,exportValues:ft}of Z){if(st===-1||dt===f)continue;const Ht=typeof ft=="string"?ft:null,It=document.querySelector(`[data-element-id="${dt}"]`);if(It&&!I.has(It)){(0,c.warn)(`_getElementsByName - element not allowed: ${dt}`);continue}B.push({id:dt,exportValue:Ht,domElement:It})}return B}for(const Z of document.getElementsByName(m)){const{exportValue:st}=Z,dt=Z.getAttribute("data-element-id");dt!==f&&I.has(Z)&&B.push({id:dt,exportValue:st,domElement:Z})}return B}show(){var m;this.container&&(this.container.hidden=!1),(m=this.popup)==null||m.maybeShow()}hide(){var m;this.container&&(this.container.hidden=!0),(m=this.popup)==null||m.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const m=this.getElementsToTriggerPopup();if(Array.isArray(m))for(const f of m)f.classList.add("highlightArea");else m.classList.add("highlightArea")}get _isEditable(){return!1}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:m,data:{id:f}}=this;this.container.addEventListener("dblclick",()=>{var B;(B=this.linkService.eventBus)==null||B.dispatch("switchannotationeditormode",{source:this,mode:m,editId:f})})}};ce=new WeakMap,fe=new WeakMap,ne=new WeakSet,an=function(m){const{container:{style:f},data:{rect:B,rotation:Z},parent:{viewport:{rawDims:{pageWidth:st,pageHeight:dt,pageX:ft,pageY:Ht}}}}=this;B==null||B.splice(0,4,...m);const{width:It,height:yt}=C(m);f.left=`${100*(m[0]-ft)/st}%`,f.top=`${100*(dt-m[3]+Ht)/dt}%`,Z===0?(f.width=`${100*It/st}%`,f.height=`${100*yt/dt}%`):this.setRotation(Z)};let D=Re;class z extends D{constructor(f,B=null){super(f,{isRenderable:!0,ignoreBorder:!!(B!=null&&B.ignoreBorder),createQuadrilaterals:!0});r(this,Yt);r(this,te);r(this,s);this.isTooltipOnly=f.data.isTooltipOnly}render(){const{data:f,linkService:B}=this,Z=document.createElement("a");Z.setAttribute("data-element-id",f.id);let st=!1;return f.url?(B.addLinkAttributes(Z,f.url,f.newWindow),st=!0):f.action?(this._bindNamedAction(Z,f.action),st=!0):f.attachment?(v(this,te,Kr).call(this,Z,f.attachment,f.attachmentDest),st=!0):f.setOCGState?(v(this,s,Yr).call(this,Z,f.setOCGState),st=!0):f.dest?(this._bindLink(Z,f.dest),st=!0):(f.actions&&(f.actions.Action||f.actions["Mouse Up"]||f.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(Z,f),st=!0),f.resetForm?(this._bindResetFormAction(Z,f.resetForm),st=!0):this.isTooltipOnly&&!st&&(this._bindLink(Z,""),st=!0)),this.container.classList.add("linkAnnotation"),st&&this.container.append(Z),this.container}_bindLink(f,B){f.href=this.linkService.getDestinationHash(B),f.onclick=()=>(B&&this.linkService.goToDestination(B),!1),(B||B==="")&&v(this,Yt,Rs).call(this)}_bindNamedAction(f,B){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>(this.linkService.executeNamedAction(B),!1),v(this,Yt,Rs).call(this)}_bindJSAction(f,B){f.href=this.linkService.getAnchorUrl("");const Z=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const st of Object.keys(B.actions)){const dt=Z.get(st);dt&&(f[dt]=()=>{var ft;return(ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B.id,name:st}}),!1})}f.onclick||(f.onclick=()=>!1),v(this,Yt,Rs).call(this)}_bindResetFormAction(f,B){const Z=f.onclick;if(Z||(f.href=this.linkService.getAnchorUrl("")),v(this,Yt,Rs).call(this),!this._fieldObjects){(0,c.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),Z||(f.onclick=()=>!1);return}f.onclick=()=>{var Lt;Z==null||Z();const{fields:st,refs:dt,include:ft}=B,Ht=[];if(st.length!==0||dt.length!==0){const Ft=new Set(dt);for(const Dt of st){const ee=this._fieldObjects[Dt]||[];for(const{id:Xt}of ee)Ft.add(Xt)}for(const Dt of Object.values(this._fieldObjects))for(const ee of Dt)Ft.has(ee.id)===ft&&Ht.push(ee)}else for(const Ft of Object.values(this._fieldObjects))Ht.push(...Ft);const It=this.annotationStorage,yt=[];for(const Ft of Ht){const{id:Dt}=Ft;switch(yt.push(Dt),Ft.type){case"text":{const Xt=Ft.defaultValue||"";It.setValue(Dt,{value:Xt});break}case"checkbox":case"radiobutton":{const Xt=Ft.defaultValue===Ft.exportValues;It.setValue(Dt,{value:Xt});break}case"combobox":case"listbox":{const Xt=Ft.defaultValue||"";It.setValue(Dt,{value:Xt});break}default:continue}const ee=document.querySelector(`[data-element-id="${Dt}"]`);if(ee){if(!I.has(ee)){(0,c.warn)(`_bindResetFormAction - element not allowed: ${Dt}`);continue}}else continue;ee.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Lt=this.linkService.eventBus)==null||Lt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:yt,name:"ResetForm"}})),!1}}}Yt=new WeakSet,Rs=function(){this.container.setAttribute("data-internal-link","")},te=new WeakSet,Kr=function(f,B,Z=null){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>{var st;return(st=this.downloadManager)==null||st.openOrDownloadData(B.content,B.filename,Z),!1},v(this,Yt,Rs).call(this)},s=new WeakSet,Yr=function(f,B){f.href=this.linkService.getAnchorUrl(""),f.onclick=()=>(this.linkService.executeSetOCGState(B),!1),v(this,Yt,Rs).call(this)};class pt extends D{constructor(m){super(m,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const m=document.createElement("img");return m.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",m.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),m.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(m),this.container}}class tt extends D{render(){return this.container}showElementAndHideCanvas(m){var f;this.data.hasOwnCanvas&&(((f=m.previousSibling)==null?void 0:f.nodeName)==="CANVAS"&&(m.previousSibling.hidden=!0),m.hidden=!1)}_getKeyModifier(m){return c.FeatureTest.platform.isMac?m.metaKey:m.ctrlKey}_setEventListener(m,f,B,Z,st){B.includes("mouse")?m.addEventListener(B,dt=>{var ft;(ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:st(dt),shift:dt.shiftKey,modifier:this._getKeyModifier(dt)}})}):m.addEventListener(B,dt=>{var ft;if(B==="blur"){if(!f.focused||!dt.relatedTarget)return;f.focused=!1}else if(B==="focus"){if(f.focused)return;f.focused=!0}st&&((ft=this.linkService.eventBus)==null||ft.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:Z,value:st(dt)}}))})}_setEventListeners(m,f,B,Z){var st,dt,ft;for(const[Ht,It]of B)(It==="Action"||(st=this.data.actions)!=null&&st[It])&&((It==="Focus"||It==="Blur")&&(f||(f={focused:!1})),this._setEventListener(m,f,Ht,It,Z),It==="Focus"&&!((dt=this.data.actions)!=null&&dt.Blur)?this._setEventListener(m,f,"blur","Blur",null):It==="Blur"&&!((ft=this.data.actions)!=null&&ft.Focus)&&this._setEventListener(m,f,"focus","Focus",null))}_setBackgroundColor(m){const f=this.data.backgroundColor||null;m.style.backgroundColor=f===null?"transparent":c.Util.makeHexColor(f[0],f[1],f[2])}_setTextStyle(m){const f=["left","center","right"],{fontColor:B}=this.data.defaultAppearanceData,Z=this.data.defaultAppearanceData.fontSize||j,st=m.style;let dt;const ft=2,Ht=It=>Math.round(10*It)/10;if(this.data.multiLine){const It=Math.abs(this.data.rect[3]-this.data.rect[1]-ft),yt=Math.round(It/(c.LINE_FACTOR*Z))||1,Lt=It/yt;dt=Math.min(Z,Ht(Lt/c.LINE_FACTOR))}else{const It=Math.abs(this.data.rect[3]-this.data.rect[1]-ft);dt=Math.min(Z,Ht(It/c.LINE_FACTOR))}st.fontSize=`calc(${dt}px * var(--scale-factor))`,st.color=c.Util.makeHexColor(B[0],B[1],B[2]),this.data.textAlignment!==null&&(st.textAlign=f[this.data.textAlignment])}_setRequired(m,f){f?m.setAttribute("required",!0):m.removeAttribute("required"),m.setAttribute("aria-required",f)}}class L extends tt{constructor(m){const f=m.renderForms||m.data.hasOwnCanvas||!m.data.hasAppearance&&!!m.data.fieldValue;super(m,{isRenderable:f})}setPropertyOnSiblings(m,f,B,Z){const st=this.annotationStorage;for(const dt of this._getElementsByName(m.name,m.id))dt.domElement&&(dt.domElement[f]=B),st.setValue(dt.id,{[Z]:B})}render(){var Z,st;const m=this.annotationStorage,f=this.data.id;this.container.classList.add("textWidgetAnnotation");let B=null;if(this.renderForms){const dt=m.getValue(f,{value:this.data.fieldValue});let ft=dt.value||"";const Ht=m.getValue(f,{charLimit:this.data.maxLen}).charLimit;Ht&&ft.length>Ht&&(ft=ft.slice(0,Ht));let It=dt.formattedValue||((Z=this.data.textContent)==null?void 0:Z.join(`
`))||null;It&&this.data.comb&&(It=It.replaceAll(/\s+/g,""));const yt={userValue:ft,formattedValue:It,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(B=document.createElement("textarea"),B.textContent=It??ft,this.data.doNotScroll&&(B.style.overflowY="hidden")):(B=document.createElement("input"),B.type="text",B.setAttribute("value",It??ft),this.data.doNotScroll&&(B.style.overflowX="hidden")),this.data.hasOwnCanvas&&(B.hidden=!0),I.add(B),B.setAttribute("data-element-id",f),B.disabled=this.data.readOnly,B.name=this.data.fieldName,B.tabIndex=k,this._setRequired(B,this.data.required),Ht&&(B.maxLength=Ht),B.addEventListener("input",Ft=>{m.setValue(f,{value:Ft.target.value}),this.setPropertyOnSiblings(B,"value",Ft.target.value,"value"),yt.formattedValue=null}),B.addEventListener("resetform",Ft=>{const Dt=this.data.defaultFieldValue??"";B.value=yt.userValue=Dt,yt.formattedValue=null});let Lt=Ft=>{const{formattedValue:Dt}=yt;Dt!=null&&(Ft.target.value=Dt),Ft.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){B.addEventListener("focus",Dt=>{var Xt;if(yt.focused)return;const{target:ee}=Dt;yt.userValue&&(ee.value=yt.userValue),yt.lastCommittedValue=ee.value,yt.commitKey=1,(Xt=this.data.actions)!=null&&Xt.Focus||(yt.focused=!0)}),B.addEventListener("updatefromsandbox",Dt=>{this.showElementAndHideCanvas(Dt.target);const ee={value(Xt){yt.userValue=Xt.detail.value??"",m.setValue(f,{value:yt.userValue.toString()}),Xt.target.value=yt.userValue},formattedValue(Xt){const{formattedValue:pe}=Xt.detail;yt.formattedValue=pe,pe!=null&&Xt.target!==document.activeElement&&(Xt.target.value=pe),m.setValue(f,{formattedValue:pe})},selRange(Xt){Xt.target.setSelectionRange(...Xt.detail.selRange)},charLimit:Xt=>{var Ie;const{charLimit:pe}=Xt.detail,{target:ge}=Xt;if(pe===0){ge.removeAttribute("maxLength");return}ge.setAttribute("maxLength",pe);let Ce=yt.userValue;!Ce||Ce.length<=pe||(Ce=Ce.slice(0,pe),ge.value=yt.userValue=Ce,m.setValue(f,{value:Ce}),(Ie=this.linkService.eventBus)==null||Ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:Ce,willCommit:!0,commitKey:1,selStart:ge.selectionStart,selEnd:ge.selectionEnd}}))}};this._dispatchEventFromSandbox(ee,Dt)}),B.addEventListener("keydown",Dt=>{var pe;yt.commitKey=1;let ee=-1;if(Dt.key==="Escape"?ee=0:Dt.key==="Enter"&&!this.data.multiLine?ee=2:Dt.key==="Tab"&&(yt.commitKey=3),ee===-1)return;const{value:Xt}=Dt.target;yt.lastCommittedValue!==Xt&&(yt.lastCommittedValue=Xt,yt.userValue=Xt,(pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:Xt,willCommit:!0,commitKey:ee,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}}))});const Ft=Lt;Lt=null,B.addEventListener("blur",Dt=>{var Xt,pe;if(!yt.focused||!Dt.relatedTarget)return;(Xt=this.data.actions)!=null&&Xt.Blur||(yt.focused=!1);const{value:ee}=Dt.target;yt.userValue=ee,yt.lastCommittedValue!==ee&&((pe=this.linkService.eventBus)==null||pe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:ee,willCommit:!0,commitKey:yt.commitKey,selStart:Dt.target.selectionStart,selEnd:Dt.target.selectionEnd}})),Ft(Dt)}),(st=this.data.actions)!=null&&st.Keystroke&&B.addEventListener("beforeinput",Dt=>{var qe;yt.lastCommittedValue=null;const{data:ee,target:Xt}=Dt,{value:pe,selectionStart:ge,selectionEnd:Ce}=Xt;let Ie=ge,is=Ce;switch(Dt.inputType){case"deleteWordBackward":{const We=pe.substring(0,ge).match(/\w*[^\w]*$/);We&&(Ie-=We[0].length);break}case"deleteWordForward":{const We=pe.substring(ge).match(/^[^\w]*\w*/);We&&(is+=We[0].length);break}case"deleteContentBackward":ge===Ce&&(Ie-=1);break;case"deleteContentForward":ge===Ce&&(is+=1);break}Dt.preventDefault(),(qe=this.linkService.eventBus)==null||qe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:pe,change:ee||"",willCommit:!1,selStart:Ie,selEnd:is}})}),this._setEventListeners(B,yt,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Dt=>Dt.target.value)}if(Lt&&B.addEventListener("blur",Lt),this.data.comb){const Ft=(this.data.rect[2]-this.data.rect[0])/Ht;B.classList.add("comb"),B.style.letterSpacing=`calc(${Ft}px * var(--scale-factor) - 1ch)`}}else B=document.createElement("div"),B.textContent=this.data.fieldValue,B.style.verticalAlign="middle",B.style.display="table-cell",this.data.hasOwnCanvas&&(B.hidden=!0);return this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class N extends tt{constructor(m){super(m,{isRenderable:!!m.data.hasOwnCanvas})}}class T extends tt{constructor(m){super(m,{isRenderable:m.renderForms})}render(){const m=this.annotationStorage,f=this.data,B=f.id;let Z=m.getValue(B,{value:f.exportValue===f.fieldValue}).value;typeof Z=="string"&&(Z=Z!=="Off",m.setValue(B,{value:Z})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const st=document.createElement("input");return I.add(st),st.setAttribute("data-element-id",B),st.disabled=f.readOnly,this._setRequired(st,this.data.required),st.type="checkbox",st.name=f.fieldName,Z&&st.setAttribute("checked",!0),st.setAttribute("exportValue",f.exportValue),st.tabIndex=k,st.addEventListener("change",dt=>{const{name:ft,checked:Ht}=dt.target;for(const It of this._getElementsByName(ft,B)){const yt=Ht&&It.exportValue===f.exportValue;It.domElement&&(It.domElement.checked=yt),m.setValue(It.id,{value:yt})}m.setValue(B,{value:Ht})}),st.addEventListener("resetform",dt=>{const ft=f.defaultFieldValue||"Off";dt.target.checked=ft===f.exportValue}),this.enableScripting&&this.hasJSActions&&(st.addEventListener("updatefromsandbox",dt=>{const ft={value(Ht){Ht.target.checked=Ht.detail.value!=="Off",m.setValue(B,{value:Ht.target.checked})}};this._dispatchEventFromSandbox(ft,dt)}),this._setEventListeners(st,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],dt=>dt.target.checked)),this._setBackgroundColor(st),this._setDefaultPropertiesFromJS(st),this.container.append(st),this.container}}class M extends tt{constructor(m){super(m,{isRenderable:m.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const m=this.annotationStorage,f=this.data,B=f.id;let Z=m.getValue(B,{value:f.fieldValue===f.buttonValue}).value;if(typeof Z=="string"&&(Z=Z!==f.buttonValue,m.setValue(B,{value:Z})),Z)for(const dt of this._getElementsByName(f.fieldName,B))m.setValue(dt.id,{value:!1});const st=document.createElement("input");if(I.add(st),st.setAttribute("data-element-id",B),st.disabled=f.readOnly,this._setRequired(st,this.data.required),st.type="radio",st.name=f.fieldName,Z&&st.setAttribute("checked",!0),st.tabIndex=k,st.addEventListener("change",dt=>{const{name:ft,checked:Ht}=dt.target;for(const It of this._getElementsByName(ft,B))m.setValue(It.id,{value:!1});m.setValue(B,{value:Ht})}),st.addEventListener("resetform",dt=>{const ft=f.defaultFieldValue;dt.target.checked=ft!=null&&ft===f.buttonValue}),this.enableScripting&&this.hasJSActions){const dt=f.buttonValue;st.addEventListener("updatefromsandbox",ft=>{const Ht={value:It=>{const yt=dt===It.detail.value;for(const Lt of this._getElementsByName(It.target.name)){const Ft=yt&&Lt.id===B;Lt.domElement&&(Lt.domElement.checked=Ft),m.setValue(Lt.id,{value:Ft})}}};this._dispatchEventFromSandbox(Ht,ft)}),this._setEventListeners(st,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ft=>ft.target.checked)}return this._setBackgroundColor(st),this._setDefaultPropertiesFromJS(st),this.container.append(st),this.container}}class $ extends z{constructor(m){super(m,{ignoreBorder:m.data.hasAppearance})}render(){const m=super.render();m.classList.add("buttonWidgetAnnotation","pushButton");const f=m.lastChild;return this.enableScripting&&this.hasJSActions&&f&&(this._setDefaultPropertiesFromJS(f),f.addEventListener("updatefromsandbox",B=>{this._dispatchEventFromSandbox({},B)})),m}}class et extends tt{constructor(m){super(m,{isRenderable:m.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const m=this.annotationStorage,f=this.data.id,B=m.getValue(f,{value:this.data.fieldValue}),Z=document.createElement("select");I.add(Z),Z.setAttribute("data-element-id",f),Z.disabled=this.data.readOnly,this._setRequired(Z,this.data.required),Z.name=this.data.fieldName,Z.tabIndex=k;let st=this.data.combo&&this.data.options.length>0;this.data.combo||(Z.size=this.data.options.length,this.data.multiSelect&&(Z.multiple=!0)),Z.addEventListener("resetform",yt=>{const Lt=this.data.defaultFieldValue;for(const Ft of Z.options)Ft.selected=Ft.value===Lt});for(const yt of this.data.options){const Lt=document.createElement("option");Lt.textContent=yt.displayValue,Lt.value=yt.exportValue,B.value.includes(yt.exportValue)&&(Lt.setAttribute("selected",!0),st=!1),Z.append(Lt)}let dt=null;if(st){const yt=document.createElement("option");yt.value=" ",yt.setAttribute("hidden",!0),yt.setAttribute("selected",!0),Z.prepend(yt),dt=()=>{yt.remove(),Z.removeEventListener("input",dt),dt=null},Z.addEventListener("input",dt)}const ft=yt=>{const Lt=yt?"value":"textContent",{options:Ft,multiple:Dt}=Z;return Dt?Array.prototype.filter.call(Ft,ee=>ee.selected).map(ee=>ee[Lt]):Ft.selectedIndex===-1?null:Ft[Ft.selectedIndex][Lt]};let Ht=ft(!1);const It=yt=>{const Lt=yt.target.options;return Array.prototype.map.call(Lt,Ft=>({displayValue:Ft.textContent,exportValue:Ft.value}))};return this.enableScripting&&this.hasJSActions?(Z.addEventListener("updatefromsandbox",yt=>{const Lt={value(Ft){dt==null||dt();const Dt=Ft.detail.value,ee=new Set(Array.isArray(Dt)?Dt:[Dt]);for(const Xt of Z.options)Xt.selected=ee.has(Xt.value);m.setValue(f,{value:ft(!0)}),Ht=ft(!1)},multipleSelection(Ft){Z.multiple=!0},remove(Ft){const Dt=Z.options,ee=Ft.detail.remove;Dt[ee].selected=!1,Z.remove(ee),Dt.length>0&&Array.prototype.findIndex.call(Dt,Xt=>Xt.selected)===-1&&(Dt[0].selected=!0),m.setValue(f,{value:ft(!0),items:It(Ft)}),Ht=ft(!1)},clear(Ft){for(;Z.length!==0;)Z.remove(0);m.setValue(f,{value:null,items:[]}),Ht=ft(!1)},insert(Ft){const{index:Dt,displayValue:ee,exportValue:Xt}=Ft.detail.insert,pe=Z.children[Dt],ge=document.createElement("option");ge.textContent=ee,ge.value=Xt,pe?pe.before(ge):Z.append(ge),m.setValue(f,{value:ft(!0),items:It(Ft)}),Ht=ft(!1)},items(Ft){const{items:Dt}=Ft.detail;for(;Z.length!==0;)Z.remove(0);for(const ee of Dt){const{displayValue:Xt,exportValue:pe}=ee,ge=document.createElement("option");ge.textContent=Xt,ge.value=pe,Z.append(ge)}Z.options.length>0&&(Z.options[0].selected=!0),m.setValue(f,{value:ft(!0),items:It(Ft)}),Ht=ft(!1)},indices(Ft){const Dt=new Set(Ft.detail.indices);for(const ee of Ft.target.options)ee.selected=Dt.has(ee.index);m.setValue(f,{value:ft(!0)}),Ht=ft(!1)},editable(Ft){Ft.target.disabled=!Ft.detail.editable}};this._dispatchEventFromSandbox(Lt,yt)}),Z.addEventListener("input",yt=>{var Dt;const Lt=ft(!0),Ft=ft(!1);m.setValue(f,{value:Lt}),yt.preventDefault(),(Dt=this.linkService.eventBus)==null||Dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:f,name:"Keystroke",value:Ht,change:Ft,changeEx:Lt,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(Z,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],yt=>yt.target.value)):Z.addEventListener("input",function(yt){m.setValue(f,{value:ft(!0)})}),this.data.combo&&this._setTextStyle(Z),this._setBackgroundColor(Z),this._setDefaultPropertiesFromJS(Z),this.container.append(Z),this.container}}class wt extends D{constructor(m){const{data:f,elements:B}=m;super(m,{isRenderable:D._hasPopupData(f)}),this.elements=B}render(){this.container.classList.add("popupAnnotation");const m=new Pt({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),f=[];for(const B of this.elements)B.popup=m,f.push(B.data.id),B.addHighlightArea();return this.container.setAttribute("aria-controls",f.map(B=>`${c.AnnotationPrefix}${B}`).join(",")),this.container}}class Pt{constructor({container:m,color:f,elements:B,titleObj:Z,modificationDate:st,contentsObj:dt,richText:ft,parent:Ht,rect:It,parentRect:yt,open:Lt}){r(this,At);r(this,R);r(this,W);r(this,J);r(this,a,v(this,At,Jr).bind(this));r(this,l,v(this,J,hn).bind(this));r(this,n,v(this,W,on).bind(this));r(this,g,v(this,R,Di).bind(this));r(this,u,null);r(this,p,null);r(this,b,null);r(this,d,null);r(this,o,null);r(this,h,null);r(this,x,null);r(this,S,!1);r(this,K,null);r(this,Y,null);r(this,gt,null);r(this,mt,null);r(this,ot,!1);var Ft;w(this,p,m),w(this,mt,Z),w(this,b,dt),w(this,gt,ft),w(this,h,Ht),w(this,u,f),w(this,Y,It),w(this,x,yt),w(this,o,B),w(this,d,at.PDFDateString.toDateObject(st)),this.trigger=B.flatMap(Dt=>Dt.getElementsToTriggerPopup());for(const Dt of this.trigger)Dt.addEventListener("click",t(this,g)),Dt.addEventListener("mouseenter",t(this,n)),Dt.addEventListener("mouseleave",t(this,l)),Dt.classList.add("popupTriggerArea");for(const Dt of B)(Ft=Dt.container)==null||Ft.addEventListener("keydown",t(this,a));t(this,p).hidden=!0,Lt&&v(this,R,Di).call(this)}render(){if(t(this,K))return;const{page:{view:m},viewport:{rawDims:{pageWidth:f,pageHeight:B,pageX:Z,pageY:st}}}=t(this,h),dt=w(this,K,document.createElement("div"));if(dt.className="popup",t(this,u)){const Ce=dt.style.outlineColor=c.Util.makeHexColor(...t(this,u));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?dt.style.backgroundColor=`color-mix(in srgb, ${Ce} 30%, white)`:dt.style.backgroundColor=c.Util.makeHexColor(...t(this,u).map(Ie=>Math.floor(.7*(255-Ie)+Ie)))}const ft=document.createElement("span");ft.className="header";const Ht=document.createElement("h1");if(ft.append(Ht),{dir:Ht.dir,str:Ht.textContent}=t(this,mt),dt.append(ft),t(this,d)){const Ce=document.createElement("span");Ce.classList.add("popupDate"),Ce.setAttribute("data-l10n-id","pdfjs-annotation-date-string"),Ce.setAttribute("data-l10n-args",JSON.stringify({date:t(this,d).toLocaleDateString(),time:t(this,d).toLocaleTimeString()})),ft.append(Ce)}const It=t(this,b),yt=t(this,gt);if(yt!=null&&yt.str&&(!(It!=null&&It.str)||It.str===yt.str))O.XfaLayer.render({xfaHtml:yt.html,intent:"richText",div:dt}),dt.lastChild.classList.add("richText","popupContent");else{const Ce=this._formatContents(It);dt.append(Ce)}let Lt=!!t(this,x),Ft=Lt?t(this,x):t(this,Y);for(const Ce of t(this,o))if(!Ft||c.Util.intersect(Ce.data.rect,Ft)!==null){Ft=Ce.data.rect,Lt=!0;break}const Dt=c.Util.normalizeRect([Ft[0],m[3]-Ft[1]+m[1],Ft[2],m[3]-Ft[3]+m[1]]),ee=Lt?Ft[2]-Ft[0]+5:0,Xt=Dt[0]+ee,pe=Dt[1],{style:ge}=t(this,p);ge.left=`${100*(Xt-Z)/f}%`,ge.top=`${100*(pe-st)/B}%`,t(this,p).append(dt)}_formatContents({str:m,dir:f}){const B=document.createElement("p");B.classList.add("popupContent"),B.dir=f;const Z=m.split(/(?:\r\n?|\n)/);for(let st=0,dt=Z.length;st<dt;++st){const ft=Z[st];B.append(document.createTextNode(ft)),st<dt-1&&B.append(document.createElement("br"))}return B}forceHide(){w(this,ot,this.isVisible),t(this,ot)&&(t(this,p).hidden=!0)}maybeShow(){t(this,ot)&&(w(this,ot,!1),t(this,p).hidden=!1)}get isVisible(){return t(this,p).hidden===!1}}a=new WeakMap,l=new WeakMap,n=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakMap,b=new WeakMap,d=new WeakMap,o=new WeakMap,h=new WeakMap,x=new WeakMap,S=new WeakMap,K=new WeakMap,Y=new WeakMap,gt=new WeakMap,mt=new WeakMap,ot=new WeakMap,At=new WeakSet,Jr=function(m){m.altKey||m.shiftKey||m.ctrlKey||m.metaKey||(m.key==="Enter"||m.key==="Escape"&&t(this,S))&&v(this,R,Di).call(this)},R=new WeakSet,Di=function(){w(this,S,!t(this,S)),t(this,S)?(v(this,W,on).call(this),t(this,p).addEventListener("click",t(this,g)),t(this,p).addEventListener("keydown",t(this,a))):(v(this,J,hn).call(this),t(this,p).removeEventListener("click",t(this,g)),t(this,p).removeEventListener("keydown",t(this,a)))},W=new WeakSet,on=function(){t(this,K)||this.render(),this.isVisible?t(this,S)&&t(this,p).classList.add("focused"):(t(this,p).hidden=!1,t(this,p).style.zIndex=parseInt(t(this,p).style.zIndex)+1e3)},J=new WeakSet,hn=function(){t(this,p).classList.remove("focused"),!(t(this,S)||!this.isVisible)&&(t(this,p).hidden=!0,t(this,p).style.zIndex=parseInt(t(this,p).style.zIndex)-1e3)};class Ct extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0}),this.textContent=m.data.textContent,this.textPosition=m.data.textPosition,this.annotationEditorType=c.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const m=document.createElement("div");m.classList.add("annotationTextContent"),m.setAttribute("role","comment");for(const f of this.textContent){const B=document.createElement("span");B.textContent=f,m.append(B)}this.container.append(m)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}get _isEditable(){return this.data.hasOwnCanvas}}class Nt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});r(this,P,null)}render(){this.container.classList.add("lineAnnotation");const f=this.data,{width:B,height:Z}=C(f.rect),st=this.svgFactory.create(B,Z,!0),dt=w(this,P,this.svgFactory.createElement("svg:line"));return dt.setAttribute("x1",f.rect[2]-f.lineCoordinates[0]),dt.setAttribute("y1",f.rect[3]-f.lineCoordinates[1]),dt.setAttribute("x2",f.rect[2]-f.lineCoordinates[2]),dt.setAttribute("y2",f.rect[3]-f.lineCoordinates[3]),dt.setAttribute("stroke-width",f.borderStyle.width||1),dt.setAttribute("stroke","transparent"),dt.setAttribute("fill","transparent"),st.append(dt),this.container.append(st),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,P)}addHighlightArea(){this.container.classList.add("highlightArea")}}P=new WeakMap;class Mt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});r(this,H,null)}render(){this.container.classList.add("squareAnnotation");const f=this.data,{width:B,height:Z}=C(f.rect),st=this.svgFactory.create(B,Z,!0),dt=f.borderStyle.width,ft=w(this,H,this.svgFactory.createElement("svg:rect"));return ft.setAttribute("x",dt/2),ft.setAttribute("y",dt/2),ft.setAttribute("width",B-dt),ft.setAttribute("height",Z-dt),ft.setAttribute("stroke-width",dt||1),ft.setAttribute("stroke","transparent"),ft.setAttribute("fill","transparent"),st.append(ft),this.container.append(st),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,H)}addHighlightArea(){this.container.classList.add("highlightArea")}}H=new WeakMap;class qt extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});r(this,ht,null)}render(){this.container.classList.add("circleAnnotation");const f=this.data,{width:B,height:Z}=C(f.rect),st=this.svgFactory.create(B,Z,!0),dt=f.borderStyle.width,ft=w(this,ht,this.svgFactory.createElement("svg:ellipse"));return ft.setAttribute("cx",B/2),ft.setAttribute("cy",Z/2),ft.setAttribute("rx",B/2-dt/2),ft.setAttribute("ry",Z/2-dt/2),ft.setAttribute("stroke-width",dt||1),ft.setAttribute("stroke","transparent"),ft.setAttribute("fill","transparent"),st.append(ft),this.container.append(st),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,ht)}addHighlightArea(){this.container.classList.add("highlightArea")}}ht=new WeakMap;class $t extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});r(this,Et,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const f=this.data,{width:B,height:Z}=C(f.rect),st=this.svgFactory.create(B,Z,!0);let dt=[];for(const Ht of f.vertices){const It=Ht.x-f.rect[0],yt=f.rect[3]-Ht.y;dt.push(It+","+yt)}dt=dt.join(" ");const ft=w(this,Et,this.svgFactory.createElement(this.svgElementName));return ft.setAttribute("points",dt),ft.setAttribute("stroke-width",f.borderStyle.width||1),ft.setAttribute("stroke","transparent"),ft.setAttribute("fill","transparent"),st.append(ft),this.container.append(st),!f.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return t(this,Et)}addHighlightArea(){this.container.classList.add("highlightArea")}}Et=new WeakMap;class Kt extends $t{constructor(m){super(m),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class it extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class St extends D{constructor(f){super(f,{isRenderable:!0,ignoreBorder:!0});r(this,Tt,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=c.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const f=this.data,{width:B,height:Z}=C(f.rect),st=this.svgFactory.create(B,Z,!0);for(const dt of f.inkLists){let ft=[];for(const It of dt){const yt=It.x-f.rect[0],Lt=f.rect[3]-It.y;ft.push(`${yt},${Lt}`)}ft=ft.join(" ");const Ht=this.svgFactory.createElement(this.svgElementName);t(this,Tt).push(Ht),Ht.setAttribute("points",ft),Ht.setAttribute("stroke-width",f.borderStyle.width||1),Ht.setAttribute("stroke","transparent"),Ht.setAttribute("fill","transparent"),!f.popupRef&&this.hasPopupData&&this._createPopup(),st.append(Ht)}return this.container.append(st),this.container}getElementsToTriggerPopup(){return t(this,Tt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Tt=new WeakMap;class Gt extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class zt extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ie extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ae extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class he extends D{constructor(m){super(m,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class ye extends D{constructor(f){var st;super(f,{isRenderable:!0});r(this,Zt);r(this,Bt,null);const{filename:B,content:Z}=this.data.file;this.filename=(0,at.getFilenameFromUrl)(B,!0),this.content=Z,(st=this.linkService.eventBus)==null||st.dispatch("fileattachmentannotation",{source:this,filename:B,content:Z})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:f,data:B}=this;let Z;B.hasAppearance||B.fillAlpha===0?Z=document.createElement("div"):(Z=document.createElement("img"),Z.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(B.name)?"paperclip":"pushpin"}.svg`,B.fillAlpha&&B.fillAlpha<1&&(Z.style=`filter: opacity(${Math.round(B.fillAlpha*100)}%);`)),Z.addEventListener("dblclick",v(this,Zt,ln).bind(this)),w(this,Bt,Z);const{isMac:st}=c.FeatureTest.platform;return f.addEventListener("keydown",dt=>{dt.key==="Enter"&&(st?dt.metaKey:dt.ctrlKey)&&v(this,Zt,ln).call(this)}),!B.popupRef&&this.hasPopupData?this._createPopup():Z.classList.add("popupTriggerArea"),f.append(Z),f}getElementsToTriggerPopup(){return t(this,Bt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bt=new WeakMap,Zt=new WeakSet,ln=function(){var f;(f=this.downloadManager)==null||f.openOrDownloadData(this.content,this.filename)};class Oe{constructor({div:m,accessibilityManager:f,annotationCanvasMap:B,annotationEditorUIManager:Z,page:st,viewport:dt}){r(this,Me);r(this,ze);r(this,me,null);r(this,Ee,null);r(this,de,new Map);this.div=m,w(this,me,f),w(this,Ee,B),this.page=st,this.viewport=dt,this.zIndex=0,this._annotationEditorUIManager=Z}async render(m){var dt;const{annotations:f}=m,B=this.div;(0,at.setLayerDimensions)(B,this.viewport);const Z=new Map,st={data:null,layer:B,linkService:m.linkService,downloadManager:m.downloadManager,imageResourcesPath:m.imageResourcesPath||"",renderForms:m.renderForms!==!1,svgFactory:new at.DOMSVGFactory,annotationStorage:m.annotationStorage||new U.AnnotationStorage,enableScripting:m.enableScripting===!0,hasJSActions:m.hasJSActions,fieldObjects:m.fieldObjects,parent:this,elements:null};for(const ft of f){if(ft.noHTML)continue;const Ht=ft.annotationType===c.AnnotationType.POPUP;if(Ht){const Lt=Z.get(ft.id);if(!Lt)continue;st.elements=Lt}else{const{width:Lt,height:Ft}=C(ft.rect);if(Lt<=0||Ft<=0)continue}st.data=ft;const It=F.create(st);if(!It.isRenderable)continue;if(!Ht&&ft.popupRef){const Lt=Z.get(ft.popupRef);Lt?Lt.push(It):Z.set(ft.popupRef,[It])}const yt=It.render();ft.hidden&&(yt.style.visibility="hidden"),v(this,Me,Qr).call(this,yt,ft.id),It.annotationEditorType>0&&(t(this,de).set(It.data.id,It),(dt=this._annotationEditorUIManager)==null||dt.renderAnnotationElement(It))}v(this,ze,cn).call(this)}update({viewport:m}){const f=this.div;this.viewport=m,(0,at.setLayerDimensions)(f,{rotation:m.rotation}),v(this,ze,cn).call(this),f.hidden=!1}getEditableAnnotations(){return Array.from(t(this,de).values())}getEditableAnnotation(m){return t(this,de).get(m)}}me=new WeakMap,Ee=new WeakMap,de=new WeakMap,Me=new WeakSet,Qr=function(m,f){var Z;const B=m.firstChild||m;B.id=`${c.AnnotationPrefix}${f}`,this.div.append(m),(Z=t(this,me))==null||Z.moveElementInDOM(this.div,m,B,!1)},ze=new WeakSet,cn=function(){if(!t(this,Ee))return;const m=this.div;for(const[f,B]of t(this,Ee)){const Z=m.querySelector(`[data-annotation-id="${f}"]`);if(!Z)continue;B.className="annotationContent";const{firstChild:st}=Z;st?st.nodeName==="CANVAS"?st.replaceWith(B):st.classList.contains("annotationContent")?st.after(B):st.before(B):Z.append(B)}t(this,Ee).clear()}},792:(le,Wt,ut)=>{var O,k,j,Zr,C;ut.d(Wt,{AnnotationStorage:()=>bt,PrintAnnotationStorage:()=>V,SerializableEmpty:()=>nt});var c=ut(292),at=ut(310),U=ut(651);const nt=Object.freeze({map:null,hash:"",transfer:void 0});class bt{constructor(){r(this,j);r(this,O,!1);r(this,k,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(D,z){const pt=t(this,k).get(D);return pt===void 0?z:Object.assign(z,pt)}getRawValue(D){return t(this,k).get(D)}remove(D){if(t(this,k).delete(D),t(this,k).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const z of t(this,k).values())if(z instanceof at.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(D,z){const pt=t(this,k).get(D);let tt=!1;if(pt!==void 0)for(const[L,N]of Object.entries(z))pt[L]!==N&&(tt=!0,pt[L]=N);else tt=!0,t(this,k).set(D,z);tt&&v(this,j,Zr).call(this),z instanceof at.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(z.constructor._type)}has(D){return t(this,k).has(D)}getAll(){return t(this,k).size>0?(0,c.objectFromMap)(t(this,k)):null}setAll(D){for(const[z,pt]of Object.entries(D))this.setValue(z,pt)}get size(){return t(this,k).size}resetModified(){t(this,O)&&(w(this,O,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new V(this)}get serializable(){if(t(this,k).size===0)return nt;const D=new Map,z=new U.MurmurHash3_64,pt=[],tt=Object.create(null);let L=!1;for(const[N,T]of t(this,k)){const M=T instanceof at.AnnotationEditor?T.serialize(!1,tt):T;M&&(D.set(N,M),z.update(`${N}:${JSON.stringify(M)}`),L||(L=!!M.bitmap))}if(L)for(const N of D.values())N.bitmap&&pt.push(N.bitmap);return D.size>0?{map:D,hash:z.hexdigest(),transfer:pt}:nt}get editorStats(){let D=null;const z=new Map;for(const pt of t(this,k).values()){if(!(pt instanceof at.AnnotationEditor))continue;const tt=pt.telemetryFinalData;if(!tt)continue;const{type:L}=tt;z.has(L)||z.set(L,Object.getPrototypeOf(pt).constructor),D||(D=Object.create(null));const N=D[L]||(D[L]=new Map);for(const[T,M]of Object.entries(tt)){if(T==="type")continue;let $=N.get(T);$||($=new Map,N.set(T,$));const et=$.get(M)??0;$.set(M,et+1)}}for(const[pt,tt]of z)D[pt]=tt.computeTelemetryFinalData(D[pt]);return D}}O=new WeakMap,k=new WeakMap,j=new WeakSet,Zr=function(){t(this,O)||(w(this,O,!0),typeof this.onSetModified=="function"&&this.onSetModified())};class V extends bt{constructor(z){super();r(this,C,void 0);const{map:pt,hash:tt,transfer:L}=z.serializable,N=structuredClone(pt,L?{transfer:L}:null);w(this,C,{map:N,hash:tt,transfer:L})}get print(){(0,c.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return t(this,C)}}C=new WeakMap},831:(le,Wt,ut)=>{ut.a(le,async(c,at)=>{var M,$,et,wt,qs,Ct,Fi,Mt,qt,$t,Kt,it,Ni,Gt,zt,ie,ae,he,ye,ci,ce,fe,dn,re,Re;try{let Yt=function(J){if(typeof J=="string"||J instanceof URL?J={url:J}:(J instanceof ArrayBuffer||ArrayBuffer.isView(J))&&(J={data:J}),typeof J!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!J.url&&!J.data&&!J.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const y=new b,{docId:P}=y,H=J.url?Be(J.url):null,ht=J.data?te(J.data):null,Et=J.httpHeaders||null,Tt=J.withCredentials===!0,Bt=J.password??null,Zt=J.range instanceof d?J.range:null,De=Number.isInteger(J.rangeChunkSize)&&J.rangeChunkSize>0?J.rangeChunkSize:s;let me=J.worker instanceof K?J.worker:null;const Ee=J.verbosity,de=typeof J.docBaseUrl=="string"&&!(0,bt.isDataScheme)(J.docBaseUrl)?J.docBaseUrl:null,Me=typeof J.cMapUrl=="string"?J.cMapUrl:null,we=J.cMapPacked!==!1,ze=J.CMapReaderFactory||n,Le=typeof J.standardFontDataUrl=="string"?J.standardFontDataUrl:null,Jt=J.StandardFontDataFactory||u,m=J.stopAtErrors!==!0,f=Number.isInteger(J.maxImageSize)&&J.maxImageSize>-1?J.maxImageSize:-1,B=J.isEvalSupported!==!1,Z=typeof J.isOffscreenCanvasSupported=="boolean"?J.isOffscreenCanvasSupported:!U.isNodeJS,st=Number.isInteger(J.canvasMaxAreaInBytes)?J.canvasMaxAreaInBytes:-1,dt=typeof J.disableFontFace=="boolean"?J.disableFontFace:U.isNodeJS,ft=J.fontExtraProperties===!0,Ht=J.enableXfa===!0,It=J.ownerDocument||globalThis.document,yt=J.disableRange===!0,Lt=J.disableStream===!0,Ft=J.disableAutoFetch===!0,Dt=J.pdfBug===!0,ee=Zt?Zt.length:J.length??NaN,Xt=typeof J.useSystemFonts=="boolean"?J.useSystemFonts:!U.isNodeJS&&!dt,pe=typeof J.useWorkerFetch=="boolean"?J.useWorkerFetch:ze===bt.DOMCMapReaderFactory&&Jt===bt.DOMStandardFontDataFactory&&Me&&Le&&(0,bt.isValidFetchUrl)(Me,document.baseURI)&&(0,bt.isValidFetchUrl)(Le,document.baseURI),ge=J.canvasFactory||new l({ownerDocument:It}),Ce=J.filterFactory||new g({docId:P,ownerDocument:It}),Ie=null;(0,U.setVerbosityLevel)(Ee);const is={canvasFactory:ge,filterFactory:Ce};if(pe||(is.cMapReaderFactory=new ze({baseUrl:Me,isCompressed:we}),is.standardFontDataFactory=new Jt({baseUrl:Le})),!me){const _={verbosity:Ee,port:I.GlobalWorkerOptions.workerPort};me=_.port?K.fromPort(_):new K(_),y._worker=me}const qe={docId:P,apiVersion:"4.2.67",data:ht,password:Bt,disableAutoFetch:Ft,rangeChunkSize:De,length:ee,docBaseUrl:de,enableXfa:Ht,evaluatorOptions:{maxImageSize:f,disableFontFace:dt,ignoreErrors:m,isEvalSupported:B,isOffscreenCanvasSupported:Z,canvasMaxAreaInBytes:st,fontExtraProperties:ft,useSystemFonts:Xt,cMapUrl:pe?Me:null,standardFontDataUrl:pe?Le:null}},We={ignoreErrors:m,disableFontFace:dt,fontExtraProperties:ft,enableXfa:Ht,ownerDocument:It,disableAutoFetch:Ft,pdfBug:Dt,styleElement:Ie};return me.promise.then(function(){if(y.destroyed)throw new Error("Loading aborted");const _=p(me,qe),rt=new Promise(function(Rt){let Ot;Zt?Ot=new z.PDFDataTransportStream(Zt,{disableRange:yt,disableStream:Lt}):ht||(Ot=(Ut=>U.isNodeJS?function(){return typeof fetch<"u"&&typeof Response<"u"&&"body"in Response.prototype}()&&(0,bt.isValidFetchUrl)(Ut.url)?new pt.PDFFetchStream(Ut):new L.PDFNodeStream(Ut):(0,bt.isValidFetchUrl)(Ut.url)?new pt.PDFFetchStream(Ut):new tt.PDFNetworkStream(Ut))({url:H,length:ee,httpHeaders:Et,withCredentials:Tt,rangeChunkSize:De,disableRange:yt,disableStream:Lt})),Rt(Ot)});return Promise.all([_,rt]).then(function([Rt,Ot]){if(y.destroyed)throw new Error("Loading aborted");const Ut=new C.MessageHandler(P,Rt,me.port),Qt=new Y(Ut,y,Ot,We,is);y._transport=Qt,Ut.send("Ready",null)})}).catch(y._capability.reject),y},Be=function(J){if(J instanceof URL)return J.href;try{return new URL(J,window.location).href}catch{if(U.isNodeJS&&typeof J=="string")return J}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")},te=function(J){if(U.isNodeJS&&typeof ir.Buffer<"u"&&J instanceof ir.Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(J instanceof Uint8Array&&J.byteLength===J.buffer.byteLength)return J;if(typeof J=="string")return(0,U.stringToBytes)(J);if(J instanceof ArrayBuffer||ArrayBuffer.isView(J)||typeof J=="object"&&!isNaN(J==null?void 0:J.length))return new Uint8Array(J);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")},q=function(J){return typeof J=="object"&&Number.isInteger(J==null?void 0:J.num)&&J.num>=0&&Number.isInteger(J==null?void 0:J.gen)&&J.gen>=0};ut.d(Wt,{PDFDataRangeTransport:()=>d,PDFWorker:()=>K,build:()=>R,getDocument:()=>Yt,version:()=>E});var U=ut(292),nt=ut(792),bt=ut(419),V=ut(10),O=ut(573),k=ut(923),j=ut(814),I=ut(164),C=ut(178),F=ut(62),D=ut(626),z=ut(585),pt=ut(94),tt=ut(457),L=ut(786),N=ut(50),T=c([O,L]);[O,L]=T.then?(await T)():T;const s=65536,i=100,a=5e3,l=U.isNodeJS?O.NodeCanvasFactory:bt.DOMCanvasFactory,n=U.isNodeJS?O.NodeCMapReaderFactory:bt.DOMCMapReaderFactory,g=U.isNodeJS?O.NodeFilterFactory:bt.DOMFilterFactory,u=U.isNodeJS?O.NodeStandardFontDataFactory:bt.DOMStandardFontDataFactory;async function p(J,y){if(J.destroyed)throw new Error("Worker was destroyed");const P=await J.messageHandler.sendWithPromise("GetDocRequest",y,y.data?[y.data.buffer]:null);if(J.destroyed)throw new Error("Worker was destroyed");return P}const Q=class Q{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${ps(Q,M)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var y,P,H;this.destroyed=!0;try{(y=this._worker)!=null&&y.port&&(this._worker._pendingDestroy=!0),await((P=this._transport)==null?void 0:P.destroy())}catch(ht){throw(H=this._worker)!=null&&H.port&&delete this._worker._pendingDestroy,ht}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};M=new WeakMap,r(Q,M,0);let b=Q;class d{constructor(y,P,H=!1,ht=null){this.length=y,this.initialData=P,this.progressiveDone=H,this.contentDispositionFilename=ht,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(y){this._rangeListeners.push(y)}addProgressListener(y){this._progressListeners.push(y)}addProgressiveReadListener(y){this._progressiveReadListeners.push(y)}addProgressiveDoneListener(y){this._progressiveDoneListeners.push(y)}onDataRange(y,P){for(const H of this._rangeListeners)H(y,P)}onDataProgress(y,P){this._readyCapability.promise.then(()=>{for(const H of this._progressListeners)H(y,P)})}onDataProgressiveRead(y){this._readyCapability.promise.then(()=>{for(const P of this._progressiveReadListeners)P(y)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const y of this._progressiveDoneListeners)y()})}transportReady(){this._readyCapability.resolve()}requestDataRange(y,P){(0,U.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class o{constructor(y,P){this._pdfInfo=y,this._transport=P}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,U.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(y){return this._transport.getPage(y)}getPageIndex(y){return this._transport.getPageIndex(y)}getDestinations(){return this._transport.getDestinations()}getDestination(y){return this._transport.getDestination(y)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:y="display"}={}){const{renderingIntent:P}=this._transport.getRenderingIntent(y);return this._transport.getOptionalContentConfig(P)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(y=!1){return this._transport.startCleanup(y||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(y){return this._transport.cachedPageNumber(y)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class h{constructor(y,P,H,ht=!1){r(this,wt);r(this,Ct);r(this,$,null);r(this,et,!1);this._pageIndex=y,this._pageInfo=P,this._transport=H,this._stats=ht?new bt.StatTimer:null,this._pdfBug=ht,this.commonObjs=H.commonObjs,this.objs=new mt,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:y,rotation:P=this.rotate,offsetX:H=0,offsetY:ht=0,dontFlip:Et=!1}={}){return new bt.PageViewport({viewBox:this.view,scale:y,rotation:P,offsetX:H,offsetY:ht,dontFlip:Et})}getAnnotations({intent:y="display"}={}){const{renderingIntent:P}=this._transport.getRenderingIntent(y);return this._transport.getAnnotations(this._pageIndex,P)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,U.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var y;return((y=this._transport._htmlForXfa)==null?void 0:y.children[this._pageIndex])||null}render({canvasContext:y,viewport:P,intent:H="display",annotationMode:ht=U.AnnotationMode.ENABLE,transform:Et=null,background:Tt=null,optionalContentConfigPromise:Bt=null,annotationCanvasMap:Zt=null,pageColors:De=null,printAnnotationStorage:me=null}){var f,B;(f=this._stats)==null||f.time("Overall");const Ee=this._transport.getRenderingIntent(H,ht,me),{renderingIntent:de,cacheKey:Me}=Ee;w(this,et,!1),v(this,Ct,Fi).call(this),Bt||(Bt=this._transport.getOptionalContentConfig(de));let we=this._intentStates.get(Me);we||(we=Object.create(null),this._intentStates.set(Me,we)),we.streamReaderCancelTimeout&&(clearTimeout(we.streamReaderCancelTimeout),we.streamReaderCancelTimeout=null);const ze=!!(de&U.RenderingIntentFlag.PRINT);we.displayReadyCapability||(we.displayReadyCapability=Promise.withResolvers(),we.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(B=this._stats)==null||B.time("Page Request"),this._pumpOperatorList(Ee));const Le=Z=>{var st,dt;we.renderTasks.delete(Jt),(this._maybeCleanupAfterRender||ze)&&w(this,et,!0),v(this,wt,qs).call(this,!ze),Z?(Jt.capability.reject(Z),this._abortOperatorList({intentState:we,reason:Z instanceof Error?Z:new Error(Z)})):Jt.capability.resolve(),(st=this._stats)==null||st.timeEnd("Rendering"),(dt=this._stats)==null||dt.timeEnd("Overall")},Jt=new At({callback:Le,params:{canvasContext:y,viewport:P,transform:Et,background:Tt},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Zt,operatorList:we.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!ze,pdfBug:this._pdfBug,pageColors:De});(we.renderTasks||(we.renderTasks=new Set)).add(Jt);const m=Jt.task;return Promise.all([we.displayReadyCapability.promise,Bt]).then(([Z,st])=>{var dt;if(this.destroyed){Le();return}if((dt=this._stats)==null||dt.time("Rendering"),!(st.renderingIntent&de))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");Jt.initializeGraphics({transparency:Z,optionalContentConfig:st}),Jt.operatorListChanged()}).catch(Le),m}getOperatorList({intent:y="display",annotationMode:P=U.AnnotationMode.ENABLE,printAnnotationStorage:H=null}={}){var Zt;function ht(){Tt.operatorList.lastChunk&&(Tt.opListReadCapability.resolve(Tt.operatorList),Tt.renderTasks.delete(Bt))}const Et=this._transport.getRenderingIntent(y,P,H,!0);let Tt=this._intentStates.get(Et.cacheKey);Tt||(Tt=Object.create(null),this._intentStates.set(Et.cacheKey,Tt));let Bt;return Tt.opListReadCapability||(Bt=Object.create(null),Bt.operatorListChanged=ht,Tt.opListReadCapability=Promise.withResolvers(),(Tt.renderTasks||(Tt.renderTasks=new Set)).add(Bt),Tt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Zt=this._stats)==null||Zt.time("Page Request"),this._pumpOperatorList(Et)),Tt.opListReadCapability.promise}streamTextContent({includeMarkedContent:y=!1,disableNormalization:P=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:y===!0,disableNormalization:P===!0},{highWaterMark:100,size(H){return H.items.length}})}getTextContent(y={}){if(this._transport._htmlForXfa)return this.getXfa().then(H=>N.XfaText.textContent(H));const P=this.streamTextContent(y);return new Promise(function(H,ht){function Et(){Tt.read().then(function({value:Zt,done:De}){if(De){H(Bt);return}Object.assign(Bt.styles,Zt.styles),Bt.items.push(...Zt.items),Et()},ht)}const Tt=P.getReader(),Bt={items:[],styles:Object.create(null)};Et()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const y=[];for(const P of this._intentStates.values())if(this._abortOperatorList({intentState:P,reason:new Error("Page was destroyed."),force:!0}),!P.opListReadCapability)for(const H of P.renderTasks)y.push(H.completed),H.cancel();return this.objs.clear(),w(this,et,!1),v(this,Ct,Fi).call(this),Promise.all(y)}cleanup(y=!1){w(this,et,!0);const P=v(this,wt,qs).call(this,!1);return y&&P&&this._stats&&(this._stats=new bt.StatTimer),P}_startRenderPage(y,P){var ht,Et;const H=this._intentStates.get(P);H&&((ht=this._stats)==null||ht.timeEnd("Page Request"),(Et=H.displayReadyCapability)==null||Et.resolve(y))}_renderPageChunk(y,P){for(let H=0,ht=y.length;H<ht;H++)P.operatorList.fnArray.push(y.fnArray[H]),P.operatorList.argsArray.push(y.argsArray[H]);P.operatorList.lastChunk=y.lastChunk,P.operatorList.separateAnnots=y.separateAnnots;for(const H of P.renderTasks)H.operatorListChanged();y.lastChunk&&v(this,wt,qs).call(this,!0)}_pumpOperatorList({renderingIntent:y,cacheKey:P,annotationStorageSerializable:H}){const{map:ht,transfer:Et}=H,Tt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:y,cacheKey:P,annotationStorage:ht},Et).getReader(),Bt=this._intentStates.get(P);Bt.streamReader=Tt;const Zt=()=>{Tt.read().then(({value:De,done:me})=>{if(me){Bt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(De,Bt),Zt())},De=>{if(Bt.streamReader=null,!this._transport.destroyed){if(Bt.operatorList){Bt.operatorList.lastChunk=!0;for(const me of Bt.renderTasks)me.operatorListChanged();v(this,wt,qs).call(this,!0)}if(Bt.displayReadyCapability)Bt.displayReadyCapability.reject(De);else if(Bt.opListReadCapability)Bt.opListReadCapability.reject(De);else throw De}})};Zt()}_abortOperatorList({intentState:y,reason:P,force:H=!1}){if(y.streamReader){if(y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null),!H){if(y.renderTasks.size>0)return;if(P instanceof bt.RenderingCancelledException){let ht=i;P.extraDelay>0&&P.extraDelay<1e3&&(ht+=P.extraDelay),y.streamReaderCancelTimeout=setTimeout(()=>{y.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:y,reason:P,force:!0})},ht);return}}if(y.streamReader.cancel(new U.AbortException(P.message)).catch(()=>{}),y.streamReader=null,!this._transport.destroyed){for(const[ht,Et]of this._intentStates)if(Et===y){this._intentStates.delete(ht);break}this.cleanup()}}}get stats(){return this._stats}}$=new WeakMap,et=new WeakMap,wt=new WeakSet,qs=function(y=!1){if(v(this,Ct,Fi).call(this),!t(this,et)||this.destroyed)return!1;if(y)return w(this,$,setTimeout(()=>{w(this,$,null),v(this,wt,qs).call(this,!1)},a)),!1;for(const{renderTasks:P,operatorList:H}of this._intentStates.values())if(P.size>0||!H.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,et,!1),!0},Ct=new WeakSet,Fi=function(){t(this,$)&&(clearTimeout(t(this,$)),w(this,$,null))};class x{constructor(){r(this,Mt,new Set);r(this,qt,Promise.resolve())}postMessage(y,P){const H={data:structuredClone(y,P?{transfer:P}:null)};t(this,qt).then(()=>{for(const ht of t(this,Mt))ht.call(this,H)})}addEventListener(y,P){t(this,Mt).add(P)}removeEventListener(y,P){t(this,Mt).delete(P)}terminate(){t(this,Mt).clear()}}Mt=new WeakMap,qt=new WeakMap;const S={isWorkerDisabled:!1,fakeWorkerId:0};U.isNodeJS&&(S.isWorkerDisabled=!0,($t=I.GlobalWorkerOptions).workerSrc||($t.workerSrc="./pdf.worker.mjs")),S.isSameOrigin=function(J,y){let P;try{if(P=new URL(J),!P.origin||P.origin==="null")return!1}catch{return!1}const H=new URL(y,P);return P.origin===H.origin},S.createCDNWrapper=function(J){const y=`await import("${J}");`;return URL.createObjectURL(new Blob([y],{type:"text/javascript"}))};const W=class W{constructor({name:y=null,port:P=null,verbosity:H=(0,U.getVerbosityLevel)()}={}){var ht;if(this.name=y,this.destroyed=!1,this.verbosity=H,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,P){if((ht=t(W,Kt))!=null&&ht.has(P))throw new Error("Cannot use more than one PDFWorker per port.");(t(W,Kt)||w(W,Kt,new WeakMap)).set(P,this),this._initializeFromPort(P);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(y){this._port=y,this._messageHandler=new C.MessageHandler("main","worker",y),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!S.isWorkerDisabled&&!t(W,it,Ni)){let{workerSrc:y}=W;try{S.isSameOrigin(window.location.href,y)||(y=S.createCDNWrapper(new URL(y,window.location).href));const P=new Worker(y,{type:"module"}),H=new C.MessageHandler("main","worker",P),ht=()=>{P.removeEventListener("error",Et),H.destroy(),P.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Et=()=>{this._webWorker||ht()};P.addEventListener("error",Et),H.on("test",Bt=>{if(P.removeEventListener("error",Et),this.destroyed){ht();return}Bt?(this._messageHandler=H,this._port=P,this._webWorker=P,this._readyCapability.resolve(),H.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),H.destroy(),P.terminate())}),H.on("ready",Bt=>{if(P.removeEventListener("error",Et),this.destroyed){ht();return}try{Tt()}catch{this._setupFakeWorker()}});const Tt=()=>{const Bt=new Uint8Array;H.send("test",Bt,[Bt.buffer])};Tt();return}catch{(0,U.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){S.isWorkerDisabled||((0,U.warn)("Setting up fake worker."),S.isWorkerDisabled=!0),W._setupFakeWorkerGlobal.then(y=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const P=new x;this._port=P;const H=`fake${S.fakeWorkerId++}`,ht=new C.MessageHandler(H+"_worker",H,P);y.setup(ht,P);const Et=new C.MessageHandler(H,H+"_worker",P);this._messageHandler=Et,this._readyCapability.resolve(),Et.send("configure",{verbosity:this.verbosity})}).catch(y=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${y.message}".`))})}destroy(){var y;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(y=t(W,Kt))==null||y.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(y){var H;if(!(y!=null&&y.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const P=(H=t(this,Kt))==null?void 0:H.get(y.port);if(P){if(P._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return P}return new W(y)}static get workerSrc(){if(I.GlobalWorkerOptions.workerSrc)return I.GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){const y=async()=>t(this,it,Ni)?t(this,it,Ni):(await vs(()=>import(this.workerSrc).then(async P=>(await P.__tla,P)),__vite__mapDeps([]))).WorkerMessageHandler;return(0,U.shadow)(this,"_setupFakeWorkerGlobal",y())}};Kt=new WeakMap,it=new WeakSet,Ni=function(){var y;try{return((y=globalThis.pdfjsWorker)==null?void 0:y.WorkerMessageHandler)||null}catch{return null}},r(W,it),r(W,Kt,void 0);let K=W;class Y{constructor(y,P,H,ht,Et){r(this,ye);r(this,Gt,new Map);r(this,zt,new Map);r(this,ie,new Map);r(this,ae,new Map);r(this,he,null);this.messageHandler=y,this.loadingTask=P,this.commonObjs=new mt,this.fontLoader=new V.FontLoader({ownerDocument:ht.ownerDocument,styleElement:ht.styleElement}),this._params=ht,this.canvasFactory=Et.canvasFactory,this.filterFactory=Et.filterFactory,this.cMapReaderFactory=Et.cMapReaderFactory,this.standardFontDataFactory=Et.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=H,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return(0,U.shadow)(this,"annotationStorage",new nt.AnnotationStorage)}getRenderingIntent(y,P=U.AnnotationMode.ENABLE,H=null,ht=!1){let Et=U.RenderingIntentFlag.DISPLAY,Tt=nt.SerializableEmpty;switch(y){case"any":Et=U.RenderingIntentFlag.ANY;break;case"display":break;case"print":Et=U.RenderingIntentFlag.PRINT;break;default:(0,U.warn)(`getRenderingIntent - invalid intent: ${y}`)}switch(P){case U.AnnotationMode.DISABLE:Et+=U.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case U.AnnotationMode.ENABLE:break;case U.AnnotationMode.ENABLE_FORMS:Et+=U.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case U.AnnotationMode.ENABLE_STORAGE:Et+=U.RenderingIntentFlag.ANNOTATIONS_STORAGE,Tt=(Et&U.RenderingIntentFlag.PRINT&&H instanceof nt.PrintAnnotationStorage?H:this.annotationStorage).serializable;break;default:(0,U.warn)(`getRenderingIntent - invalid annotationMode: ${P}`)}return ht&&(Et+=U.RenderingIntentFlag.OPLIST),{renderingIntent:Et,cacheKey:`${Et}_${Tt.hash}`,annotationStorageSerializable:Tt}}destroy(){var H;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(H=t(this,he))==null||H.reject(new Error("Worker was destroyed during onPassword callback"));const y=[];for(const ht of t(this,zt).values())y.push(ht._destroy());t(this,zt).clear(),t(this,ie).clear(),t(this,ae).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const P=this.messageHandler.sendWithPromise("Terminate",null);return y.push(P),Promise.all(y).then(()=>{var ht;this.commonObjs.clear(),this.fontLoader.clear(),t(this,Gt).clear(),this.filterFactory.destroy(),(0,j.cleanupTextLayer)(),(ht=this._networkStream)==null||ht.cancelAllRequests(new U.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:y,loadingTask:P}=this;y.on("GetReader",(H,ht)=>{(0,U.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Et=>{this._lastProgress={loaded:Et.loaded,total:Et.total}},ht.onPull=()=>{this._fullReader.read().then(function({value:Et,done:Tt}){if(Tt){ht.close();return}(0,U.assert)(Et instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),ht.enqueue(new Uint8Array(Et),1,[Et])}).catch(Et=>{ht.error(Et)})},ht.onCancel=Et=>{this._fullReader.cancel(Et),ht.ready.catch(Tt=>{if(!this.destroyed)throw Tt})}}),y.on("ReaderHeadersReady",H=>{const ht=Promise.withResolvers(),Et=this._fullReader;return Et.headersReady.then(()=>{var Tt;(!Et.isStreamingSupported||!Et.isRangeSupported)&&(this._lastProgress&&((Tt=P.onProgress)==null||Tt.call(P,this._lastProgress)),Et.onProgress=Bt=>{var Zt;(Zt=P.onProgress)==null||Zt.call(P,{loaded:Bt.loaded,total:Bt.total})}),ht.resolve({isStreamingSupported:Et.isStreamingSupported,isRangeSupported:Et.isRangeSupported,contentLength:Et.contentLength})},ht.reject),ht.promise}),y.on("GetRangeReader",(H,ht)=>{(0,U.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Et=this._networkStream.getRangeReader(H.begin,H.end);if(!Et){ht.close();return}ht.onPull=()=>{Et.read().then(function({value:Tt,done:Bt}){if(Bt){ht.close();return}(0,U.assert)(Tt instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),ht.enqueue(new Uint8Array(Tt),1,[Tt])}).catch(Tt=>{ht.error(Tt)})},ht.onCancel=Tt=>{Et.cancel(Tt),ht.ready.catch(Bt=>{if(!this.destroyed)throw Bt})}}),y.on("GetDoc",({pdfInfo:H})=>{this._numPages=H.numPages,this._htmlForXfa=H.htmlForXfa,delete H.htmlForXfa,P._capability.resolve(new o(H,this))}),y.on("DocException",function(H){let ht;switch(H.name){case"PasswordException":ht=new U.PasswordException(H.message,H.code);break;case"InvalidPDFException":ht=new U.InvalidPDFException(H.message);break;case"MissingPDFException":ht=new U.MissingPDFException(H.message);break;case"UnexpectedResponseException":ht=new U.UnexpectedResponseException(H.message,H.status);break;case"UnknownErrorException":ht=new U.UnknownErrorException(H.message,H.details);break;default:(0,U.unreachable)("DocException - expected a valid Error.")}P._capability.reject(ht)}),y.on("PasswordRequest",H=>{if(w(this,he,Promise.withResolvers()),P.onPassword){const ht=Et=>{Et instanceof Error?t(this,he).reject(Et):t(this,he).resolve({password:Et})};try{P.onPassword(ht,H.code)}catch(Et){t(this,he).reject(Et)}}else t(this,he).reject(new U.PasswordException(H.message,H.code));return t(this,he).promise}),y.on("DataLoaded",H=>{var ht;(ht=P.onProgress)==null||ht.call(P,{loaded:H.length,total:H.length}),this.downloadInfoCapability.resolve(H)}),y.on("StartRenderPage",H=>{this.destroyed||t(this,zt).get(H.pageIndex)._startRenderPage(H.transparency,H.cacheKey)}),y.on("commonobj",([H,ht,Et])=>{var Tt;if(this.destroyed||this.commonObjs.has(H))return null;switch(ht){case"Font":const Bt=this._params;if("error"in Et){const Ee=Et.error;(0,U.warn)(`Error during font loading: ${Ee}`),this.commonObjs.resolve(H,Ee);break}const Zt=Bt.pdfBug&&((Tt=globalThis.FontInspector)!=null&&Tt.enabled)?(Ee,de)=>globalThis.FontInspector.fontAdded(Ee,de):null,De=new V.FontFaceObject(Et,{disableFontFace:Bt.disableFontFace,ignoreErrors:Bt.ignoreErrors,inspectFont:Zt});this.fontLoader.bind(De).catch(()=>y.sendWithPromise("FontFallback",{id:H})).finally(()=>{!Bt.fontExtraProperties&&De.data&&(De.data=null),this.commonObjs.resolve(H,De)});break;case"CopyLocalImage":const{imageRef:me}=Et;(0,U.assert)(me,"The imageRef must be defined.");for(const Ee of t(this,zt).values())for(const[,de]of Ee.objs)if(de.ref===me)return de.dataLen?(this.commonObjs.resolve(H,structuredClone(de)),de.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(H,Et);break;default:throw new Error(`Got unknown common object type ${ht}`)}return null}),y.on("obj",([H,ht,Et,Tt])=>{var Zt;if(this.destroyed)return;const Bt=t(this,zt).get(ht);if(!Bt.objs.has(H)){if(Bt._intentStates.size===0){(Zt=Tt==null?void 0:Tt.bitmap)==null||Zt.close();return}switch(Et){case"Image":Bt.objs.resolve(H,Tt),(Tt==null?void 0:Tt.dataLen)>U.MAX_IMAGE_SIZE_TO_CACHE&&(Bt._maybeCleanupAfterRender=!0);break;case"Pattern":Bt.objs.resolve(H,Tt);break;default:throw new Error(`Got unknown object type ${Et}`)}}}),y.on("DocProgress",H=>{var ht;this.destroyed||((ht=P.onProgress)==null||ht.call(P,{loaded:H.loaded,total:H.total}))}),y.on("FetchBuiltInCMap",H=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(H):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),y.on("FetchStandardFontData",H=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(H):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var H;this.annotationStorage.size<=0&&(0,U.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:y,transfer:P}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:y,filename:((H=this._fullReader)==null?void 0:H.filename)??null},P).finally(()=>{this.annotationStorage.resetModified()})}getPage(y){if(!Number.isInteger(y)||y<=0||y>this._numPages)return Promise.reject(new Error("Invalid page request."));const P=y-1,H=t(this,ie).get(P);if(H)return H;const ht=this.messageHandler.sendWithPromise("GetPage",{pageIndex:P}).then(Et=>{if(this.destroyed)throw new Error("Transport destroyed");Et.refStr&&t(this,ae).set(Et.refStr,y);const Tt=new h(P,Et,this,this._params.pdfBug);return t(this,zt).set(P,Tt),Tt});return t(this,ie).set(P,ht),ht}getPageIndex(y){return q(y)?this.messageHandler.sendWithPromise("GetPageIndex",{num:y.num,gen:y.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(y,P){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:y,intent:P})}getFieldObjects(){return v(this,ye,ci).call(this,"GetFieldObjects")}hasJSActions(){return v(this,ye,ci).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(y){return typeof y!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:y})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return v(this,ye,ci).call(this,"GetDocJSActions")}getPageJSActions(y){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:y})}getStructTree(y){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:y})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(y){return v(this,ye,ci).call(this,"GetOptionalContentConfig").then(P=>new D.OptionalContentConfig(P,y))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const y="GetMetadata",P=t(this,Gt).get(y);if(P)return P;const H=this.messageHandler.sendWithPromise(y,null).then(ht=>{var Et,Tt;return{info:ht[0],metadata:ht[1]?new F.Metadata(ht[1]):null,contentDispositionFilename:((Et=this._fullReader)==null?void 0:Et.filename)??null,contentLength:((Tt=this._fullReader)==null?void 0:Tt.contentLength)??null}});return t(this,Gt).set(y,H),H}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(y=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const P of t(this,zt).values())if(!P.cleanup())throw new Error(`startCleanup: Page ${P.pageNumber} is currently rendering.`);this.commonObjs.clear(),y||this.fontLoader.clear(),t(this,Gt).clear(),this.filterFactory.destroy(!0),(0,j.cleanupTextLayer)()}}cachedPageNumber(y){if(!q(y))return null;const P=y.gen===0?`${y.num}R`:`${y.num}R${y.gen}`;return t(this,ae).get(P)??null}get loadingParams(){const{disableAutoFetch:y,enableXfa:P}=this._params;return(0,U.shadow)(this,"loadingParams",{disableAutoFetch:y,enableXfa:P})}}Gt=new WeakMap,zt=new WeakMap,ie=new WeakMap,ae=new WeakMap,he=new WeakMap,ye=new WeakSet,ci=function(y,P=null){const H=t(this,Gt).get(y);if(H)return H;const ht=this.messageHandler.sendWithPromise(y,P);return t(this,Gt).set(y,ht),ht};const gt=Symbol("INITIAL_DATA");class mt{constructor(){r(this,fe);r(this,ce,Object.create(null))}get(y,P=null){if(P){const ht=v(this,fe,dn).call(this,y);return ht.promise.then(()=>P(ht.data)),null}const H=t(this,ce)[y];if(!H||H.data===gt)throw new Error(`Requesting object that isn't resolved yet ${y}.`);return H.data}has(y){const P=t(this,ce)[y];return!!P&&P.data!==gt}resolve(y,P=null){const H=v(this,fe,dn).call(this,y);H.data=P,H.resolve()}clear(){var y;for(const P in t(this,ce)){const{data:H}=t(this,ce)[P];(y=H==null?void 0:H.bitmap)==null||y.close()}w(this,ce,Object.create(null))}*[Symbol.iterator](){for(const y in t(this,ce)){const{data:P}=t(this,ce)[y];P!==gt&&(yield[y,P])}}}ce=new WeakMap,fe=new WeakSet,dn=function(y){var P;return(P=t(this,ce))[y]||(P[y]={...Promise.withResolvers(),data:gt})};class ot{constructor(y){r(this,re,null);w(this,re,y),this.onContinue=null}get promise(){return t(this,re).capability.promise}cancel(y=0){t(this,re).cancel(null,y)}get separateAnnots(){const{separateAnnots:y}=t(this,re).operatorList;if(!y)return!1;const{annotationCanvasMap:P}=t(this,re);return y.form||y.canvas&&(P==null?void 0:P.size)>0}}re=new WeakMap;const vt=class vt{constructor({callback:y,params:P,objs:H,commonObjs:ht,annotationCanvasMap:Et,operatorList:Tt,pageIndex:Bt,canvasFactory:Zt,filterFactory:De,useRequestAnimationFrame:me=!1,pdfBug:Ee=!1,pageColors:de=null}){this.callback=y,this.params=P,this.objs=H,this.commonObjs=ht,this.annotationCanvasMap=Et,this.operatorListIdx=null,this.operatorList=Tt,this._pageIndex=Bt,this.canvasFactory=Zt,this.filterFactory=De,this._pdfBug=Ee,this.pageColors=de,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=me===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ot(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=P.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:y=!1,optionalContentConfig:P}){var Bt,Zt;if(this.cancelled)return;if(this._canvas){if(t(vt,Re).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");t(vt,Re).add(this._canvas)}this._pdfBug&&((Bt=globalThis.StepperManager)!=null&&Bt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:H,viewport:ht,transform:Et,background:Tt}=this.params;this.gfx=new k.CanvasGraphics(H,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:P},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Et,viewport:ht,transparency:y,background:Tt}),this.operatorListIdx=0,this.graphicsReady=!0,(Zt=this.graphicsReadyCallback)==null||Zt.call(this)}cancel(y=null,P=0){var H;this.running=!1,this.cancelled=!0,(H=this.gfx)==null||H.endDrawing(),t(vt,Re).delete(this._canvas),this.callback(y||new bt.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,P))}operatorListChanged(){var y;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(y=this.stepper)==null||y.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),t(vt,Re).delete(this._canvas),this.callback())))}};Re=new WeakMap,r(vt,Re,new WeakSet);let At=vt;const E="4.2.67",R="49b388101";at()}catch(Yt){at(Yt)}})},583:(le,Wt,ut)=>{ut.d(Wt,{BaseCMapReaderFactory:()=>nt,BaseCanvasFactory:()=>U,BaseFilterFactory:()=>at,BaseSVGFactory:()=>V,BaseStandardFontDataFactory:()=>bt});var c=ut(292);class at{constructor(){this.constructor===at&&(0,c.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(k){return"none"}addHCMFilter(k,j){return"none"}addHighlightHCMFilter(k,j,I,C,F){return"none"}destroy(k=!1){}}class U{constructor(){this.constructor===U&&(0,c.unreachable)("Cannot initialize BaseCanvasFactory.")}create(k,j){if(k<=0||j<=0)throw new Error("Invalid canvas size");const I=this._createCanvas(k,j);return{canvas:I,context:I.getContext("2d")}}reset(k,j,I){if(!k.canvas)throw new Error("Canvas is not specified");if(j<=0||I<=0)throw new Error("Invalid canvas size");k.canvas.width=j,k.canvas.height=I}destroy(k){if(!k.canvas)throw new Error("Canvas is not specified");k.canvas.width=0,k.canvas.height=0,k.canvas=null,k.context=null}_createCanvas(k,j){(0,c.unreachable)("Abstract method `_createCanvas` called.")}}class nt{constructor({baseUrl:k=null,isCompressed:j=!0}){this.constructor===nt&&(0,c.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=k,this.isCompressed=j}async fetch({name:k}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!k)throw new Error("CMap name must be specified.");const j=this.baseUrl+k+(this.isCompressed?".bcmap":""),I=this.isCompressed?c.CMapCompressionType.BINARY:c.CMapCompressionType.NONE;return this._fetchData(j,I).catch(C=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${j}`)})}_fetchData(k,j){(0,c.unreachable)("Abstract method `_fetchData` called.")}}class bt{constructor({baseUrl:k=null}){this.constructor===bt&&(0,c.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=k}async fetch({filename:k}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!k)throw new Error("Font filename must be specified.");const j=`${this.baseUrl}${k}`;return this._fetchData(j).catch(I=>{throw new Error(`Unable to load font data at: ${j}`)})}_fetchData(k){(0,c.unreachable)("Abstract method `_fetchData` called.")}}class V{constructor(){this.constructor===V&&(0,c.unreachable)("Cannot initialize BaseSVGFactory.")}create(k,j,I=!1){if(k<=0||j<=0)throw new Error("Invalid SVG dimensions");const C=this._createSVG("svg:svg");return C.setAttribute("version","1.1"),I||(C.setAttribute("width",`${k}px`),C.setAttribute("height",`${j}px`)),C.setAttribute("preserveAspectRatio","none"),C.setAttribute("viewBox",`0 0 ${k} ${j}`),C}createElement(k){if(typeof k!="string")throw new Error("Invalid SVG element type");return this._createSVG(k)}_createSVG(k){(0,c.unreachable)("Abstract method `_createSVG` called.")}}},923:(le,Wt,ut)=>{var re,un,Yt,pn;ut.d(Wt,{CanvasGraphics:()=>fe});var c=ut(292),at=ut(419);const U={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function nt(q,s){if(!s)return;const i=s[2]-s[0],a=s[3]-s[1],l=new Path2D;l.rect(s[0],s[1],i,a),q.clip(l)}class bt{constructor(){this.constructor===bt&&(0,c.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,c.unreachable)("Abstract method `getPattern` called.")}}class V extends bt{constructor(s){super(),this._type=s[1],this._bbox=s[2],this._colorStops=s[3],this._p0=s[4],this._p1=s[5],this._r0=s[6],this._r1=s[7],this.matrix=null}_createGradient(s){let i;this._type==="axial"?i=s.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(i=s.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)i.addColorStop(a[0],a[1]);return i}getPattern(s,i,a,l){let n;if(l===U.STROKE||l===U.FILL){const g=i.current.getClippedPathBoundingBox(l,(0,at.getCurrentTransform)(s))||[0,0,0,0],u=Math.ceil(g[2]-g[0])||1,p=Math.ceil(g[3]-g[1])||1,b=i.cachedCanvases.getCanvas("pattern",u,p,!0),d=b.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-g[0],-g[1]),a=c.Util.transform(a,[1,0,0,1,g[0],g[1]]),d.transform(...i.baseTransform),this.matrix&&d.transform(...this.matrix),nt(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),n=s.createPattern(b.canvas,"no-repeat");const o=new DOMMatrix(a);n.setTransform(o)}else nt(s,this._bbox),n=this._createGradient(s);return n}}function O(q,s,i,a,l,n,g,u){const p=s.coords,b=s.colors,d=q.data,o=q.width*4;let h;p[i+1]>p[a+1]&&(h=i,i=a,a=h,h=n,n=g,g=h),p[a+1]>p[l+1]&&(h=a,a=l,l=h,h=g,g=u,u=h),p[i+1]>p[a+1]&&(h=i,i=a,a=h,h=n,n=g,g=h);const x=(p[i]+s.offsetX)*s.scaleX,S=(p[i+1]+s.offsetY)*s.scaleY,K=(p[a]+s.offsetX)*s.scaleX,Y=(p[a+1]+s.offsetY)*s.scaleY,gt=(p[l]+s.offsetX)*s.scaleX,mt=(p[l+1]+s.offsetY)*s.scaleY;if(S>=mt)return;const ot=b[n],At=b[n+1],E=b[n+2],R=b[g],Q=b[g+1],W=b[g+2],vt=b[u],J=b[u+1],y=b[u+2],P=Math.round(S),H=Math.round(mt);let ht,Et,Tt,Bt,Zt,De,me,Ee;for(let de=P;de<=H;de++){if(de<Y){const Jt=de<S?0:(S-de)/(S-Y);ht=x-(x-K)*Jt,Et=ot-(ot-R)*Jt,Tt=At-(At-Q)*Jt,Bt=E-(E-W)*Jt}else{let Jt;de>mt?Jt=1:Y===mt?Jt=0:Jt=(Y-de)/(Y-mt),ht=K-(K-gt)*Jt,Et=R-(R-vt)*Jt,Tt=Q-(Q-J)*Jt,Bt=W-(W-y)*Jt}let Me;de<S?Me=0:de>mt?Me=1:Me=(S-de)/(S-mt),Zt=x-(x-gt)*Me,De=ot-(ot-vt)*Me,me=At-(At-J)*Me,Ee=E-(E-y)*Me;const we=Math.round(Math.min(ht,Zt)),ze=Math.round(Math.max(ht,Zt));let Le=o*de+we*4;for(let Jt=we;Jt<=ze;Jt++)Me=(ht-Jt)/(ht-Zt),Me<0?Me=0:Me>1&&(Me=1),d[Le++]=Et-(Et-De)*Me|0,d[Le++]=Tt-(Tt-me)*Me|0,d[Le++]=Bt-(Bt-Ee)*Me|0,d[Le++]=255}}function k(q,s,i){const a=s.coords,l=s.colors;let n,g;switch(s.type){case"lattice":const u=s.verticesPerRow,p=Math.floor(a.length/u)-1,b=u-1;for(n=0;n<p;n++){let d=n*u;for(let o=0;o<b;o++,d++)O(q,i,a[d],a[d+1],a[d+u],l[d],l[d+1],l[d+u]),O(q,i,a[d+u+1],a[d+1],a[d+u],l[d+u+1],l[d+1],l[d+u])}break;case"triangles":for(n=0,g=a.length;n<g;n+=3)O(q,i,a[n],a[n+1],a[n+2],l[n],l[n+1],l[n+2]);break;default:throw new Error("illegal figure")}}class j extends bt{constructor(s){super(),this._coords=s[2],this._colors=s[3],this._figures=s[4],this._bounds=s[5],this._bbox=s[7],this._background=s[8],this.matrix=null}_createMeshCanvas(s,i,a){const l=Math.floor(this._bounds[0]),n=Math.floor(this._bounds[1]),g=Math.ceil(this._bounds[2])-l,u=Math.ceil(this._bounds[3])-n,p=Math.min(Math.ceil(Math.abs(g*s[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(u*s[1]*1.1)),3e3),d=g/p,o=u/b,h={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-n,scaleX:1/d,scaleY:1/o},x=p+2*2,S=b+2*2,K=a.getCanvas("mesh",x,S,!1),Y=K.context,gt=Y.createImageData(p,b);if(i){const mt=gt.data;for(let ot=0,At=mt.length;ot<At;ot+=4)mt[ot]=i[0],mt[ot+1]=i[1],mt[ot+2]=i[2],mt[ot+3]=255}for(const mt of this._figures)k(gt,mt,h);return Y.putImageData(gt,2,2),{canvas:K.canvas,offsetX:l-2*d,offsetY:n-2*o,scaleX:d,scaleY:o}}getPattern(s,i,a,l){nt(s,this._bbox);let n;if(l===U.SHADING)n=c.Util.singularValueDecompose2dScale((0,at.getCurrentTransform)(s));else if(n=c.Util.singularValueDecompose2dScale(i.baseTransform),this.matrix){const u=c.Util.singularValueDecompose2dScale(this.matrix);n=[n[0]*u[0],n[1]*u[1]]}const g=this._createMeshCanvas(n,l===U.SHADING?null:this._background,i.cachedCanvases);return l!==U.SHADING&&(s.setTransform(...i.baseTransform),this.matrix&&s.transform(...this.matrix)),s.translate(g.offsetX,g.offsetY),s.scale(g.scaleX,g.scaleY),s.createPattern(g.canvas,"no-repeat")}}class I extends bt{getPattern(){return"hotpink"}}function C(q){switch(q[0]){case"RadialAxial":return new V(q);case"Mesh":return new j(q);case"Dummy":return new I}throw new Error(`Unknown IR type: ${q[0]}`)}const F={COLORED:1,UNCOLORED:2},ne=class ne{constructor(s,i,a,l,n){this.operatorList=s[2],this.matrix=s[3]||[1,0,0,1,0,0],this.bbox=s[4],this.xstep=s[5],this.ystep=s[6],this.paintType=s[7],this.tilingType=s[8],this.color=i,this.ctx=a,this.canvasGraphicsFactory=l,this.baseTransform=n}createPatternCanvas(s){const i=this.operatorList,a=this.bbox,l=this.xstep,n=this.ystep,g=this.paintType,u=this.tilingType,p=this.color,b=this.canvasGraphicsFactory;(0,c.info)("TilingType: "+u);const d=a[0],o=a[1],h=a[2],x=a[3],S=c.Util.singularValueDecompose2dScale(this.matrix),K=c.Util.singularValueDecompose2dScale(this.baseTransform),Y=[S[0]*K[0],S[1]*K[1]],gt=this.getSizeAndScale(l,this.ctx.canvas.width,Y[0]),mt=this.getSizeAndScale(n,this.ctx.canvas.height,Y[1]),ot=s.cachedCanvases.getCanvas("pattern",gt.size,mt.size,!0),At=ot.context,E=b.createCanvasGraphics(At);E.groupLevel=s.groupLevel,this.setFillAndStrokeStyleToContext(E,g,p);let R=d,Q=o,W=h,vt=x;return d<0&&(R=0,W+=Math.abs(d)),o<0&&(Q=0,vt+=Math.abs(o)),At.translate(-(gt.scale*R),-(mt.scale*Q)),E.transform(gt.scale,0,0,mt.scale,0,0),At.save(),this.clipBbox(E,R,Q,W,vt),E.baseTransform=(0,at.getCurrentTransform)(E.ctx),E.executeOperatorList(i),E.endDrawing(),{canvas:ot.canvas,scaleX:gt.scale,scaleY:mt.scale,offsetX:R,offsetY:Q}}getSizeAndScale(s,i,a){s=Math.abs(s);const l=Math.max(ne.MAX_PATTERN_SIZE,i);let n=Math.ceil(s*a);return n>=l?n=l:a=n/s,{scale:a,size:n}}clipBbox(s,i,a,l,n){const g=l-i,u=n-a;s.ctx.rect(i,a,g,u),s.current.updateRectMinMax((0,at.getCurrentTransform)(s.ctx),[i,a,l,n]),s.clip(),s.endPath()}setFillAndStrokeStyleToContext(s,i,a){const l=s.ctx,n=s.current;switch(i){case F.COLORED:const g=this.ctx;l.fillStyle=g.fillStyle,l.strokeStyle=g.strokeStyle,n.fillColor=g.fillStyle,n.strokeColor=g.strokeStyle;break;case F.UNCOLORED:const u=c.Util.makeHexColor(a[0],a[1],a[2]);l.fillStyle=u,l.strokeStyle=u,n.fillColor=u,n.strokeColor=u;break;default:throw new c.FormatError(`Unsupported paint type: ${i}`)}}getPattern(s,i,a,l){let n=a;l!==U.SHADING&&(n=c.Util.transform(n,i.baseTransform),this.matrix&&(n=c.Util.transform(n,this.matrix)));const g=this.createPatternCanvas(i);let u=new DOMMatrix(n);u=u.translate(g.offsetX,g.offsetY),u=u.scale(1/g.scaleX,1/g.scaleY);const p=s.createPattern(g.canvas,"repeat");return p.setTransform(u),p}};Ae(ne,"MAX_PATTERN_SIZE",3e3);let D=ne;function z({src:q,srcPos:s=0,dest:i,width:a,height:l,nonBlackColor:n=4294967295,inverseDecode:g=!1}){const u=c.FeatureTest.isLittleEndian?4278190080:255,[p,b]=g?[n,u]:[u,n],d=a>>3,o=a&7,h=q.length;i=new Uint32Array(i.buffer);let x=0;for(let S=0;S<l;S++){for(const Y=s+d;s<Y;s++){const gt=s<h?q[s]:255;i[x++]=gt&128?b:p,i[x++]=gt&64?b:p,i[x++]=gt&32?b:p,i[x++]=gt&16?b:p,i[x++]=gt&8?b:p,i[x++]=gt&4?b:p,i[x++]=gt&2?b:p,i[x++]=gt&1?b:p}if(o===0)continue;const K=s<h?q[s++]:255;for(let Y=0;Y<o;Y++)i[x++]=K&1<<7-Y?b:p}return{srcPos:s,destPos:x}}const pt=16,tt=100,L=4096,N=15,T=10,M=1e3,$=16;function et(q,s){if(q._removeMirroring)throw new Error("Context is already forwarding operations.");q.__originalSave=q.save,q.__originalRestore=q.restore,q.__originalRotate=q.rotate,q.__originalScale=q.scale,q.__originalTranslate=q.translate,q.__originalTransform=q.transform,q.__originalSetTransform=q.setTransform,q.__originalResetTransform=q.resetTransform,q.__originalClip=q.clip,q.__originalMoveTo=q.moveTo,q.__originalLineTo=q.lineTo,q.__originalBezierCurveTo=q.bezierCurveTo,q.__originalRect=q.rect,q.__originalClosePath=q.closePath,q.__originalBeginPath=q.beginPath,q._removeMirroring=()=>{q.save=q.__originalSave,q.restore=q.__originalRestore,q.rotate=q.__originalRotate,q.scale=q.__originalScale,q.translate=q.__originalTranslate,q.transform=q.__originalTransform,q.setTransform=q.__originalSetTransform,q.resetTransform=q.__originalResetTransform,q.clip=q.__originalClip,q.moveTo=q.__originalMoveTo,q.lineTo=q.__originalLineTo,q.bezierCurveTo=q.__originalBezierCurveTo,q.rect=q.__originalRect,q.closePath=q.__originalClosePath,q.beginPath=q.__originalBeginPath,delete q._removeMirroring},q.save=function(){s.save(),this.__originalSave()},q.restore=function(){s.restore(),this.__originalRestore()},q.translate=function(i,a){s.translate(i,a),this.__originalTranslate(i,a)},q.scale=function(i,a){s.scale(i,a),this.__originalScale(i,a)},q.transform=function(i,a,l,n,g,u){s.transform(i,a,l,n,g,u),this.__originalTransform(i,a,l,n,g,u)},q.setTransform=function(i,a,l,n,g,u){s.setTransform(i,a,l,n,g,u),this.__originalSetTransform(i,a,l,n,g,u)},q.resetTransform=function(){s.resetTransform(),this.__originalResetTransform()},q.rotate=function(i){s.rotate(i),this.__originalRotate(i)},q.clip=function(i){s.clip(i),this.__originalClip(i)},q.moveTo=function(i,a){s.moveTo(i,a),this.__originalMoveTo(i,a)},q.lineTo=function(i,a){s.lineTo(i,a),this.__originalLineTo(i,a)},q.bezierCurveTo=function(i,a,l,n,g,u){s.bezierCurveTo(i,a,l,n,g,u),this.__originalBezierCurveTo(i,a,l,n,g,u)},q.rect=function(i,a,l,n){s.rect(i,a,l,n),this.__originalRect(i,a,l,n)},q.closePath=function(){s.closePath(),this.__originalClosePath()},q.beginPath=function(){s.beginPath(),this.__originalBeginPath()}}class wt{constructor(s){this.canvasFactory=s,this.cache=Object.create(null)}getCanvas(s,i,a){let l;return this.cache[s]!==void 0?(l=this.cache[s],this.canvasFactory.reset(l,i,a)):(l=this.canvasFactory.create(i,a),this.cache[s]=l),l}delete(s){delete this.cache[s]}clear(){for(const s in this.cache){const i=this.cache[s];this.canvasFactory.destroy(i),delete this.cache[s]}}}function Pt(q,s,i,a,l,n,g,u,p,b){const[d,o,h,x,S,K]=(0,at.getCurrentTransform)(q);if(o===0&&h===0){const mt=g*d+S,ot=Math.round(mt),At=u*x+K,E=Math.round(At),R=(g+p)*d+S,Q=Math.abs(Math.round(R)-ot)||1,W=(u+b)*x+K,vt=Math.abs(Math.round(W)-E)||1;return q.setTransform(Math.sign(d),0,0,Math.sign(x),ot,E),q.drawImage(s,i,a,l,n,0,0,Q,vt),q.setTransform(d,o,h,x,S,K),[Q,vt]}if(d===0&&x===0){const mt=u*h+S,ot=Math.round(mt),At=g*o+K,E=Math.round(At),R=(u+b)*h+S,Q=Math.abs(Math.round(R)-ot)||1,W=(g+p)*o+K,vt=Math.abs(Math.round(W)-E)||1;return q.setTransform(0,Math.sign(o),Math.sign(h),0,ot,E),q.drawImage(s,i,a,l,n,0,0,vt,Q),q.setTransform(d,o,h,x,S,K),[vt,Q]}q.drawImage(s,i,a,l,n,g,u,p,b);const Y=Math.hypot(d,o),gt=Math.hypot(h,x);return[Y*p,gt*b]}function Ct(q){const{width:s,height:i}=q;if(s>M||i>M)return null;const a=1e3,l=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=s+1;let g=new Uint8Array(n*(i+1)),u,p,b;const d=s+7&-8;let o=new Uint8Array(d*i),h=0;for(const Y of q.data){let gt=128;for(;gt>0;)o[h++]=Y&gt?0:255,gt>>=1}let x=0;for(h=0,o[h]!==0&&(g[0]=1,++x),p=1;p<s;p++)o[h]!==o[h+1]&&(g[p]=o[h]?2:1,++x),h++;for(o[h]!==0&&(g[p]=2,++x),u=1;u<i;u++){h=u*d,b=u*n,o[h-d]!==o[h]&&(g[b]=o[h]?1:8,++x);let Y=(o[h]?4:0)+(o[h-d]?8:0);for(p=1;p<s;p++)Y=(Y>>2)+(o[h+1]?4:0)+(o[h-d+1]?8:0),l[Y]&&(g[b+p]=l[Y],++x),h++;if(o[h-d]!==o[h]&&(g[b+p]=o[h]?2:4,++x),x>a)return null}for(h=d*(i-1),b=u*n,o[h]!==0&&(g[b]=8,++x),p=1;p<s;p++)o[h]!==o[h+1]&&(g[b+p]=o[h]?4:8,++x),h++;if(o[h]!==0&&(g[b+p]=4,++x),x>a)return null;const S=new Int32Array([0,n,-1,0,-n,0,0,0,1]),K=new Path2D;for(u=0;x&&u<=i;u++){let Y=u*n;const gt=Y+s;for(;Y<gt&&!g[Y];)Y++;if(Y===gt)continue;K.moveTo(Y%n,u);const mt=Y;let ot=g[Y];do{const At=S[ot];do Y+=At;while(!g[Y]);const E=g[Y];E!==5&&E!==10?(ot=E,g[Y]=0):(ot=E&51*ot>>4,g[Y]&=ot>>2|ot<<2),K.lineTo(Y%n,Y/n|0),g[Y]||--x}while(mt!==Y);--u}return o=null,g=null,function(Y){Y.save(),Y.scale(1/s,-1/i),Y.translate(0,-i),Y.fill(K),Y.beginPath(),Y.restore()}}class Nt{constructor(s,i){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=c.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=c.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=c.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,s,i])}clone(){const s=Object.create(this);return s.clipBox=this.clipBox.slice(),s}setCurrentPoint(s,i){this.x=s,this.y=i}updatePathMinMax(s,i,a){[i,a]=c.Util.applyTransform([i,a],s),this.minX=Math.min(this.minX,i),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,i),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(s,i){const a=c.Util.applyTransform(i,s),l=c.Util.applyTransform(i.slice(2),s),n=c.Util.applyTransform([i[0],i[3]],s),g=c.Util.applyTransform([i[2],i[1]],s);this.minX=Math.min(this.minX,a[0],l[0],n[0],g[0]),this.minY=Math.min(this.minY,a[1],l[1],n[1],g[1]),this.maxX=Math.max(this.maxX,a[0],l[0],n[0],g[0]),this.maxY=Math.max(this.maxY,a[1],l[1],n[1],g[1])}updateScalingPathMinMax(s,i){c.Util.scaleMinMax(s,i),this.minX=Math.min(this.minX,i[0]),this.minY=Math.min(this.minY,i[1]),this.maxX=Math.max(this.maxX,i[2]),this.maxY=Math.max(this.maxY,i[3])}updateCurvePathMinMax(s,i,a,l,n,g,u,p,b,d){const o=c.Util.bezierBoundingBox(i,a,l,n,g,u,p,b,d);d||this.updateRectMinMax(s,o)}getPathBoundingBox(s=U.FILL,i=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(s===U.STROKE){i||(0,c.unreachable)("Stroke bounding box must include transform.");const l=c.Util.singularValueDecompose2dScale(i),n=l[0]*this.lineWidth/2,g=l[1]*this.lineWidth/2;a[0]-=n,a[1]-=g,a[2]+=n,a[3]+=g}return a}updateClipFromPath(){const s=c.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(s||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(s){this.clipBox=s,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(s=U.FILL,i=null){return c.Util.intersect(this.clipBox,this.getPathBoundingBox(s,i))}}function Mt(q,s){if(typeof ImageData<"u"&&s instanceof ImageData){q.putImageData(s,0,0);return}const i=s.height,a=s.width,l=i%$,n=(i-l)/$,g=l===0?n:n+1,u=q.createImageData(a,$);let p=0,b;const d=s.data,o=u.data;let h,x,S,K;if(s.kind===c.ImageKind.GRAYSCALE_1BPP){const Y=d.byteLength,gt=new Uint32Array(o.buffer,0,o.byteLength>>2),mt=gt.length,ot=a+7>>3,At=4294967295,E=c.FeatureTest.isLittleEndian?4278190080:255;for(h=0;h<g;h++){for(S=h<n?$:l,b=0,x=0;x<S;x++){const R=Y-p;let Q=0;const W=R>ot?a:R*8-7,vt=W&-8;let J=0,y=0;for(;Q<vt;Q+=8)y=d[p++],gt[b++]=y&128?At:E,gt[b++]=y&64?At:E,gt[b++]=y&32?At:E,gt[b++]=y&16?At:E,gt[b++]=y&8?At:E,gt[b++]=y&4?At:E,gt[b++]=y&2?At:E,gt[b++]=y&1?At:E;for(;Q<W;Q++)J===0&&(y=d[p++],J=128),gt[b++]=y&J?At:E,J>>=1}for(;b<mt;)gt[b++]=0;q.putImageData(u,0,h*$)}}else if(s.kind===c.ImageKind.RGBA_32BPP){for(x=0,K=a*$*4,h=0;h<n;h++)o.set(d.subarray(p,p+K)),p+=K,q.putImageData(u,0,x),x+=$;h<g&&(K=a*l*4,o.set(d.subarray(p,p+K)),q.putImageData(u,0,x))}else if(s.kind===c.ImageKind.RGB_24BPP)for(S=$,K=a*S,h=0;h<g;h++){for(h>=n&&(S=l,K=a*S),b=0,x=K;x--;)o[b++]=d[p++],o[b++]=d[p++],o[b++]=d[p++],o[b++]=255;q.putImageData(u,0,h*$)}else throw new Error(`bad image kind: ${s.kind}`)}function qt(q,s){if(s.bitmap){q.drawImage(s.bitmap,0,0);return}const i=s.height,a=s.width,l=i%$,n=(i-l)/$,g=l===0?n:n+1,u=q.createImageData(a,$);let p=0;const b=s.data,d=u.data;for(let o=0;o<g;o++){const h=o<n?$:l;({srcPos:p}=z({src:b,srcPos:p,dest:d,width:a,height:h,nonBlackColor:0})),q.putImageData(u,0,o*$)}}function $t(q,s){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of i)q[a]!==void 0&&(s[a]=q[a]);q.setLineDash!==void 0&&(s.setLineDash(q.getLineDash()),s.lineDashOffset=q.lineDashOffset)}function Kt(q){if(q.strokeStyle=q.fillStyle="#000000",q.fillRule="nonzero",q.globalAlpha=1,q.lineWidth=1,q.lineCap="butt",q.lineJoin="miter",q.miterLimit=10,q.globalCompositeOperation="source-over",q.font="10px sans-serif",q.setLineDash!==void 0&&(q.setLineDash([]),q.lineDashOffset=0),!c.isNodeJS){const{filter:s}=q;s!=="none"&&s!==""&&(q.filter="none")}}function it(q,s,i,a){const l=q.length;for(let n=3;n<l;n+=4){const g=q[n];if(g===0)q[n-3]=s,q[n-2]=i,q[n-1]=a;else if(g<255){const u=255-g;q[n-3]=q[n-3]*g+s*u>>8,q[n-2]=q[n-2]*g+i*u>>8,q[n-1]=q[n-1]*g+a*u>>8}}}function St(q,s,i){const a=q.length,l=1/255;for(let n=3;n<a;n+=4){const g=i?i[q[n]]:q[n];s[n]=s[n]*g*l|0}}function Gt(q,s,i){const a=q.length;for(let l=3;l<a;l+=4){const n=q[l-3]*77+q[l-2]*152+q[l-1]*28;s[l]=i?s[l]*i[n>>8]>>8:s[l]*n>>16}}function zt(q,s,i,a,l,n,g,u,p,b,d){const o=!!n,h=o?n[0]:0,x=o?n[1]:0,S=o?n[2]:0,K=l==="Luminosity"?Gt:St,Y=Math.min(a,Math.ceil(1048576/i));for(let gt=0;gt<a;gt+=Y){const mt=Math.min(Y,a-gt),ot=q.getImageData(u-b,gt+(p-d),i,mt),At=s.getImageData(u,gt+p,i,mt);o&&it(ot.data,h,x,S),K(ot.data,At.data,g),s.putImageData(At,u,gt+p)}}function ie(q,s,i,a){const l=a[0],n=a[1],g=a[2]-l,u=a[3]-n;g===0||u===0||(zt(s.context,i,g,u,s.subtype,s.backdrop,s.transferMap,l,n,s.offsetX,s.offsetY),q.save(),q.globalAlpha=1,q.globalCompositeOperation="source-over",q.setTransform(1,0,0,1,0,0),q.drawImage(i.canvas,0,0),q.restore())}function ae(q,s){if(s)return!0;const i=c.Util.singularValueDecompose2dScale(q);i[0]=Math.fround(i[0]),i[1]=Math.fround(i[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*at.PixelsPerInch.PDF_TO_CSS_UNITS);return i[0]<=a&&i[1]<=a}const he=["butt","round","square"],ye=["miter","round","bevel"],Oe={},ce={},te=class te{constructor(s,i,a,l,n,{optionalContentConfig:g,markedContentStack:u=null},p,b){r(this,re);r(this,Yt);this.ctx=s,this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=i,this.objs=a,this.canvasFactory=l,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=g,this.cachedCanvases=new wt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=p,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=b,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(s,i=null){return typeof s=="string"?s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s):i}beginDrawing({transform:s,viewport:i,transparency:a=!1,background:l=null}){const n=this.ctx.canvas.width,g=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=l||"#ffffff",this.ctx.fillRect(0,0,n,g),this.ctx.fillStyle=u,a){const p=this.cachedCanvases.getCanvas("transparent",n,g);this.compositeCtx=this.ctx,this.transparentCanvas=p.canvas,this.ctx=p.context,this.ctx.save(),this.ctx.transform(...(0,at.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Kt(this.ctx),s&&(this.ctx.transform(...s),this.outputScaleX=s[0],this.outputScaleY=s[0]),this.ctx.transform(...i.transform),this.viewportScale=i.scale,this.baseTransform=(0,at.getCurrentTransform)(this.ctx)}executeOperatorList(s,i,a,l){const n=s.argsArray,g=s.fnArray;let u=i||0;const p=n.length;if(p===u)return u;const b=p-u>T&&typeof a=="function",d=b?Date.now()+N:0;let o=0;const h=this.commonObjs,x=this.objs;let S;for(;;){if(l!==void 0&&u===l.nextBreakPoint)return l.breakIt(u,a),u;if(S=g[u],S!==c.OPS.dependency)this[S].apply(this,n[u]);else for(const K of n[u]){const Y=K.startsWith("g_")?h:x;if(!Y.has(K))return Y.get(K,a),u}if(u++,u===p)return u;if(b&&++o>T){if(Date.now()>d)return a(),u;o=0}}}endDrawing(){v(this,re,un).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const s of this._cachedBitmapsMap.values()){for(const i of s.values())typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&(i.width=i.height=0);s.clear()}this._cachedBitmapsMap.clear(),v(this,Yt,pn).call(this)}_scaleImage(s,i){const a=s.width,l=s.height;let n=Math.max(Math.hypot(i[0],i[1]),1),g=Math.max(Math.hypot(i[2],i[3]),1),u=a,p=l,b="prescale1",d,o;for(;n>2&&u>1||g>2&&p>1;){let h=u,x=p;n>2&&u>1&&(h=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),n/=u/h),g>2&&p>1&&(x=p>=16384?Math.floor(p/2)-1||1:Math.ceil(p)/2,g/=p/x),d=this.cachedCanvases.getCanvas(b,h,x),o=d.context,o.clearRect(0,0,h,x),o.drawImage(s,0,0,u,p,0,0,h,x),s=d.canvas,u=h,p=x,b=b==="prescale1"?"prescale2":"prescale1"}return{img:s,paintWidth:u,paintHeight:p}}_createMaskCanvas(s){const i=this.ctx,{width:a,height:l}=s,n=this.current.fillColor,g=this.current.patternFill,u=(0,at.getCurrentTransform)(i);let p,b,d,o;if((s.bitmap||s.data)&&s.count>1){const W=s.bitmap||s.data.buffer;b=JSON.stringify(g?u:[u.slice(0,4),n]),p=this._cachedBitmapsMap.get(W),p||(p=new Map,this._cachedBitmapsMap.set(W,p));const vt=p.get(b);if(vt&&!g){const J=Math.round(Math.min(u[0],u[2])+u[4]),y=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:vt,offsetX:J,offsetY:y}}d=vt}d||(o=this.cachedCanvases.getCanvas("maskCanvas",a,l),qt(o.context,s));let h=c.Util.transform(u,[1/a,0,0,-1/l,0,0]);h=c.Util.transform(h,[1,0,0,1,0,-l]);const[x,S,K,Y]=c.Util.getAxialAlignedBoundingBox([0,0,a,l],h),gt=Math.round(K-x)||1,mt=Math.round(Y-S)||1,ot=this.cachedCanvases.getCanvas("fillCanvas",gt,mt),At=ot.context,E=x,R=S;At.translate(-E,-R),At.transform(...h),d||(d=this._scaleImage(o.canvas,(0,at.getCurrentTransformInverse)(At)),d=d.img,p&&g&&p.set(b,d)),At.imageSmoothingEnabled=ae((0,at.getCurrentTransform)(At),s.interpolate),Pt(At,d,0,0,d.width,d.height,0,0,a,l),At.globalCompositeOperation="source-in";const Q=c.Util.transform((0,at.getCurrentTransformInverse)(At),[1,0,0,1,-E,-R]);return At.fillStyle=g?n.getPattern(i,this,Q,U.FILL):n,At.fillRect(0,0,a,l),p&&!g&&(this.cachedCanvases.delete("fillCanvas"),p.set(b,ot.canvas)),{canvas:ot.canvas,offsetX:Math.round(E),offsetY:Math.round(R)}}setLineWidth(s){s!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=s,this.ctx.lineWidth=s}setLineCap(s){this.ctx.lineCap=he[s]}setLineJoin(s){this.ctx.lineJoin=ye[s]}setMiterLimit(s){this.ctx.miterLimit=s}setDash(s,i){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(s),a.lineDashOffset=i)}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[i,a]of s)switch(i){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const s=this.inSMaskMode;this.current.activeSMask&&!s?this.beginSMaskMode():!this.current.activeSMask&&s&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const s=this.ctx.canvas.width,i=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(a,s,i);this.suspendedCtx=this.ctx,this.ctx=l.context;const n=this.ctx;n.setTransform(...(0,at.getCurrentTransform)(this.suspendedCtx)),$t(this.suspendedCtx,n),et(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),$t(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(s){if(!this.current.activeSMask)return;s?(s[0]=Math.floor(s[0]),s[1]=Math.floor(s[1]),s[2]=Math.ceil(s[2]),s[3]=Math.ceil(s[3])):s=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const i=this.current.activeSMask,a=this.suspendedCtx;ie(a,i,this.ctx,s),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?($t(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const s=this.current;this.stateStack.push(s),this.current=s.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),$t(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(s,i,a,l,n,g){this.ctx.transform(s,i,a,l,n,g),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(s,i,a){const l=this.ctx,n=this.current;let g=n.x,u=n.y,p,b;const d=(0,at.getCurrentTransform)(l),o=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,h=o?a.slice(0):null;for(let x=0,S=0,K=s.length;x<K;x++)switch(s[x]|0){case c.OPS.rectangle:g=i[S++],u=i[S++];const Y=i[S++],gt=i[S++],mt=g+Y,ot=u+gt;l.moveTo(g,u),Y===0||gt===0?l.lineTo(mt,ot):(l.lineTo(mt,u),l.lineTo(mt,ot),l.lineTo(g,ot)),o||n.updateRectMinMax(d,[g,u,mt,ot]),l.closePath();break;case c.OPS.moveTo:g=i[S++],u=i[S++],l.moveTo(g,u),o||n.updatePathMinMax(d,g,u);break;case c.OPS.lineTo:g=i[S++],u=i[S++],l.lineTo(g,u),o||n.updatePathMinMax(d,g,u);break;case c.OPS.curveTo:p=g,b=u,g=i[S+4],u=i[S+5],l.bezierCurveTo(i[S],i[S+1],i[S+2],i[S+3],g,u),n.updateCurvePathMinMax(d,p,b,i[S],i[S+1],i[S+2],i[S+3],g,u,h),S+=6;break;case c.OPS.curveTo2:p=g,b=u,l.bezierCurveTo(g,u,i[S],i[S+1],i[S+2],i[S+3]),n.updateCurvePathMinMax(d,p,b,g,u,i[S],i[S+1],i[S+2],i[S+3],h),g=i[S+2],u=i[S+3],S+=4;break;case c.OPS.curveTo3:p=g,b=u,g=i[S+2],u=i[S+3],l.bezierCurveTo(i[S],i[S+1],g,u,g,u),n.updateCurvePathMinMax(d,p,b,i[S],i[S+1],g,u,g,u,h),S+=4;break;case c.OPS.closePath:l.closePath();break}o&&n.updateScalingPathMinMax(d,h),n.setCurrentPoint(g,u)}closePath(){this.ctx.closePath()}stroke(s=!0){const i=this.ctx,a=this.current.strokeColor;i.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&(a!=null&&a.getPattern)?(i.save(),i.strokeStyle=a.getPattern(i,this,(0,at.getCurrentTransformInverse)(i),U.STROKE),this.rescaleAndStroke(!1),i.restore()):this.rescaleAndStroke(!0)),s&&this.consumePath(this.current.getClippedPathBoundingBox()),i.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(s=!0){const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let n=!1;l&&(i.save(),i.fillStyle=a.getPattern(i,this,(0,at.getCurrentTransformInverse)(i),U.FILL),n=!0);const g=this.current.getClippedPathBoundingBox();this.contentVisible&&g!==null&&(this.pendingEOFill?(i.fill("evenodd"),this.pendingEOFill=!1):i.fill()),n&&i.restore(),s&&this.consumePath(g)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Oe}eoClip(){this.pendingClip=ce}beginText(){this.current.textMatrix=c.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const s=this.pendingTextPaths,i=this.ctx;if(s===void 0){i.beginPath();return}i.save(),i.beginPath();for(const a of s)i.setTransform(...a.transform),i.translate(a.x,a.y),a.addToPath(i,a.fontSize);i.restore(),i.clip(),i.beginPath(),delete this.pendingTextPaths}setCharSpacing(s){this.current.charSpacing=s}setWordSpacing(s){this.current.wordSpacing=s}setHScale(s){this.current.textHScale=s/100}setLeading(s){this.current.leading=-s}setFont(s,i){var d;const a=this.commonObjs.get(s),l=this.current;if(!a)throw new Error(`Can't find font for ${s}`);if(l.fontMatrix=a.fontMatrix||c.FONT_IDENTITY_MATRIX,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&(0,c.warn)("Invalid font matrix for font "+s),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=a,this.current.fontSize=i,a.isType3Font)return;const n=a.loadedName||"sans-serif",g=((d=a.systemFontInfo)==null?void 0:d.css)||`"${n}", ${a.fallbackName}`;let u="normal";a.black?u="900":a.bold&&(u="bold");const p=a.italic?"italic":"normal";let b=i;i<pt?b=pt:i>tt&&(b=tt),this.current.fontSizeScale=i/b,this.ctx.font=`${p} ${u} ${b}px ${g}`}setTextRenderingMode(s){this.current.textRenderingMode=s}setTextRise(s){this.current.textRise=s}moveText(s,i){this.current.x=this.current.lineX+=s,this.current.y=this.current.lineY+=i}setLeadingMoveText(s,i){this.setLeading(-i),this.moveText(s,i)}setTextMatrix(s,i,a,l,n,g){this.current.textMatrix=[s,i,a,l,n,g],this.current.textMatrixScale=Math.hypot(s,i),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(s,i,a,l){const n=this.ctx,g=this.current,u=g.font,p=g.textRenderingMode,b=g.fontSize/g.fontSizeScale,d=p&c.TextRenderingMode.FILL_STROKE_MASK,o=!!(p&c.TextRenderingMode.ADD_TO_PATH_FLAG),h=g.patternFill&&!u.missingFile;let x;(u.disableFontFace||o||h)&&(x=u.getPathGenerator(this.commonObjs,s)),u.disableFontFace||h?(n.save(),n.translate(i,a),n.beginPath(),x(n,b),l&&n.setTransform(...l),(d===c.TextRenderingMode.FILL||d===c.TextRenderingMode.FILL_STROKE)&&n.fill(),(d===c.TextRenderingMode.STROKE||d===c.TextRenderingMode.FILL_STROKE)&&n.stroke(),n.restore()):((d===c.TextRenderingMode.FILL||d===c.TextRenderingMode.FILL_STROKE)&&n.fillText(s,i,a),(d===c.TextRenderingMode.STROKE||d===c.TextRenderingMode.FILL_STROKE)&&n.strokeText(s,i,a)),o&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,at.getCurrentTransform)(n),x:i,y:a,fontSize:b,addToPath:x})}get isFontSubpixelAAEnabled(){const{context:s}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);s.scale(1.5,1),s.fillText("I",0,10);const i=s.getImageData(0,0,10,10).data;let a=!1;for(let l=3;l<i.length;l+=4)if(i[l]>0&&i[l]<255){a=!0;break}return(0,c.shadow)(this,"isFontSubpixelAAEnabled",a)}showText(s){const i=this.current,a=i.font;if(a.isType3Font)return this.showType3Text(s);const l=i.fontSize;if(l===0)return;const n=this.ctx,g=i.fontSizeScale,u=i.charSpacing,p=i.wordSpacing,b=i.fontDirection,d=i.textHScale*b,o=s.length,h=a.vertical,x=h?1:-1,S=a.defaultVMetrics,K=l*i.fontMatrix[0],Y=i.textRenderingMode===c.TextRenderingMode.FILL&&!a.disableFontFace&&!i.patternFill;n.save(),n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),b>0?n.scale(d,-1):n.scale(d,1);let gt;if(i.patternFill){n.save();const R=i.fillColor.getPattern(n,this,(0,at.getCurrentTransformInverse)(n),U.FILL);gt=(0,at.getCurrentTransform)(n),n.restore(),n.fillStyle=R}let mt=i.lineWidth;const ot=i.textMatrixScale;if(ot===0||mt===0){const R=i.textRenderingMode&c.TextRenderingMode.FILL_STROKE_MASK;(R===c.TextRenderingMode.STROKE||R===c.TextRenderingMode.FILL_STROKE)&&(mt=this.getSinglePixelWidth())}else mt/=ot;if(g!==1&&(n.scale(g,g),mt/=g),n.lineWidth=mt,a.isInvalidPDFjsFont){const R=[];let Q=0;for(const W of s)R.push(W.unicode),Q+=W.width;n.fillText(R.join(""),0,0),i.x+=Q*K*d,n.restore(),this.compose();return}let At=0,E;for(E=0;E<o;++E){const R=s[E];if(typeof R=="number"){At+=x*R*l/1e3;continue}let Q=!1;const W=(R.isSpace?p:0)+u,vt=R.fontChar,J=R.accent;let y,P,H=R.width;if(h){const Et=R.vmetric||S,Tt=-(R.vmetric?Et[1]:H*.5)*K,Bt=Et[2]*K;H=Et?-Et[0]:H,y=Tt/g,P=(At+Bt)/g}else y=At/g,P=0;if(a.remeasure&&H>0){const Et=n.measureText(vt).width*1e3/l*g;if(H<Et&&this.isFontSubpixelAAEnabled){const Tt=H/Et;Q=!0,n.save(),n.scale(Tt,1),y/=Tt}else H!==Et&&(y+=(H-Et)/2e3*l/g)}if(this.contentVisible&&(R.isInFont||a.missingFile)){if(Y&&!J)n.fillText(vt,y,P);else if(this.paintChar(vt,y,P,gt),J){const Et=y+l*J.offset.x/g,Tt=P-l*J.offset.y/g;this.paintChar(J.fontChar,Et,Tt,gt)}}const ht=h?H*K-W*b:H*K+W*b;At+=ht,Q&&n.restore()}h?i.y-=At:i.x+=At*d,n.restore(),this.compose()}showType3Text(s){const i=this.ctx,a=this.current,l=a.font,n=a.fontSize,g=a.fontDirection,u=l.vertical?1:-1,p=a.charSpacing,b=a.wordSpacing,d=a.textHScale*g,o=a.fontMatrix||c.FONT_IDENTITY_MATRIX,h=s.length,x=a.textRenderingMode===c.TextRenderingMode.INVISIBLE;let S,K,Y,gt;if(!(x||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),i.transform(...a.textMatrix),i.translate(a.x,a.y),i.scale(d,g),S=0;S<h;++S){if(K=s[S],typeof K=="number"){gt=u*K*n/1e3,this.ctx.translate(gt,0),a.x+=gt*d;continue}const mt=(K.isSpace?b:0)+p,ot=l.charProcOperatorList[K.operatorListId];if(!ot){(0,c.warn)(`Type3 character "${K.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=K,this.save(),i.scale(n,n),i.transform(...o),this.executeOperatorList(ot),this.restore()),Y=c.Util.applyTransform([K.width,0],o)[0]*n+mt,i.translate(Y,0),a.x+=Y*d}i.restore(),this.processingType3=null}}setCharWidth(s,i){}setCharWidthAndBounds(s,i,a,l,n,g){this.ctx.rect(a,l,n-a,g-l),this.ctx.clip(),this.endPath()}getColorN_Pattern(s){let i;if(s[0]==="TilingPattern"){const a=s[1],l=this.baseTransform||(0,at.getCurrentTransform)(this.ctx),n={createCanvasGraphics:g=>new te(g,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};i=new D(s,a,this.ctx,n,l)}else i=this._getPattern(s[1],s[2]);return i}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(s,i,a){const l=c.Util.makeHexColor(s,i,a);this.ctx.strokeStyle=l,this.current.strokeColor=l}setFillRGBColor(s,i,a){const l=c.Util.makeHexColor(s,i,a);this.ctx.fillStyle=l,this.current.fillColor=l,this.current.patternFill=!1}_getPattern(s,i=null){let a;return this.cachedPatterns.has(s)?a=this.cachedPatterns.get(s):(a=C(this.getObject(s)),this.cachedPatterns.set(s,a)),i&&(a.matrix=i),a}shadingFill(s){if(!this.contentVisible)return;const i=this.ctx;this.save();const a=this._getPattern(s);i.fillStyle=a.getPattern(i,this,(0,at.getCurrentTransformInverse)(i),U.SHADING);const l=(0,at.getCurrentTransformInverse)(i);if(l){const{width:n,height:g}=i.canvas,[u,p,b,d]=c.Util.getAxialAlignedBoundingBox([0,0,n,g],l);this.ctx.fillRect(u,p,b-u,d-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,c.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,c.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(s,i){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(s)&&s.length===6&&this.transform(...s),this.baseTransform=(0,at.getCurrentTransform)(this.ctx),i)){const a=i[2]-i[0],l=i[3]-i[1];this.ctx.rect(i[0],i[1],a,l),this.current.updateRectMinMax((0,at.getCurrentTransform)(this.ctx),i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(s){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;s.isolated||(0,c.info)("TODO: Support non-isolated groups."),s.knockout&&(0,c.warn)("Knockout groups not supported.");const a=(0,at.getCurrentTransform)(i);if(s.matrix&&i.transform(...s.matrix),!s.bbox)throw new Error("Bounding box is required.");let l=c.Util.getAxialAlignedBoundingBox(s.bbox,(0,at.getCurrentTransform)(i));const n=[0,0,i.canvas.width,i.canvas.height];l=c.Util.intersect(l,n)||[0,0,0,0];const g=Math.floor(l[0]),u=Math.floor(l[1]);let p=Math.max(Math.ceil(l[2])-g,1),b=Math.max(Math.ceil(l[3])-u,1),d=1,o=1;p>L&&(d=p/L,p=L),b>L&&(o=b/L,b=L),this.current.startNewPathAndClipBox([0,0,p,b]);let h="groupAt"+this.groupLevel;s.smask&&(h+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(h,p,b),S=x.context;S.scale(1/d,1/o),S.translate(-g,-u),S.transform(...a),s.smask?this.smaskStack.push({canvas:x.canvas,context:S,offsetX:g,offsetY:u,scaleX:d,scaleY:o,subtype:s.smask.subtype,backdrop:s.smask.backdrop,transferMap:s.smask.transferMap||null,startTransformInverse:null}):(i.setTransform(1,0,0,1,0,0),i.translate(g,u),i.scale(d,o),i.save()),$t(i,S),this.ctx=S,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(s){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,s.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const l=(0,at.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...l);const n=c.Util.getAxialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l);this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(s,i,a,l,n){if(v(this,re,un).call(this),Kt(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(i)&&i.length===4){const g=i[2]-i[0],u=i[3]-i[1];if(n&&this.annotationCanvasMap){a=a.slice(),a[4]-=i[0],a[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=g,i[3]=u;const[p,b]=c.Util.singularValueDecompose2dScale((0,at.getCurrentTransform)(this.ctx)),{viewportScale:d}=this,o=Math.ceil(g*this.outputScaleX*d),h=Math.ceil(u*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(o,h);const{canvas:x,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(s,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(p,0,0,-b,0,u*b),Kt(this.ctx)}else Kt(this.ctx),this.ctx.rect(i[0],i[1],g,u),this.ctx.clip(),this.endPath()}this.current=new Nt(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...l)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),v(this,Yt,pn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(s){if(!this.contentVisible)return;const i=s.count;s=this.getObject(s.data,s),s.count=i;const a=this.ctx,l=this.processingType3;if(l&&(l.compiled===void 0&&(l.compiled=Ct(s)),l.compiled)){l.compiled(a);return}const n=this._createMaskCanvas(s),g=n.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(g,n.offsetX,n.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(s,i,a=0,l=0,n,g){if(!this.contentVisible)return;s=this.getObject(s.data,s);const u=this.ctx;u.save();const p=(0,at.getCurrentTransform)(u);u.transform(i,a,l,n,0,0);const b=this._createMaskCanvas(s);u.setTransform(1,0,0,1,b.offsetX-p[4],b.offsetY-p[5]);for(let d=0,o=g.length;d<o;d+=2){const h=c.Util.transform(p,[i,a,l,n,g[d],g[d+1]]),[x,S]=c.Util.applyTransform([0,0],h);u.drawImage(b.canvas,x,S)}u.restore(),this.compose()}paintImageMaskXObjectGroup(s){if(!this.contentVisible)return;const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;for(const n of s){const{data:g,width:u,height:p,transform:b}=n,d=this.cachedCanvases.getCanvas("maskCanvas",u,p),o=d.context;o.save();const h=this.getObject(g,n);qt(o,h),o.globalCompositeOperation="source-in",o.fillStyle=l?a.getPattern(o,this,(0,at.getCurrentTransformInverse)(i),U.FILL):a,o.fillRect(0,0,u,p),o.restore(),i.save(),i.transform(...b),i.scale(1,-1),Pt(i,d.canvas,0,0,u,p,0,-1,1,1),i.restore()}this.compose()}paintImageXObject(s){if(!this.contentVisible)return;const i=this.getObject(s);if(!i){(0,c.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(i)}paintImageXObjectRepeat(s,i,a,l){if(!this.contentVisible)return;const n=this.getObject(s);if(!n){(0,c.warn)("Dependent image isn't ready yet");return}const g=n.width,u=n.height,p=[];for(let b=0,d=l.length;b<d;b+=2)p.push({transform:[i,0,0,a,l[b],l[b+1]],x:0,y:0,w:g,h:u});this.paintInlineImageXObjectGroup(n,p)}applyTransferMapsToCanvas(s){return this.current.transferMaps!=="none"&&(s.filter=this.current.transferMaps,s.drawImage(s.canvas,0,0),s.filter="none"),s.canvas}applyTransferMapsToBitmap(s){if(this.current.transferMaps==="none")return s.bitmap;const{bitmap:i,width:a,height:l}=s,n=this.cachedCanvases.getCanvas("inlineImage",a,l),g=n.context;return g.filter=this.current.transferMaps,g.drawImage(i,0,0),g.filter="none",n.canvas}paintInlineImageXObject(s){if(!this.contentVisible)return;const i=s.width,a=s.height,l=this.ctx;if(this.save(),!c.isNodeJS){const{filter:u}=l;u!=="none"&&u!==""&&(l.filter="none")}l.scale(1/i,-1/a);let n;if(s.bitmap)n=this.applyTransferMapsToBitmap(s);else if(typeof HTMLElement=="function"&&s instanceof HTMLElement||!s.data)n=s;else{const u=this.cachedCanvases.getCanvas("inlineImage",i,a).context;Mt(u,s),n=this.applyTransferMapsToCanvas(u)}const g=this._scaleImage(n,(0,at.getCurrentTransformInverse)(l));l.imageSmoothingEnabled=ae((0,at.getCurrentTransform)(l),s.interpolate),Pt(l,g.img,0,0,g.paintWidth,g.paintHeight,0,-a,i,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(s,i){if(!this.contentVisible)return;const a=this.ctx;let l;if(s.bitmap)l=s.bitmap;else{const n=s.width,g=s.height,u=this.cachedCanvases.getCanvas("inlineImage",n,g).context;Mt(u,s),l=this.applyTransferMapsToCanvas(u)}for(const n of i)a.save(),a.transform(...n.transform),a.scale(1,-1),Pt(a,l,n.x,n.y,n.w,n.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(s){}markPointProps(s,i){}beginMarkedContent(s){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(s,i){s==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(s){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(s);const a=this.ctx;this.pendingClip&&(i||(this.pendingClip===ce?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const s=(0,at.getCurrentTransform)(this.ctx);if(s[1]===0&&s[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(s[0]),Math.abs(s[3]));else{const i=Math.abs(s[0]*s[3]-s[2]*s[1]),a=Math.hypot(s[0],s[2]),l=Math.hypot(s[1],s[3]);this._cachedGetSinglePixelWidth=Math.max(a,l)/i}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:s}=this.current,{a:i,b:a,c:l,d:n}=this.ctx.getTransform();let g,u;if(a===0&&l===0){const p=Math.abs(i),b=Math.abs(n);if(p===b)if(s===0)g=u=1/p;else{const d=p*s;g=u=d<1?1/d:1}else if(s===0)g=1/p,u=1/b;else{const d=p*s,o=b*s;g=d<1?1/d:1,u=o<1?1/o:1}}else{const p=Math.abs(i*n-a*l),b=Math.hypot(i,a),d=Math.hypot(l,n);if(s===0)g=d/p,u=b/p;else{const o=s*p;g=d>o?d/o:1,u=b>o?b/o:1}}this._cachedScaleForStroking[0]=g,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(s){const{ctx:i}=this,{lineWidth:a}=this.current,[l,n]=this.getScaleForStroking();if(i.lineWidth=a||1,l===1&&n===1){i.stroke();return}const g=i.getLineDash();if(s&&i.save(),i.scale(l,n),g.length>0){const u=Math.max(l,n);i.setLineDash(g.map(p=>p/u)),i.lineDashOffset/=u}i.stroke(),s&&i.restore()}isContentVisible(){for(let s=this.markedContentStack.length-1;s>=0;s--)if(!this.markedContentStack[s].visible)return!1;return!0}};re=new WeakSet,un=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Yt=new WeakSet,pn=function(){if(this.pageColors){const s=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(s!=="none"){const i=this.ctx.filter;this.ctx.filter=s,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=i}}};let fe=te;for(const q in c.OPS)fe.prototype[q]!==void 0&&(fe.prototype[c.OPS[q]]=fe.prototype[q])},419:(le,Wt,ut)=>{var $t,Kt,it,St,Gt,zt,ie,Gs,he,Ws,Oe,$s,fe,gn,re,Oi,Yt,Bi,te,di,s,ui;ut.d(Wt,{DOMCMapReaderFactory:()=>k,DOMCanvasFactory:()=>V,DOMFilterFactory:()=>bt,DOMSVGFactory:()=>I,DOMStandardFontDataFactory:()=>j,PDFDateString:()=>$,PageViewport:()=>C,PixelsPerInch:()=>nt,RenderingCancelledException:()=>F,StatTimer:()=>L,fetchData:()=>O,getColorValues:()=>Pt,getCurrentTransform:()=>Ct,getCurrentTransformInverse:()=>Nt,getFilenameFromUrl:()=>pt,getPdfFilenameFromUrl:()=>tt,getRGB:()=>wt,getXfaPageViewport:()=>et,isDataScheme:()=>D,isPdfFile:()=>z,isValidFetchUrl:()=>N,noContextMenu:()=>T,setLayerDimensions:()=>Mt});var c=ut(583),at=ut(292);const U="http://www.w3.org/2000/svg",qt=class qt{};Ae(qt,"CSS",96),Ae(qt,"PDF",72),Ae(qt,"PDF_TO_CSS_UNITS",qt.CSS/qt.PDF);let nt=qt;class bt extends c.BaseFilterFactory{constructor({docId:n,ownerDocument:g=globalThis.document}={}){super();r(this,ie);r(this,he);r(this,Oe);r(this,fe);r(this,re);r(this,Yt);r(this,te);r(this,s);r(this,$t,void 0);r(this,Kt,void 0);r(this,it,void 0);r(this,St,void 0);r(this,Gt,void 0);r(this,zt,0);w(this,it,n),w(this,St,g)}addFilter(n){if(!n)return"none";let g=t(this,ie,Gs).get(n);if(g)return g;let u,p,b,d;if(n.length===1){const S=n[0],K=new Array(256);for(let Y=0;Y<256;Y++)K[Y]=S[Y]/255;d=u=p=b=K.join(",")}else{const[S,K,Y]=n,gt=new Array(256),mt=new Array(256),ot=new Array(256);for(let At=0;At<256;At++)gt[At]=S[At]/255,mt[At]=K[At]/255,ot[At]=Y[At]/255;u=gt.join(","),p=mt.join(","),b=ot.join(","),d=`${u}${p}${b}`}if(g=t(this,ie,Gs).get(d),g)return t(this,ie,Gs).set(n,g),g;const o=`g_${t(this,it)}_transfer_map_${ps(this,zt)._++}`,h=`url(#${o})`;t(this,ie,Gs).set(n,h),t(this,ie,Gs).set(d,h);const x=v(this,re,Oi).call(this,o);return v(this,te,di).call(this,u,p,b,x),h}addHCMFilter(n,g){var gt;const u=`${n}-${g}`,p="base";let b=t(this,he,Ws).get(p);if((b==null?void 0:b.key)===u||(b?((gt=b.filter)==null||gt.remove(),b.key=u,b.url="none",b.filter=null):(b={key:u,url:"none",filter:null},t(this,he,Ws).set(p,b)),!n||!g))return b.url;const d=v(this,s,ui).call(this,n);n=at.Util.makeHexColor(...d);const o=v(this,s,ui).call(this,g);if(g=at.Util.makeHexColor(...o),t(this,Oe,$s).style.color="",n==="#000000"&&g==="#ffffff"||n===g)return b.url;const h=new Array(256);for(let mt=0;mt<=255;mt++){const ot=mt/255;h[mt]=ot<=.03928?ot/12.92:((ot+.055)/1.055)**2.4}const x=h.join(","),S=`g_${t(this,it)}_hcm_filter`,K=b.filter=v(this,re,Oi).call(this,S);v(this,te,di).call(this,x,x,x,K),v(this,fe,gn).call(this,K);const Y=(mt,ot)=>{const At=d[mt]/255,E=o[mt]/255,R=new Array(ot+1);for(let Q=0;Q<=ot;Q++)R[Q]=At+Q/ot*(E-At);return R.join(",")};return v(this,te,di).call(this,Y(0,5),Y(1,5),Y(2,5),K),b.url=`url(#${S})`,b.url}addHighlightHCMFilter(n,g,u,p,b){var E;const d=`${g}-${u}-${p}-${b}`;let o=t(this,he,Ws).get(n);if((o==null?void 0:o.key)===d||(o?((E=o.filter)==null||E.remove(),o.key=d,o.url="none",o.filter=null):(o={key:d,url:"none",filter:null},t(this,he,Ws).set(n,o)),!g||!u))return o.url;const[h,x]=[g,u].map(v(this,s,ui).bind(this));let S=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),K=Math.round(.2126*x[0]+.7152*x[1]+.0722*x[2]),[Y,gt]=[p,b].map(v(this,s,ui).bind(this));K<S&&([S,K,Y,gt]=[K,S,gt,Y]),t(this,Oe,$s).style.color="";const mt=(R,Q,W)=>{const vt=new Array(256),J=(K-S)/W,y=R/255,P=(Q-R)/(255*W);let H=0;for(let ht=0;ht<=W;ht++){const Et=Math.round(S+ht*J),Tt=y+ht*P;for(let Bt=H;Bt<=Et;Bt++)vt[Bt]=Tt;H=Et+1}for(let ht=H;ht<256;ht++)vt[ht]=vt[H-1];return vt.join(",")},ot=`g_${t(this,it)}_hcm_${n}_filter`,At=o.filter=v(this,re,Oi).call(this,ot);return v(this,fe,gn).call(this,At),v(this,te,di).call(this,mt(Y[0],gt[0],5),mt(Y[1],gt[1],5),mt(Y[2],gt[2],5),At),o.url=`url(#${ot})`,o.url}destroy(n=!1){n&&t(this,he,Ws).size!==0||(t(this,Kt)&&(t(this,Kt).parentNode.parentNode.remove(),w(this,Kt,null)),t(this,$t)&&(t(this,$t).clear(),w(this,$t,null)),w(this,zt,0))}}$t=new WeakMap,Kt=new WeakMap,it=new WeakMap,St=new WeakMap,Gt=new WeakMap,zt=new WeakMap,ie=new WeakSet,Gs=function(){return t(this,$t)||w(this,$t,new Map)},he=new WeakSet,Ws=function(){return t(this,Gt)||w(this,Gt,new Map)},Oe=new WeakSet,$s=function(){if(!t(this,Kt)){const n=t(this,St).createElement("div"),{style:g}=n;g.visibility="hidden",g.contain="strict",g.width=g.height=0,g.position="absolute",g.top=g.left=0,g.zIndex=-1;const u=t(this,St).createElementNS(U,"svg");u.setAttribute("width",0),u.setAttribute("height",0),w(this,Kt,t(this,St).createElementNS(U,"defs")),n.append(u),u.append(t(this,Kt)),t(this,St).body.append(n)}return t(this,Kt)},fe=new WeakSet,gn=function(n){const g=t(this,St).createElementNS(U,"feColorMatrix");g.setAttribute("type","matrix"),g.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),n.append(g)},re=new WeakSet,Oi=function(n){const g=t(this,St).createElementNS(U,"filter");return g.setAttribute("color-interpolation-filters","sRGB"),g.setAttribute("id",n),t(this,Oe,$s).append(g),g},Yt=new WeakSet,Bi=function(n,g,u){const p=t(this,St).createElementNS(U,g);p.setAttribute("type","discrete"),p.setAttribute("tableValues",u),n.append(p)},te=new WeakSet,di=function(n,g,u,p){const b=t(this,St).createElementNS(U,"feComponentTransfer");p.append(b),v(this,Yt,Bi).call(this,b,"feFuncR",n),v(this,Yt,Bi).call(this,b,"feFuncG",g),v(this,Yt,Bi).call(this,b,"feFuncB",u)},s=new WeakSet,ui=function(n){return t(this,Oe,$s).style.color=n,wt(getComputedStyle(t(this,Oe,$s)).getPropertyValue("color"))};class V extends c.BaseCanvasFactory{constructor({ownerDocument:l=globalThis.document}={}){super(),this._document=l}_createCanvas(l,n){const g=this._document.createElement("canvas");return g.width=l,g.height=n,g}}async function O(a,l="text"){if(N(a,document.baseURI)){const n=await fetch(a);if(!n.ok)throw new Error(n.statusText);switch(l){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,g)=>{const u=new XMLHttpRequest;u.open("GET",a,!0),u.responseType=l,u.onreadystatechange=()=>{if(u.readyState===XMLHttpRequest.DONE){if(u.status===200||u.status===0){switch(l){case"arraybuffer":case"blob":case"json":n(u.response);return}n(u.responseText);return}g(new Error(u.statusText))}},u.send(null)})}class k extends c.BaseCMapReaderFactory{_fetchData(l,n){return O(l,this.isCompressed?"arraybuffer":"text").then(g=>({cMapData:g instanceof ArrayBuffer?new Uint8Array(g):(0,at.stringToBytes)(g),compressionType:n}))}}class j extends c.BaseStandardFontDataFactory{_fetchData(l){return O(l,"arraybuffer").then(n=>new Uint8Array(n))}}class I extends c.BaseSVGFactory{_createSVG(l){return document.createElementNS(U,l)}}class C{constructor({viewBox:l,scale:n,rotation:g,offsetX:u=0,offsetY:p=0,dontFlip:b=!1}){this.viewBox=l,this.scale=n,this.rotation=g,this.offsetX=u,this.offsetY=p;const d=(l[2]+l[0])/2,o=(l[3]+l[1])/2;let h,x,S,K;switch(g%=360,g<0&&(g+=360),g){case 180:h=-1,x=0,S=0,K=1;break;case 90:h=0,x=1,S=1,K=0;break;case 270:h=0,x=-1,S=-1,K=0;break;case 0:h=1,x=0,S=0,K=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}b&&(S=-S,K=-K);let Y,gt,mt,ot;h===0?(Y=Math.abs(o-l[1])*n+u,gt=Math.abs(d-l[0])*n+p,mt=(l[3]-l[1])*n,ot=(l[2]-l[0])*n):(Y=Math.abs(d-l[0])*n+u,gt=Math.abs(o-l[1])*n+p,mt=(l[2]-l[0])*n,ot=(l[3]-l[1])*n),this.transform=[h*n,x*n,S*n,K*n,Y-h*n*d-S*n*o,gt-x*n*d-K*n*o],this.width=mt,this.height=ot}get rawDims(){const{viewBox:l}=this;return(0,at.shadow)(this,"rawDims",{pageWidth:l[2]-l[0],pageHeight:l[3]-l[1],pageX:l[0],pageY:l[1]})}clone({scale:l=this.scale,rotation:n=this.rotation,offsetX:g=this.offsetX,offsetY:u=this.offsetY,dontFlip:p=!1}={}){return new C({viewBox:this.viewBox.slice(),scale:l,rotation:n,offsetX:g,offsetY:u,dontFlip:p})}convertToViewportPoint(l,n){return at.Util.applyTransform([l,n],this.transform)}convertToViewportRectangle(l){const n=at.Util.applyTransform([l[0],l[1]],this.transform),g=at.Util.applyTransform([l[2],l[3]],this.transform);return[n[0],n[1],g[0],g[1]]}convertToPdfPoint(l,n){return at.Util.applyInverseTransform([l,n],this.transform)}}class F extends at.BaseException{constructor(l,n=0){super(l,"RenderingCancelledException"),this.extraDelay=n}}function D(a){const l=a.length;let n=0;for(;n<l&&a[n].trim()==="";)n++;return a.substring(n,n+5).toLowerCase()==="data:"}function z(a){return typeof a=="string"&&/\.pdf$/i.test(a)}function pt(a,l=!1){return l||([a]=a.split(/[#?]/,1)),a.substring(a.lastIndexOf("/")+1)}function tt(a,l="document.pdf"){if(typeof a!="string")return l;if(D(a))return(0,at.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),l;const n=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,g=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,u=n.exec(a);let p=g.exec(u[1])||g.exec(u[2])||g.exec(u[3]);if(p&&(p=p[0],p.includes("%")))try{p=g.exec(decodeURIComponent(p))[0]}catch{}return p||l}class L{constructor(){Ae(this,"started",Object.create(null));Ae(this,"times",[])}time(l){l in this.started&&(0,at.warn)(`Timer is already running for ${l}`),this.started[l]=Date.now()}timeEnd(l){l in this.started||(0,at.warn)(`Timer has not been started for ${l}`),this.times.push({name:l,start:this.started[l],end:Date.now()}),delete this.started[l]}toString(){const l=[];let n=0;for(const{name:g}of this.times)n=Math.max(g.length,n);for(const{name:g,start:u,end:p}of this.times)l.push(`${g.padEnd(n)} ${p-u}ms
`);return l.join("")}}function N(a,l){try{const{protocol:n}=l?new URL(a,l):new URL(a);return n==="http:"||n==="https:"}catch{return!1}}function T(a){a.preventDefault()}let M;class ${static toDateObject(l){if(!l||typeof l!="string")return null;M||(M=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const n=M.exec(l);if(!n)return null;const g=parseInt(n[1],10);let u=parseInt(n[2],10);u=u>=1&&u<=12?u-1:0;let p=parseInt(n[3],10);p=p>=1&&p<=31?p:1;let b=parseInt(n[4],10);b=b>=0&&b<=23?b:0;let d=parseInt(n[5],10);d=d>=0&&d<=59?d:0;let o=parseInt(n[6],10);o=o>=0&&o<=59?o:0;const h=n[7]||"Z";let x=parseInt(n[8],10);x=x>=0&&x<=23?x:0;let S=parseInt(n[9],10)||0;return S=S>=0&&S<=59?S:0,h==="-"?(b+=x,d+=S):h==="+"&&(b-=x,d-=S),new Date(Date.UTC(g,u,p,b,d,o))}}function et(a,{scale:l=1,rotation:n=0}){const{width:g,height:u}=a.attributes.style,p=[0,0,parseInt(g),parseInt(u)];return new C({viewBox:p,scale:l,rotation:n})}function wt(a){if(a.startsWith("#")){const l=parseInt(a.slice(1),16);return[(l&16711680)>>16,(l&65280)>>8,l&255]}return a.startsWith("rgb(")?a.slice(4,-1).split(",").map(l=>parseInt(l)):a.startsWith("rgba(")?a.slice(5,-1).split(",").map(l=>parseInt(l)).slice(0,3):((0,at.warn)(`Not a valid color format: "${a}"`),[0,0,0])}function Pt(a){const l=document.createElement("span");l.style.visibility="hidden",document.body.append(l);for(const n of a.keys()){l.style.color=n;const g=window.getComputedStyle(l).color;a.set(n,wt(g))}l.remove()}function Ct(a){const{a:l,b:n,c:g,d:u,e:p,f:b}=a.getTransform();return[l,n,g,u,p,b]}function Nt(a){const{a:l,b:n,c:g,d:u,e:p,f:b}=a.getTransform().invertSelf();return[l,n,g,u,p,b]}function Mt(a,l,n=!1,g=!0){if(l instanceof C){const{pageWidth:u,pageHeight:p}=l.rawDims,{style:b}=a,d=at.FeatureTest.isCSSRoundSupported,o=`var(--scale-factor) * ${u}px`,h=`var(--scale-factor) * ${p}px`,x=d?`round(${o}, 1px)`:`calc(${o})`,S=d?`round(${h}, 1px)`:`calc(${h})`;!n||l.rotation%180===0?(b.width=x,b.height=S):(b.width=S,b.height=x)}g&&a.setAttribute("data-main-rotation",l.rotation)}},47:(le,Wt,ut)=>{var nt,bt,V,O,k,fn,I,mn,F,ta;ut.d(Wt,{DrawLayer:()=>U});var c=ut(419),at=ut(292);const z=class z{constructor({pageIndex:tt}){r(this,I);r(this,F);r(this,nt,null);r(this,bt,0);r(this,V,new Map);r(this,O,new Map);this.pageIndex=tt}setParent(tt){if(!t(this,nt)){w(this,nt,tt);return}if(t(this,nt)!==tt){if(t(this,V).size>0)for(const L of t(this,V).values())L.remove(),tt.append(L);w(this,nt,tt)}}static get _svgFactory(){return(0,at.shadow)(this,"_svgFactory",new c.DOMSVGFactory)}highlight(tt,L,N,T=!1){const M=ps(this,bt)._++,$=v(this,I,mn).call(this,tt.box);$.classList.add("highlight"),tt.free&&$.classList.add("free");const et=z._svgFactory.createElement("defs");$.append(et);const wt=z._svgFactory.createElement("path");et.append(wt);const Pt=`path_p${this.pageIndex}_${M}`;wt.setAttribute("id",Pt),wt.setAttribute("d",tt.toSVGPath()),T&&t(this,O).set(M,wt);const Ct=v(this,F,ta).call(this,et,Pt),Nt=z._svgFactory.createElement("use");return $.append(Nt),$.setAttribute("fill",L),$.setAttribute("fill-opacity",N),Nt.setAttribute("href",`#${Pt}`),t(this,V).set(M,$),{id:M,clipPathId:`url(#${Ct})`}}highlightOutline(tt){const L=ps(this,bt)._++,N=v(this,I,mn).call(this,tt.box);N.classList.add("highlightOutline");const T=z._svgFactory.createElement("defs");N.append(T);const M=z._svgFactory.createElement("path");T.append(M);const $=`path_p${this.pageIndex}_${L}`;M.setAttribute("id",$),M.setAttribute("d",tt.toSVGPath()),M.setAttribute("vector-effect","non-scaling-stroke");let et;if(tt.free){N.classList.add("free");const Ct=z._svgFactory.createElement("mask");T.append(Ct),et=`mask_p${this.pageIndex}_${L}`,Ct.setAttribute("id",et),Ct.setAttribute("maskUnits","objectBoundingBox");const Nt=z._svgFactory.createElement("rect");Ct.append(Nt),Nt.setAttribute("width","1"),Nt.setAttribute("height","1"),Nt.setAttribute("fill","white");const Mt=z._svgFactory.createElement("use");Ct.append(Mt),Mt.setAttribute("href",`#${$}`),Mt.setAttribute("stroke","none"),Mt.setAttribute("fill","black"),Mt.setAttribute("fill-rule","nonzero"),Mt.classList.add("mask")}const wt=z._svgFactory.createElement("use");N.append(wt),wt.setAttribute("href",`#${$}`),et&&wt.setAttribute("mask",`url(#${et})`);const Pt=wt.cloneNode();return N.append(Pt),wt.classList.add("mainOutline"),Pt.classList.add("secondaryOutline"),t(this,V).set(L,N),L}finalizeLine(tt,L){const N=t(this,O).get(tt);t(this,O).delete(tt),this.updateBox(tt,L.box),N.setAttribute("d",L.toSVGPath())}updateLine(tt,L){t(this,V).get(tt).firstChild.firstChild.setAttribute("d",L.toSVGPath())}removeFreeHighlight(tt){this.remove(tt),t(this,O).delete(tt)}updatePath(tt,L){t(this,O).get(tt).setAttribute("d",L.toSVGPath())}updateBox(tt,L){var N;v(N=z,k,fn).call(N,t(this,V).get(tt),L)}show(tt,L){t(this,V).get(tt).classList.toggle("hidden",!L)}rotate(tt,L){t(this,V).get(tt).setAttribute("data-main-rotation",L)}changeColor(tt,L){t(this,V).get(tt).setAttribute("fill",L)}changeOpacity(tt,L){t(this,V).get(tt).setAttribute("fill-opacity",L)}addClass(tt,L){t(this,V).get(tt).classList.add(L)}removeClass(tt,L){t(this,V).get(tt).classList.remove(L)}remove(tt){t(this,nt)!==null&&(t(this,V).get(tt).remove(),t(this,V).delete(tt))}destroy(){w(this,nt,null);for(const tt of t(this,V).values())tt.remove();t(this,V).clear()}};nt=new WeakMap,bt=new WeakMap,V=new WeakMap,O=new WeakMap,k=new WeakSet,fn=function(tt,{x:L=0,y:N=0,width:T=1,height:M=1}={}){const{style:$}=tt;$.top=`${100*N}%`,$.left=`${100*L}%`,$.width=`${100*T}%`,$.height=`${100*M}%`},I=new WeakSet,mn=function(tt){var N;const L=z._svgFactory.create(1,1,!0);return t(this,nt).append(L),L.setAttribute("aria-hidden",!0),v(N=z,k,fn).call(N,L,tt),L},F=new WeakSet,ta=function(tt,L){const N=z._svgFactory.createElement("clipPath");tt.append(N);const T=`clip_${L}`;N.setAttribute("id",T),N.setAttribute("clipPathUnits","objectBoundingBox");const M=z._svgFactory.createElement("use");return N.append(M),M.setAttribute("href",`#${L}`),M.classList.add("clip"),T},r(z,k);let U=z},731:(le,Wt,ut)=>{var z,pt,tt,L,N,T,M,$,et,wt,Pt,ea,Nt,sa,qt,ia,Kt,Ui,St,Hi,zt,zi,ae,na,ye,An,ce,ra,re,Re,Yt,Be,te,q,s,i,a,l,n,g,u,p,b,d,o,h,x,S,bn,Y,vn,mt,aa,At,oa,R,ha,W,yn,J,pi,P,Xs,ht,la,Tt,Vi,Zt,gi,me,ca,de,da,we,ua,Le,pa,f,B,Z,st,dt,ft,Ht,It,yt,Lt,Ft,Dt,ee,Xt,pe,ge,ga,Ie,fa,qe,ma,_,Aa,Rt,wn,Ut,ba,se,En,xe,va,Ve,ya,Ps,wa,Es,Ea,Ei,_a,hs,Ls,Ys,_n,Is,ji,Ds,qi,gs,Ks,Js,xn,Fs,Gi,_i,xa,Qs,Sn,xi,Sa,Si,Ca,Zs,Cn,Ns,Wi,_s,fi,$e,Xe,fs,ls,ms,Os,ns,xs,rs,ts,ti,Ss,mi,Cs,Ai,Bs,$i,ei,Tn,Ci,Ta,Ti,Ma,si,Mn,Us,Xi,Mi,Ra,Ts,Hs,as,Ms,cs,ds,us,Qe,As,zs,Vs,Ye,ue,bs,Ri,La,ni,Rn,ri,Ln,ai,kn,js,Ki;ut.d(Wt,{AnnotationEditorLayer:()=>D});var c=ut(292),at=ut(310),U=ut(830),nt=ut(976);const bt=/\r\n?|\n/g,ne=class ne extends at.AnnotationEditor{constructor(e){super({...e,name:"freeTextEditor"});r(this,Pt);r(this,Nt);r(this,qt);r(this,Kt);r(this,zt);r(this,ae);r(this,ce);r(this,z,this.editorDivBlur.bind(this));r(this,pt,this.editorDivFocus.bind(this));r(this,tt,this.editorDivInput.bind(this));r(this,L,this.editorDivKeydown.bind(this));r(this,N,this.editorDivPaste.bind(this));r(this,T,void 0);r(this,M,"");r(this,$,`${this.id}-editor`);r(this,et,void 0);r(this,wt,null);w(this,T,e.color||ne._defaultColor||at.AnnotationEditor._defaultLineColor),w(this,et,e.fontSize||ne._defaultFontSize)}static get _keyboardManager(){const e=ne.prototype,A=ct=>ct.isEmpty(),G=U.AnnotationEditorUIManager.TRANSLATE_SMALL,X=U.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new U.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-G,0],checker:A}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-X,0],checker:A}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[G,0],checker:A}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[X,0],checker:A}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-G],checker:A}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-X],checker:A}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,G],checker:A}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,X],checker:A}]]))}static initialize(e,A){at.AnnotationEditor.initialize(e,A,{strings:["pdfjs-free-text-default-content"]});const G=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(G.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,A){switch(e){case c.AnnotationEditorParamsType.FREETEXT_SIZE:ne._defaultFontSize=A;break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:ne._defaultColor=A;break}}updateParams(e,A){switch(e){case c.AnnotationEditorParamsType.FREETEXT_SIZE:v(this,Pt,ea).call(this,A);break;case c.AnnotationEditorParamsType.FREETEXT_COLOR:v(this,Nt,sa).call(this,A);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,ne._defaultFontSize],[c.AnnotationEditorParamsType.FREETEXT_COLOR,ne._defaultColor||at.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.FREETEXT_SIZE,t(this,et)],[c.AnnotationEditorParamsType.FREETEXT_COLOR,t(this,T)]]}_translateEmpty(e,A){this._uiManager.translateSelectedEditors(e,A,!0)}getInitialTranslation(){const e=this.parentScale;return[-ne._internalPadding*e,-(ne._internalPadding+t(this,et))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(c.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",t(this,L)),this.editorDiv.addEventListener("focus",t(this,pt)),this.editorDiv.addEventListener("blur",t(this,z)),this.editorDiv.addEventListener("input",t(this,tt)),this.editorDiv.addEventListener("paste",t(this,N)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",t(this,$)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",t(this,L)),this.editorDiv.removeEventListener("focus",t(this,pt)),this.editorDiv.removeEventListener("blur",t(this,z)),this.editorDiv.removeEventListener("input",t(this,tt)),this.editorDiv.removeEventListener("paste",t(this,N)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var e;this.width||(this.enableEditMode(),this.editorDiv.focus(),(e=this._initialOptions)!=null&&e.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=t(this,M),A=w(this,M,v(this,qt,ia).call(this).trimEnd());if(e===A)return;const G=X=>{if(w(this,M,X),!X){this.remove();return}v(this,zt,zi).call(this),this._uiManager.rebuild(this),v(this,Kt,Ui).call(this)};this.addCommands({cmd:()=>{G(A)},undo:()=>{G(e)},mustExec:!1}),v(this,Kt,Ui).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){ne._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,A;this.width&&(e=this.x,A=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",t(this,$)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text"),this.enableEditing(),at.AnnotationEditor._l10nPromise.get("pdfjs-free-text-default-content").then(X=>{var ct;return(ct=this.editorDiv)==null?void 0:ct.setAttribute("default-content",X)}),this.editorDiv.contentEditable=!0;const{style:G}=this.editorDiv;if(G.fontSize=`calc(${t(this,et)}px * var(--scale-factor))`,G.color=t(this,T),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,U.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[X,ct]=this.parentDimensions;if(this.annotationElementId){const{position:xt}=t(this,wt);let[kt,_t]=this.getInitialTranslation();[kt,_t]=this.pageTranslationToScreen(kt,_t);const[jt,Vt]=this.pageDimensions,[be,ve]=this.pageTranslation;let Se,Te;switch(this.rotation){case 0:Se=e+(xt[0]-be)/jt,Te=A+this.height-(xt[1]-ve)/Vt;break;case 90:Se=e+(xt[0]-be)/jt,Te=A-(xt[1]-ve)/Vt,[kt,_t]=[_t,-kt];break;case 180:Se=e-this.width+(xt[0]-be)/jt,Te=A-(xt[1]-ve)/Vt,[kt,_t]=[-kt,-_t];break;case 270:Se=e+(xt[0]-be-this.height*Vt)/jt,Te=A+(xt[1]-ve-this.width*jt)/Vt,[kt,_t]=[-_t,kt];break}this.setAt(Se*X,Te*ct,kt,_t)}else this.setAt(e*X,A*ct,this.width*X,this.height*ct);v(this,zt,zi).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var Se,Te,Ge;const A=e.clipboardData||window.clipboardData,{types:G}=A;if(G.length===1&&G[0]==="text/plain")return;e.preventDefault();const X=v(Se=ne,ye,An).call(Se,A.getData("text")||"").replaceAll(bt,`
`);if(!X)return;const ct=window.getSelection();if(!ct.rangeCount)return;this.editorDiv.normalize(),ct.deleteFromDocument();const xt=ct.getRangeAt(0);if(!X.includes(`
`)){xt.insertNode(document.createTextNode(X)),this.editorDiv.normalize(),ct.collapseToStart();return}const{startContainer:kt,startOffset:_t}=xt,jt=[],Vt=[];if(kt.nodeType===Node.TEXT_NODE){const Fe=kt.parentElement;if(Vt.push(kt.nodeValue.slice(_t).replaceAll(bt,"")),Fe!==this.editorDiv){let je=jt;for(const He of this.editorDiv.childNodes){if(He===Fe){je=Vt;continue}je.push(v(Te=ne,St,Hi).call(Te,He))}}jt.push(kt.nodeValue.slice(0,_t).replaceAll(bt,""))}else if(kt===this.editorDiv){let Fe=jt,je=0;for(const He of this.editorDiv.childNodes)je++===_t&&(Fe=Vt),Fe.push(v(Ge=ne,St,Hi).call(Ge,He))}w(this,M,`${jt.join(`
`)}${X}${Vt.join(`
`)}`),v(this,zt,zi).call(this);const be=new Range;let ve=jt.reduce((Fe,je)=>Fe+je.length,0);for(const{firstChild:Fe}of this.editorDiv.childNodes)if(Fe.nodeType===Node.TEXT_NODE){const je=Fe.nodeValue.length;if(ve<=je){be.setStart(Fe,ve),be.setEnd(Fe,ve);break}ve-=je}ct.removeAllRanges(),ct.addRange(be)}get contentDiv(){return this.editorDiv}static deserialize(e,A,G){var xt;let X=null;if(e instanceof nt.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:kt,fontColor:_t},rect:jt,rotation:Vt,id:be},textContent:ve,textPosition:Se,parent:{page:{pageNumber:Te}}}=e;if(!ve||ve.length===0)return null;X=e={annotationType:c.AnnotationEditorType.FREETEXT,color:Array.from(_t),fontSize:kt,value:ve.join(`
`),position:Se,pageIndex:Te-1,rect:jt.slice(0),rotation:Vt,id:be,deleted:!1}}const ct=super.deserialize(e,A,G);return w(ct,et,e.fontSize),w(ct,T,c.Util.makeHexColor(...e.color)),w(ct,M,v(xt=ne,ye,An).call(xt,e.value)),ct.annotationElementId=e.id||null,w(ct,wt,X),ct}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const A=ne._internalPadding*this.parentScale,G=this.getRect(A,A),X=at.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:t(this,T)),ct={annotationType:c.AnnotationEditorType.FREETEXT,color:X,fontSize:t(this,et),value:v(this,ae,na).call(this),pageIndex:this.pageIndex,rect:G,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?ct:this.annotationElementId&&!v(this,ce,ra).call(this,ct)?null:(ct.id=this.annotationElementId,ct)}renderAnnotationElement(e){const A=super.renderAnnotationElement(e);if(this.deleted)return A;const{style:G}=A;G.fontSize=`calc(${t(this,et)}px * var(--scale-factor))`,G.color=t(this,T),A.replaceChildren();for(const ct of t(this,M).split(`
`)){const xt=document.createElement("div");xt.append(ct?document.createTextNode(ct):document.createElement("br")),A.append(xt)}const X=ne._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(X,X)}),A}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};z=new WeakMap,pt=new WeakMap,tt=new WeakMap,L=new WeakMap,N=new WeakMap,T=new WeakMap,M=new WeakMap,$=new WeakMap,et=new WeakMap,wt=new WeakMap,Pt=new WeakSet,ea=function(e){const A=X=>{this.editorDiv.style.fontSize=`calc(${X}px * var(--scale-factor))`,this.translate(0,-(X-t(this,et))*this.parentScale),w(this,et,X),v(this,Kt,Ui).call(this)},G=t(this,et);this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Nt=new WeakSet,sa=function(e){const A=X=>{w(this,T,this.editorDiv.style.color=X)},G=t(this,T);this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},qt=new WeakSet,ia=function(){var A;const e=[];this.editorDiv.normalize();for(const G of this.editorDiv.childNodes)e.push(v(A=ne,St,Hi).call(A,G));return e.join(`
`)},Kt=new WeakSet,Ui=function(){const[e,A]=this.parentDimensions;let G;if(this.isAttachedToDOM)G=this.div.getBoundingClientRect();else{const{currentLayer:X,div:ct}=this,xt=ct.style.display,kt=ct.classList.contains("hidden");ct.classList.remove("hidden"),ct.style.display="hidden",X.div.append(this.div),G=ct.getBoundingClientRect(),ct.remove(),ct.style.display=xt,ct.classList.toggle("hidden",kt)}this.rotation%180===this.parentRotation%180?(this.width=G.width/e,this.height=G.height/A):(this.width=G.height/e,this.height=G.width/A),this.fixAndSetPosition()},St=new WeakSet,Hi=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(bt,"")},zt=new WeakSet,zi=function(){if(this.editorDiv.replaceChildren(),!!t(this,M))for(const e of t(this,M).split(`
`)){const A=document.createElement("div");A.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(A)}},ae=new WeakSet,na=function(){return t(this,M).replaceAll("\xA0"," ")},ye=new WeakSet,An=function(e){return e.replaceAll(" ","\xA0")},ce=new WeakSet,ra=function(e){const{value:A,fontSize:G,color:X,pageIndex:ct}=t(this,wt);return this._hasBeenMoved||e.value!==A||e.fontSize!==G||e.color.some((xt,kt)=>xt!==X[kt])||e.pageIndex!==ct},r(ne,St),r(ne,ye),Ae(ne,"_freeTextDefaultContent",""),Ae(ne,"_internalPadding",0),Ae(ne,"_defaultColor",null),Ae(ne,"_defaultFontSize",10),Ae(ne,"_type","freetext"),Ae(ne,"_editorType",c.AnnotationEditorType.FREETEXT);let V=ne;var O=ut(61),k=ut(259),j=ut(419);const m=class m extends at.AnnotationEditor{constructor(e){super({...e,name:"highlightEditor"});r(this,S);r(this,Y);r(this,mt);r(this,At);r(this,R);r(this,W);r(this,J);r(this,ht);r(this,Tt);r(this,Zt);r(this,me);r(this,de);r(this,re,null);r(this,Re,0);r(this,Yt,void 0);r(this,Be,null);r(this,te,null);r(this,q,null);r(this,s,null);r(this,i,0);r(this,a,null);r(this,l,null);r(this,n,null);r(this,g,!1);r(this,u,v(this,ht,la).bind(this));r(this,p,null);r(this,b,void 0);r(this,d,null);r(this,o,"");r(this,h,void 0);r(this,x,"");this.color=e.color||m._defaultColor,w(this,h,e.thickness||m._defaultThickness),w(this,b,e.opacity||m._defaultOpacity),w(this,Yt,e.boxes||null),w(this,x,e.methodOfCreation||""),w(this,o,e.text||""),this._isDraggable=!1,e.highlightId>-1?(w(this,g,!0),v(this,Y,vn).call(this,e),v(this,J,pi).call(this)):(w(this,re,e.anchorNode),w(this,Re,e.anchorOffset),w(this,s,e.focusNode),w(this,i,e.focusOffset),v(this,S,bn).call(this),v(this,J,pi).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=m.prototype;return(0,c.shadow)(this,"_keyboardManager",new U.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:t(this,g)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:t(this,h),methodOfCreation:t(this,x)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,A){var G;at.AnnotationEditor.initialize(e,A),m._defaultColor||(m._defaultColor=((G=A.highlightColors)==null?void 0:G.values().next().value)||"#fff066")}static updateDefaultParams(e,A){switch(e){case c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:m._defaultColor=A;break;case c.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:m._defaultThickness=A;break}}translateInPage(e,A){}get toolbarPosition(){return t(this,p)}updateParams(e,A){switch(e){case c.AnnotationEditorParamsType.HIGHLIGHT_COLOR:v(this,mt,aa).call(this,A);break;case c.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:v(this,At,oa).call(this,A);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR,m._defaultColor],[c.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,m._defaultThickness]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||m._defaultColor],[c.AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,t(this,h)||m._defaultThickness],[c.AnnotationEditorParamsType.HIGHLIGHT_FREE,t(this,g)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(w(this,te,new k.ColorPicker({editor:this})),e.addColorPicker(t(this,te))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(v(this,Zt,gi).call(this))}getBaseTranslation(){return[0,0]}getRect(e,A){return super.getRect(e,A,v(this,Zt,gi).call(this))}onceAdded(){this.parent.addUndoableEditor(this),this.div.focus()}remove(){v(this,W,yn).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(v(this,J,pi).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var G;let A=!1;this.parent&&!e?v(this,W,yn).call(this):e&&(v(this,J,pi).call(this,e),A=!this.parent&&((G=this.div)==null?void 0:G.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),A&&this.select()}rotate(e){var X,ct,xt;const{drawLayer:A}=this.parent;let G;t(this,g)?(e=(e-this.rotation+360)%360,G=v(X=m,P,Xs).call(X,t(this,l).box,e)):G=v(ct=m,P,Xs).call(ct,this,e),A.rotate(t(this,n),e),A.rotate(t(this,d),e),A.updateBox(t(this,n),G),A.updateBox(t(this,d),v(xt=m,P,Xs).call(xt,t(this,q).box,e))}render(){if(this.div)return this.div;const e=super.render();t(this,o)&&(e.setAttribute("aria-label",t(this,o)),e.setAttribute("role","mark")),t(this,g)?e.classList.add("free"):this.div.addEventListener("keydown",t(this,u));const A=w(this,a,document.createElement("div"));e.append(A),A.setAttribute("aria-hidden","true"),A.className="internal",A.style.clipPath=t(this,Be);const[G,X]=this.parentDimensions;return this.setDims(this.width*G,this.height*X),(0,U.bindEvents)(this,t(this,a),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.parent.drawLayer.addClass(t(this,d),"hovered")}pointerleave(){this.parent.drawLayer.removeClass(t(this,d),"hovered")}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:v(this,Tt,Vi).call(this,!0);break;case 1:case 3:v(this,Tt,Vi).call(this,!1);break}}select(){var e,A;super.select(),t(this,d)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,d),"hovered"),(A=this.parent)==null||A.drawLayer.addClass(t(this,d),"selected"))}unselect(){var e;super.unselect(),t(this,d)&&((e=this.parent)==null||e.drawLayer.removeClass(t(this,d),"selected"),t(this,g)||v(this,Tt,Vi).call(this,!1))}get _mustFixPosition(){return!t(this,g)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.show(t(this,n),e),this.parent.drawLayer.show(t(this,d),e))}static startHighlighting(e,A,{target:G,x:X,y:ct}){const{x:xt,y:kt,width:_t,height:jt}=G.getBoundingClientRect(),Vt=Te=>{v(this,we,ua).call(this,e,Te)},be={capture:!0,passive:!1},ve=Te=>{Te.preventDefault(),Te.stopPropagation()},Se=Te=>{G.removeEventListener("pointermove",Vt),window.removeEventListener("blur",Se),window.removeEventListener("pointerup",Se),window.removeEventListener("pointerdown",ve,be),window.removeEventListener("contextmenu",j.noContextMenu),v(this,Le,pa).call(this,e,Te)};window.addEventListener("blur",Se),window.addEventListener("pointerup",Se),window.addEventListener("pointerdown",ve,be),window.addEventListener("contextmenu",j.noContextMenu),G.addEventListener("pointermove",Vt),this._freeHighlight=new O.FreeOutliner({x:X,y:ct},[xt,kt,_t,jt],e.scale,this._defaultThickness/2,A,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.highlight(this._freeHighlight,this._defaultColor,this._defaultOpacity,!0)}static deserialize(e,A,G){var Te;const X=super.deserialize(e,A,G),{rect:[ct,xt,kt,_t],color:jt,quadPoints:Vt}=e;X.color=c.Util.makeHexColor(...jt),w(X,b,e.opacity);const[be,ve]=X.pageDimensions;X.width=(kt-ct)/be,X.height=(_t-xt)/ve;const Se=w(X,Yt,[]);for(let Ge=0;Ge<Vt.length;Ge+=8)Se.push({x:(Vt[4]-kt)/be,y:(_t-(1-Vt[Ge+5]))/ve,width:(Vt[Ge+2]-Vt[Ge])/be,height:(Vt[Ge+5]-Vt[Ge+1])/ve});return v(Te=X,S,bn).call(Te),X}serialize(e=!1){if(this.isEmpty()||e)return null;const A=this.getRect(0,0),G=at.AnnotationEditor._colorManager.convert(this.color);return{annotationType:c.AnnotationEditorType.HIGHLIGHT,color:G,opacity:t(this,b),thickness:t(this,h),quadPoints:v(this,me,ca).call(this),outlines:v(this,de,da).call(this,A),pageIndex:this.pageIndex,rect:A,rotation:v(this,Zt,gi).call(this),structTreeParentId:this._structTreeParentId}}static canCreateNewEmptyEditor(){return!1}};re=new WeakMap,Re=new WeakMap,Yt=new WeakMap,Be=new WeakMap,te=new WeakMap,q=new WeakMap,s=new WeakMap,i=new WeakMap,a=new WeakMap,l=new WeakMap,n=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakMap,b=new WeakMap,d=new WeakMap,o=new WeakMap,h=new WeakMap,x=new WeakMap,S=new WeakSet,bn=function(){const e=new O.Outliner(t(this,Yt),.001);w(this,l,e.getOutlines()),{x:this.x,y:this.y,width:this.width,height:this.height}=t(this,l).box;const A=new O.Outliner(t(this,Yt),.0025,.001,this._uiManager.direction==="ltr");w(this,q,A.getOutlines());const{lastPoint:G}=t(this,q).box;w(this,p,[(G[0]-this.x)/this.width,(G[1]-this.y)/this.height])},Y=new WeakSet,vn=function({highlightOutlines:e,highlightId:A,clipPathId:G}){var Vt,be;if(w(this,l,e),w(this,q,e.getNewOutline(t(this,h)/2+1.5,.0025)),A>=0)w(this,n,A),w(this,Be,G),this.parent.drawLayer.finalizeLine(A,e),w(this,d,this.parent.drawLayer.highlightOutline(t(this,q)));else if(this.parent){const ve=this.parent.viewport.rotation;this.parent.drawLayer.updateLine(t(this,n),e),this.parent.drawLayer.updateBox(t(this,n),v(Vt=m,P,Xs).call(Vt,t(this,l).box,(ve-this.rotation+360)%360)),this.parent.drawLayer.updateLine(t(this,d),t(this,q)),this.parent.drawLayer.updateBox(t(this,d),v(be=m,P,Xs).call(be,t(this,q).box,ve))}const{x:ct,y:xt,width:kt,height:_t}=e.box;switch(this.rotation){case 0:this.x=ct,this.y=xt,this.width=kt,this.height=_t;break;case 90:{const[ve,Se]=this.parentDimensions;this.x=xt,this.y=1-ct,this.width=kt*Se/ve,this.height=_t*ve/Se;break}case 180:this.x=1-ct,this.y=1-xt,this.width=kt,this.height=_t;break;case 270:{const[ve,Se]=this.parentDimensions;this.x=1-xt,this.y=ct,this.width=kt*Se/ve,this.height=_t*ve/Se;break}}const{lastPoint:jt}=t(this,q).box;w(this,p,[(jt[0]-ct)/kt,(jt[1]-xt)/_t])},mt=new WeakSet,aa=function(e){const A=X=>{var ct,xt;this.color=X,(ct=this.parent)==null||ct.drawLayer.changeColor(t(this,n),X),(xt=t(this,te))==null||xt.updateColor(X)},G=this.color;this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},At=new WeakSet,oa=function(e){const A=t(this,h),G=X=>{w(this,h,X),v(this,R,ha).call(this,X)};this.addCommands({cmd:G.bind(this,e),undo:G.bind(this,A),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},R=new WeakSet,ha=function(e){if(!t(this,g))return;v(this,Y,vn).call(this,{highlightOutlines:t(this,l).getNewOutline(e/2)}),this.fixAndSetPosition();const[A,G]=this.parentDimensions;this.setDims(this.width*A,this.height*G)},W=new WeakSet,yn=function(){t(this,n)===null||!this.parent||(this.parent.drawLayer.remove(t(this,n)),w(this,n,null),this.parent.drawLayer.remove(t(this,d)),w(this,d,null))},J=new WeakSet,pi=function(e=this.parent){t(this,n)===null&&({id:ps(this,n)._,clipPathId:ps(this,Be)._}=e.drawLayer.highlight(t(this,l),this.color,t(this,b)),w(this,d,e.drawLayer.highlightOutline(t(this,q))),t(this,a)&&(t(this,a).style.clipPath=t(this,Be)))},P=new WeakSet,Xs=function({x:e,y:A,width:G,height:X},ct){switch(ct){case 90:return{x:1-A-X,y:e,width:X,height:G};case 180:return{x:1-e-G,y:1-A-X,width:G,height:X};case 270:return{x:A,y:1-e-G,width:X,height:G}}return{x:e,y:A,width:G,height:X}},ht=new WeakSet,la=function(e){m._keyboardManager.exec(this,e)},Tt=new WeakSet,Vi=function(e){if(!t(this,re))return;const A=window.getSelection();e?A.setPosition(t(this,re),t(this,Re)):A.setPosition(t(this,s),t(this,i))},Zt=new WeakSet,gi=function(){return t(this,g)?this.rotation:0},me=new WeakSet,ca=function(){if(t(this,g))return null;const[e,A]=this.pageDimensions,G=t(this,Yt),X=new Array(G.length*8);let ct=0;for(const{x:xt,y:kt,width:_t,height:jt}of G){const Vt=xt*e,be=(1-kt-jt)*A;X[ct]=X[ct+4]=Vt,X[ct+1]=X[ct+3]=be,X[ct+2]=X[ct+6]=Vt+_t*e,X[ct+5]=X[ct+7]=be+jt*A,ct+=8}return X},de=new WeakSet,da=function(e){return t(this,l).serialize(e,v(this,Zt,gi).call(this))},we=new WeakSet,ua=function(e,A){this._freeHighlight.add(A)&&e.drawLayer.updatePath(this._freeHighlightId,this._freeHighlight)},Le=new WeakSet,pa=function(e,A){this._freeHighlight.isEmpty()?e.drawLayer.removeFreeHighlight(this._freeHighlightId):e.createAndAddNewEditor(A,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},r(m,P),r(m,we),r(m,Le),Ae(m,"_defaultColor",null),Ae(m,"_defaultOpacity",1),Ae(m,"_defaultThickness",12),Ae(m,"_l10nPromise"),Ae(m,"_type","highlight"),Ae(m,"_editorType",c.AnnotationEditorType.HIGHLIGHT),Ae(m,"_freeHighlightId",-1),Ae(m,"_freeHighlight",null),Ae(m,"_freeHighlightClipId","");let I=m;const Ue=class Ue extends at.AnnotationEditor{constructor(e){super({...e,name:"inkEditor"});r(this,ge);r(this,Ie);r(this,qe);r(this,_);r(this,Rt);r(this,Ut);r(this,se);r(this,xe);r(this,Ve);r(this,Ps);r(this,Es);r(this,Ei);r(this,hs);r(this,Ys);r(this,Is);r(this,Ds);r(this,gs);r(this,Js);r(this,Fs);r(this,Si);r(this,Zs);r(this,Ns);r(this,_s);r(this,f,0);r(this,B,0);r(this,Z,this.canvasPointermove.bind(this));r(this,st,this.canvasPointerleave.bind(this));r(this,dt,this.canvasPointerup.bind(this));r(this,ft,this.canvasPointerdown.bind(this));r(this,Ht,null);r(this,It,new Path2D);r(this,yt,!1);r(this,Lt,!1);r(this,Ft,!1);r(this,Dt,null);r(this,ee,0);r(this,Xt,0);r(this,pe,null);this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e,A){at.AnnotationEditor.initialize(e,A)}static updateDefaultParams(e,A){switch(e){case c.AnnotationEditorParamsType.INK_THICKNESS:Ue._defaultThickness=A;break;case c.AnnotationEditorParamsType.INK_COLOR:Ue._defaultColor=A;break;case c.AnnotationEditorParamsType.INK_OPACITY:Ue._defaultOpacity=A/100;break}}updateParams(e,A){switch(e){case c.AnnotationEditorParamsType.INK_THICKNESS:v(this,ge,ga).call(this,A);break;case c.AnnotationEditorParamsType.INK_COLOR:v(this,Ie,fa).call(this,A);break;case c.AnnotationEditorParamsType.INK_OPACITY:v(this,qe,ma).call(this,A);break}}static get defaultPropertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,Ue._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,Ue._defaultColor||at.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(Ue._defaultOpacity*100)]]}get propertiesToUpdate(){return[[c.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||Ue._defaultThickness],[c.AnnotationEditorParamsType.INK_COLOR,this.color||Ue._defaultColor||at.AnnotationEditor._defaultLineColor],[c.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??Ue._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(v(this,Is,ji).call(this),v(this,Ds,qi).call(this)),this.isAttachedToDOM||(this.parent.add(this),v(this,gs,Ks).call(this)),v(this,_s,fi).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,t(this,Ht)&&(clearTimeout(t(this,Ht)),w(this,Ht,null)),t(this,Dt).disconnect(),w(this,Dt,null),super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&e===null&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,A]=this.parentDimensions,G=this.width*e,X=this.height*A;this.setDimensions(G,X)}enableEditMode(){t(this,yt)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",t(this,ft)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",t(this,ft)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){t(this,yt)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),w(this,yt,!0),this.div.classList.add("disabled"),v(this,_s,fi).call(this,!0),this.select(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){e.button!==0||!this.isInEditMode()||t(this,yt)||(this.setInForeground(),e.preventDefault(),this.div.contains(document.activeElement)||this.div.focus({preventScroll:!0}),v(this,Ut,ba).call(this,e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),v(this,se,En).call(this,e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),v(this,Ys,_n).call(this,e)}canvasPointerleave(e){v(this,Ys,_n).call(this,e)}get isResizable(){return!this.isEmpty()&&t(this,yt)}render(){if(this.div)return this.div;let e,A;this.width&&(e=this.x,A=this.y),super.render(),this.div.setAttribute("data-l10n-id","pdfjs-ink");const[G,X,ct,xt]=v(this,_,Aa).call(this);if(this.setAt(G,X,0,0),this.setDims(ct,xt),v(this,Is,ji).call(this),this.width){const[kt,_t]=this.parentDimensions;this.setAspectRatio(this.width*kt,this.height*_t),this.setAt(e*kt,A*_t,this.width*kt,this.height*_t),w(this,Ft,!0),v(this,gs,Ks).call(this),this.setDims(this.width*kt,this.height*_t),v(this,hs,Ls).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return v(this,Ds,qi).call(this),this.div}setDimensions(e,A){const G=Math.round(e),X=Math.round(A);if(t(this,ee)===G&&t(this,Xt)===X)return;w(this,ee,G),w(this,Xt,X),this.canvas.style.visibility="hidden";const[ct,xt]=this.parentDimensions;this.width=e/ct,this.height=A/xt,this.fixAndSetPosition(),t(this,yt)&&v(this,Js,xn).call(this,e,A),v(this,gs,Ks).call(this),v(this,hs,Ls).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(e,A,G){var Ge,Fe,je;if(e instanceof nt.InkAnnotationElement)return null;const X=super.deserialize(e,A,G);X.thickness=e.thickness,X.color=c.Util.makeHexColor(...e.color),X.opacity=e.opacity;const[ct,xt]=X.pageDimensions,kt=X.width*ct,_t=X.height*xt,jt=X.parentScale,Vt=e.thickness/2;w(X,yt,!0),w(X,ee,Math.round(kt)),w(X,Xt,Math.round(_t));const{paths:be,rect:ve,rotation:Se}=e;for(let{bezier:He}of be){He=v(Ge=Ue,xi,Sa).call(Ge,He,ve,Se);const os=[];X.paths.push(os);let oi=jt*(He[0]-Vt),hi=jt*(He[1]-Vt);for(let ss=2,sn=He.length;ss<sn;ss+=6){const nn=jt*(He[ss]-Vt),ki=jt*(He[ss+1]-Vt),Pi=jt*(He[ss+2]-Vt),Ii=jt*(He[ss+3]-Vt),li=jt*(He[ss+4]-Vt),sr=jt*(He[ss+5]-Vt);os.push([[oi,hi],[nn,ki],[Pi,Ii],[li,sr]]),oi=li,hi=sr}const Li=v(this,_i,xa).call(this,os);X.bezierPath2D.push(Li)}const Te=v(Fe=X,Zs,Cn).call(Fe);return w(X,B,Math.max(at.AnnotationEditor.MIN_SIZE,Te[2]-Te[0])),w(X,f,Math.max(at.AnnotationEditor.MIN_SIZE,Te[3]-Te[1])),v(je=X,Js,xn).call(je,kt,_t),X}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),A=at.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:c.AnnotationEditorType.INK,color:A,thickness:this.thickness,opacity:this.opacity,paths:v(this,Si,Ca).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};f=new WeakMap,B=new WeakMap,Z=new WeakMap,st=new WeakMap,dt=new WeakMap,ft=new WeakMap,Ht=new WeakMap,It=new WeakMap,yt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,Dt=new WeakMap,ee=new WeakMap,Xt=new WeakMap,pe=new WeakMap,ge=new WeakSet,ga=function(e){const A=X=>{this.thickness=X,v(this,_s,fi).call(this)},G=this.thickness;this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ie=new WeakSet,fa=function(e){const A=X=>{this.color=X,v(this,hs,Ls).call(this)},G=this.color;this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},qe=new WeakSet,ma=function(e){const A=X=>{this.opacity=X,v(this,hs,Ls).call(this)};e/=100;const G=this.opacity;this.addCommands({cmd:A.bind(this,e),undo:A.bind(this,G),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:c.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},_=new WeakSet,Aa=function(){const{parentRotation:e,parentDimensions:[A,G]}=this;switch(e){case 90:return[0,G,G,A];case 180:return[A,G,A,G];case 270:return[A,0,G,A];default:return[0,0,A,G]}},Rt=new WeakSet,wn=function(){const{ctx:e,color:A,opacity:G,thickness:X,parentScale:ct,scaleFactor:xt}=this;e.lineWidth=X*ct/xt,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${A}${(0,U.opacityToHex)(G)}`},Ut=new WeakSet,ba=function(e,A){this.canvas.addEventListener("contextmenu",j.noContextMenu),this.canvas.addEventListener("pointerleave",t(this,st)),this.canvas.addEventListener("pointermove",t(this,Z)),this.canvas.addEventListener("pointerup",t(this,dt)),this.canvas.removeEventListener("pointerdown",t(this,ft)),this.isEditing=!0,t(this,Ft)||(w(this,Ft,!0),v(this,gs,Ks).call(this),this.thickness||(this.thickness=Ue._defaultThickness),this.color||(this.color=Ue._defaultColor||at.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=Ue._defaultOpacity)),this.currentPath.push([e,A]),w(this,Lt,!1),v(this,Rt,wn).call(this),w(this,pe,()=>{v(this,Ps,wa).call(this),t(this,pe)&&window.requestAnimationFrame(t(this,pe))}),window.requestAnimationFrame(t(this,pe))},se=new WeakSet,En=function(e,A){const[G,X]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===G&&A===X)return;const ct=this.currentPath;let xt=t(this,It);if(ct.push([e,A]),w(this,Lt,!0),ct.length<=2){xt.moveTo(...ct[0]),xt.lineTo(e,A);return}ct.length===3&&(w(this,It,xt=new Path2D),xt.moveTo(...ct[0])),v(this,Es,Ea).call(this,xt,...ct.at(-3),...ct.at(-2),e,A)},xe=new WeakSet,va=function(){if(this.currentPath.length===0)return;const e=this.currentPath.at(-1);t(this,It).lineTo(...e)},Ve=new WeakSet,ya=function(e,A){w(this,pe,null),e=Math.min(Math.max(e,0),this.canvas.width),A=Math.min(Math.max(A,0),this.canvas.height),v(this,se,En).call(this,e,A),v(this,xe,va).call(this);let G;if(this.currentPath.length!==1)G=v(this,Ei,_a).call(this);else{const _t=[e,A];G=[[_t,_t.slice(),_t.slice(),_t]]}const X=t(this,It),ct=this.currentPath;this.currentPath=[],w(this,It,new Path2D);const xt=()=>{this.allRawPaths.push(ct),this.paths.push(G),this.bezierPath2D.push(X),this._uiManager.rebuild(this)},kt=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(v(this,Is,ji).call(this),v(this,Ds,qi).call(this)),v(this,_s,fi).call(this))};this.addCommands({cmd:xt,undo:kt,mustExec:!0})},Ps=new WeakSet,wa=function(){if(!t(this,Lt))return;w(this,Lt,!1);const e=Math.ceil(this.thickness*this.parentScale),A=this.currentPath.slice(-3),G=A.map(xt=>xt[0]),X=A.map(xt=>xt[1]);Math.min(...G)-e,Math.max(...G)+e,Math.min(...X)-e,Math.max(...X)+e;const{ctx:ct}=this;ct.save(),ct.clearRect(0,0,this.canvas.width,this.canvas.height);for(const xt of this.bezierPath2D)ct.stroke(xt);ct.stroke(t(this,It)),ct.restore()},Es=new WeakSet,Ea=function(e,A,G,X,ct,xt,kt){const _t=(A+X)/2,jt=(G+ct)/2,Vt=(X+xt)/2,be=(ct+kt)/2;e.bezierCurveTo(_t+2*(X-_t)/3,jt+2*(ct-jt)/3,Vt+2*(X-Vt)/3,be+2*(ct-be)/3,Vt,be)},Ei=new WeakSet,_a=function(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const A=[];let G,[X,ct]=e[0];for(G=1;G<e.length-2;G++){const[ve,Se]=e[G],[Te,Ge]=e[G+1],Fe=(ve+Te)/2,je=(Se+Ge)/2,He=[X+2*(ve-X)/3,ct+2*(Se-ct)/3],os=[Fe+2*(ve-Fe)/3,je+2*(Se-je)/3];A.push([[X,ct],He,os,[Fe,je]]),[X,ct]=[Fe,je]}const[xt,kt]=e[G],[_t,jt]=e[G+1],Vt=[X+2*(xt-X)/3,ct+2*(kt-ct)/3],be=[_t+2*(xt-_t)/3,jt+2*(kt-jt)/3];return A.push([[X,ct],Vt,be,[_t,jt]]),A},hs=new WeakSet,Ls=function(){if(this.isEmpty()){v(this,Fs,Gi).call(this);return}v(this,Rt,wn).call(this);const{canvas:e,ctx:A}=this;A.setTransform(1,0,0,1,0,0),A.clearRect(0,0,e.width,e.height),v(this,Fs,Gi).call(this);for(const G of this.bezierPath2D)A.stroke(G)},Ys=new WeakSet,_n=function(e){this.canvas.removeEventListener("pointerleave",t(this,st)),this.canvas.removeEventListener("pointermove",t(this,Z)),this.canvas.removeEventListener("pointerup",t(this,dt)),this.canvas.addEventListener("pointerdown",t(this,ft)),t(this,Ht)&&clearTimeout(t(this,Ht)),w(this,Ht,setTimeout(()=>{w(this,Ht,null),this.canvas.removeEventListener("contextmenu",j.noContextMenu)},10)),v(this,Ve,ya).call(this,e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Is=new WeakSet,ji=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",this.canvas.setAttribute("data-l10n-id","pdfjs-ink-canvas"),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ds=new WeakSet,qi=function(){w(this,Dt,new ResizeObserver(e=>{const A=e[0].contentRect;A.width&&A.height&&this.setDimensions(A.width,A.height)})),t(this,Dt).observe(this.div)},gs=new WeakSet,Ks=function(){if(!t(this,Ft))return;const[e,A]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*A),v(this,Fs,Gi).call(this)},Js=new WeakSet,xn=function(e,A){const G=v(this,Ns,Wi).call(this),X=(e-G)/t(this,B),ct=(A-G)/t(this,f);this.scaleFactor=Math.min(X,ct)},Fs=new WeakSet,Gi=function(){const e=v(this,Ns,Wi).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)},_i=new WeakSet,xa=function(e){const A=new Path2D;for(let G=0,X=e.length;G<X;G++){const[ct,xt,kt,_t]=e[G];G===0&&A.moveTo(...ct),A.bezierCurveTo(xt[0],xt[1],kt[0],kt[1],_t[0],_t[1])}return A},Qs=new WeakSet,Sn=function(e,A,G){const[X,ct,xt,kt]=A;switch(G){case 0:for(let _t=0,jt=e.length;_t<jt;_t+=2)e[_t]+=X,e[_t+1]=kt-e[_t+1];break;case 90:for(let _t=0,jt=e.length;_t<jt;_t+=2){const Vt=e[_t];e[_t]=e[_t+1]+X,e[_t+1]=Vt+ct}break;case 180:for(let _t=0,jt=e.length;_t<jt;_t+=2)e[_t]=xt-e[_t],e[_t+1]+=ct;break;case 270:for(let _t=0,jt=e.length;_t<jt;_t+=2){const Vt=e[_t];e[_t]=xt-e[_t+1],e[_t+1]=kt-Vt}break;default:throw new Error("Invalid rotation")}return e},xi=new WeakSet,Sa=function(e,A,G){const[X,ct,xt,kt]=A;switch(G){case 0:for(let _t=0,jt=e.length;_t<jt;_t+=2)e[_t]-=X,e[_t+1]=kt-e[_t+1];break;case 90:for(let _t=0,jt=e.length;_t<jt;_t+=2){const Vt=e[_t];e[_t]=e[_t+1]-ct,e[_t+1]=Vt-X}break;case 180:for(let _t=0,jt=e.length;_t<jt;_t+=2)e[_t]=xt-e[_t],e[_t+1]-=ct;break;case 270:for(let _t=0,jt=e.length;_t<jt;_t+=2){const Vt=e[_t];e[_t]=kt-e[_t+1],e[_t+1]=xt-Vt}break;default:throw new Error("Invalid rotation")}return e},Si=new WeakSet,Ca=function(e,A,G,X){var jt,Vt;const ct=[],xt=this.thickness/2,kt=e*A+xt,_t=e*G+xt;for(const be of this.paths){const ve=[],Se=[];for(let Te=0,Ge=be.length;Te<Ge;Te++){const[Fe,je,He,os]=be[Te];if(Fe[0]===os[0]&&Fe[1]===os[1]&&Ge===1){const Ii=e*Fe[0]+kt,li=e*Fe[1]+_t;ve.push(Ii,li),Se.push(Ii,li);break}const oi=e*Fe[0]+kt,hi=e*Fe[1]+_t,Li=e*je[0]+kt,ss=e*je[1]+_t,sn=e*He[0]+kt,nn=e*He[1]+_t,ki=e*os[0]+kt,Pi=e*os[1]+_t;Te===0&&(ve.push(oi,hi),Se.push(oi,hi)),ve.push(Li,ss,sn,nn,ki,Pi),Se.push(Li,ss),Te===Ge-1&&Se.push(ki,Pi)}ct.push({bezier:v(jt=Ue,Qs,Sn).call(jt,ve,X,this.rotation),points:v(Vt=Ue,Qs,Sn).call(Vt,Se,X,this.rotation)})}return ct},Zs=new WeakSet,Cn=function(){let e=1/0,A=-1/0,G=1/0,X=-1/0;for(const ct of this.paths)for(const[xt,kt,_t,jt]of ct){const Vt=c.Util.bezierBoundingBox(...xt,...kt,..._t,...jt);e=Math.min(e,Vt[0]),G=Math.min(G,Vt[1]),A=Math.max(A,Vt[2]),X=Math.max(X,Vt[3])}return[e,G,A,X]},Ns=new WeakSet,Wi=function(){return t(this,yt)?Math.ceil(this.thickness*this.parentScale):0},_s=new WeakSet,fi=function(e=!1){if(this.isEmpty())return;if(!t(this,yt)){v(this,hs,Ls).call(this);return}const A=v(this,Zs,Cn).call(this),G=v(this,Ns,Wi).call(this);w(this,B,Math.max(at.AnnotationEditor.MIN_SIZE,A[2]-A[0])),w(this,f,Math.max(at.AnnotationEditor.MIN_SIZE,A[3]-A[1]));const X=Math.ceil(G+t(this,B)*this.scaleFactor),ct=Math.ceil(G+t(this,f)*this.scaleFactor),[xt,kt]=this.parentDimensions;this.width=X/xt,this.height=ct/kt,this.setAspectRatio(X,ct);const _t=this.translationX,jt=this.translationY;this.translationX=-A[0],this.translationY=-A[1],v(this,gs,Ks).call(this),v(this,hs,Ls).call(this),w(this,ee,X),w(this,Xt,ct),this.setDims(X,ct);const Vt=e?G/this.scaleFactor/2:0;this.translate(_t-this.translationX-Vt,jt-this.translationY-Vt)},r(Ue,_i),r(Ue,Qs),r(Ue,xi),Ae(Ue,"_defaultColor",null),Ae(Ue,"_defaultOpacity",1),Ae(Ue,"_defaultThickness",1),Ae(Ue,"_type","ink"),Ae(Ue,"_editorType",c.AnnotationEditorType.INK);let C=Ue;const ii=class ii extends at.AnnotationEditor{constructor(e){super({...e,name:"stampEditor"});r(this,Ss);r(this,Cs);r(this,Bs);r(this,ei);r(this,Ci);r(this,Ti);r(this,si);r(this,Us);r(this,Mi);r(this,$e,null);r(this,Xe,null);r(this,fs,null);r(this,ls,null);r(this,ms,null);r(this,Os,"");r(this,ns,null);r(this,xs,null);r(this,rs,null);r(this,ts,!1);r(this,ti,!1);w(this,ls,e.bitmapUrl),w(this,ms,e.bitmapFile)}static initialize(e,A){at.AnnotationEditor.initialize(e,A)}static get supportedTypes(){const e=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,c.shadow)(this,"supportedTypes",e.map(A=>`image/${A}`))}static get supportedTypesStr(){return(0,c.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,A){A.pasteEditor(c.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}remove(){var e,A;t(this,Xe)&&(w(this,$e,null),this._uiManager.imageManager.deleteId(t(this,Xe)),(e=t(this,ns))==null||e.remove(),w(this,ns,null),(A=t(this,xs))==null||A.disconnect(),w(this,xs,null),t(this,rs)&&(clearTimeout(t(this,rs)),w(this,rs,null))),super.remove()}rebuild(){if(!this.parent){t(this,Xe)&&v(this,Bs,$i).call(this);return}super.rebuild(),this.div!==null&&(t(this,Xe)&&t(this,ns)===null&&v(this,Bs,$i).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(t(this,fs)||t(this,$e)||t(this,ls)||t(this,ms)||t(this,Xe))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,A;if(this.width&&(e=this.x,A=this.y),super.render(),this.div.hidden=!0,this.addAltTextButton(),t(this,$e)?v(this,ei,Tn).call(this):v(this,Bs,$i).call(this),this.width){const[G,X]=this.parentDimensions;this.setAt(e*G,A*X,this.width*G,this.height*X)}return this.div}getImageForAltText(){return t(this,ns)}static deserialize(e,A,G){if(e instanceof nt.StampAnnotationElement)return null;const X=super.deserialize(e,A,G),{rect:ct,bitmapUrl:xt,bitmapId:kt,isSvg:_t,accessibilityData:jt}=e;kt&&G.imageManager.isValidId(kt)?w(X,Xe,kt):w(X,ls,xt),w(X,ts,_t);const[Vt,be]=X.pageDimensions;return X.width=(ct[2]-ct[0])/Vt,X.height=(ct[3]-ct[1])/be,jt&&(X.altTextData=jt),X}serialize(e=!1,A=null){if(this.isEmpty())return null;const G={annotationType:c.AnnotationEditorType.STAMP,bitmapId:t(this,Xe),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:t(this,ts),structTreeParentId:this._structTreeParentId};if(e)return G.bitmapUrl=v(this,Us,Xi).call(this,!0),G.accessibilityData=this.altTextData,G;const{decorative:X,altText:ct}=this.altTextData;if(!X&&ct&&(G.accessibilityData={type:"Figure",alt:ct}),A===null)return G;A.stamps||(A.stamps=new Map);const xt=t(this,ts)?(G.rect[2]-G.rect[0])*(G.rect[3]-G.rect[1]):null;if(!A.stamps.has(t(this,Xe)))A.stamps.set(t(this,Xe),{area:xt,serialized:G}),G.bitmap=v(this,Us,Xi).call(this,!1);else if(t(this,ts)){const kt=A.stamps.get(t(this,Xe));xt>kt.area&&(kt.area=xt,kt.serialized.bitmap.close(),kt.serialized.bitmap=v(this,Us,Xi).call(this,!1))}return G}};$e=new WeakMap,Xe=new WeakMap,fs=new WeakMap,ls=new WeakMap,ms=new WeakMap,Os=new WeakMap,ns=new WeakMap,xs=new WeakMap,rs=new WeakMap,ts=new WeakMap,ti=new WeakMap,Ss=new WeakSet,mi=function(e,A=!1){if(!e){this.remove();return}w(this,$e,e.bitmap),A||(w(this,Xe,e.id),w(this,ts,e.isSvg)),e.file&&w(this,Os,e.file.name),v(this,ei,Tn).call(this)},Cs=new WeakSet,Ai=function(){w(this,fs,null),this._uiManager.enableWaiting(!1),t(this,ns)&&this.div.focus()},Bs=new WeakSet,$i=function(){if(t(this,Xe)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(t(this,Xe)).then(A=>v(this,Ss,mi).call(this,A,!0)).finally(()=>v(this,Cs,Ai).call(this));return}if(t(this,ls)){const A=t(this,ls);w(this,ls,null),this._uiManager.enableWaiting(!0),w(this,fs,this._uiManager.imageManager.getFromUrl(A).then(G=>v(this,Ss,mi).call(this,G)).finally(()=>v(this,Cs,Ai).call(this)));return}if(t(this,ms)){const A=t(this,ms);w(this,ms,null),this._uiManager.enableWaiting(!0),w(this,fs,this._uiManager.imageManager.getFromFile(A).then(G=>v(this,Ss,mi).call(this,G)).finally(()=>v(this,Cs,Ai).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=ii.supportedTypesStr,w(this,fs,new Promise(A=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const G=await this._uiManager.imageManager.getFromFile(e.files[0]);v(this,Ss,mi).call(this,G)}A()}),e.addEventListener("cancel",()=>{this.remove(),A()})}).finally(()=>v(this,Cs,Ai).call(this))),e.click()},ei=new WeakSet,Tn=function(){const{div:e}=this;let{width:A,height:G}=t(this,$e);const[X,ct]=this.pageDimensions,xt=.75;if(this.width)A=this.width*X,G=this.height*ct;else if(A>xt*X||G>xt*ct){const Vt=Math.min(xt*X/A,xt*ct/G);A*=Vt,G*=Vt}const[kt,_t]=this.parentDimensions;this.setDims(A*kt/X,G*_t/ct),this._uiManager.enableWaiting(!1);const jt=w(this,ns,document.createElement("canvas"));e.append(jt),e.hidden=!1,v(this,si,Mn).call(this,A,G),v(this,Mi,Ra).call(this),t(this,ti)||(this.parent.addUndoableEditor(this),w(this,ti,!0)),this._reportTelemetry({action:"inserted_image"}),t(this,Os)&&jt.setAttribute("aria-label",t(this,Os))},Ci=new WeakSet,Ta=function(e,A){var xt;const[G,X]=this.parentDimensions;this.width=e/G,this.height=A/X,this.setDims(e,A),(xt=this._initialOptions)!=null&&xt.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,t(this,rs)!==null&&clearTimeout(t(this,rs)),w(this,rs,setTimeout(()=>{w(this,rs,null),v(this,si,Mn).call(this,e,A)},200))},Ti=new WeakSet,Ma=function(e,A){const{width:G,height:X}=t(this,$e);let ct=G,xt=X,kt=t(this,$e);for(;ct>2*e||xt>2*A;){const _t=ct,jt=xt;ct>2*e&&(ct=ct>=16384?Math.floor(ct/2)-1:Math.ceil(ct/2)),xt>2*A&&(xt=xt>=16384?Math.floor(xt/2)-1:Math.ceil(xt/2));const Vt=new OffscreenCanvas(ct,xt);Vt.getContext("2d").drawImage(kt,0,0,_t,jt,0,0,ct,xt),kt=Vt.transferToImageBitmap()}return kt},si=new WeakSet,Mn=function(e,A){e=Math.ceil(e),A=Math.ceil(A);const G=t(this,ns);if(!G||G.width===e&&G.height===A)return;G.width=e,G.height=A;const X=t(this,ts)?t(this,$e):v(this,Ti,Ma).call(this,e,A);if(this._uiManager.hasMLManager&&!this.hasAltText()){const xt=new OffscreenCanvas(e,A);xt.getContext("2d").drawImage(X,0,0,X.width,X.height,0,0,e,A),xt.convertToBlob().then(kt=>{const _t=new FileReader;_t.onload=()=>{const jt=_t.result;this._uiManager.mlGuess({service:"image-to-text",request:{imageData:jt}}).then(Vt=>{const be=(Vt==null?void 0:Vt.output)||"";this.parent&&be&&!this.hasAltText()&&(this.altTextData={altText:be,decorative:!1})})},_t.readAsDataURL(kt)})}const ct=G.getContext("2d");ct.filter=this._uiManager.hcmFilter,ct.drawImage(X,0,0,X.width,X.height,0,0,e,A)},Us=new WeakSet,Xi=function(e){if(e){if(t(this,ts)){const G=this._uiManager.imageManager.getSvgUrl(t(this,Xe));if(G)return G}const A=document.createElement("canvas");return{width:A.width,height:A.height}=t(this,$e),A.getContext("2d").drawImage(t(this,$e),0,0),A.toDataURL()}if(t(this,ts)){const[A,G]=this.pageDimensions,X=Math.round(this.width*A*j.PixelsPerInch.PDF_TO_CSS_UNITS),ct=Math.round(this.height*G*j.PixelsPerInch.PDF_TO_CSS_UNITS),xt=new OffscreenCanvas(X,ct);return xt.getContext("2d").drawImage(t(this,$e),0,0,t(this,$e).width,t(this,$e).height,0,0,X,ct),xt.transferToImageBitmap()}return structuredClone(t(this,$e))},Mi=new WeakSet,Ra=function(){w(this,xs,new ResizeObserver(e=>{const A=e[0].contentRect;A.width&&A.height&&v(this,Ci,Ta).call(this,A.width,A.height)})),t(this,xs).observe(this.div)},Ae(ii,"_type","stamp"),Ae(ii,"_editorType",c.AnnotationEditorType.STAMP);let F=ii;const es=class es{constructor({uiManager:lt,pageIndex:e,div:A,accessibilityManager:G,annotationLayer:X,drawLayer:ct,textLayer:xt,viewport:kt,l10n:_t}){r(this,Ri);r(this,ni);r(this,ri);r(this,ai);r(this,js);r(this,Ts,void 0);r(this,Hs,!1);r(this,as,null);r(this,Ms,null);r(this,cs,null);r(this,ds,null);r(this,us,null);r(this,Qe,new Map);r(this,As,!1);r(this,zs,!1);r(this,Vs,!1);r(this,Ye,null);r(this,ue,void 0);const jt=[...t(es,bs).values()];if(!es._initialized){es._initialized=!0;for(const Vt of jt)Vt.initialize(_t,lt)}lt.registerEditorTypes(jt),w(this,ue,lt),this.pageIndex=e,this.div=A,w(this,Ts,G),w(this,as,X),this.viewport=kt,w(this,Ye,xt),this.drawLayer=ct,t(this,ue).addLayer(this)}get isEmpty(){return t(this,Qe).size===0}get isInvisible(){return this.isEmpty&&t(this,ue).getMode()===c.AnnotationEditorType.NONE}updateToolbar(lt){t(this,ue).updateToolbar(lt)}updateMode(lt=t(this,ue).getMode()){switch(v(this,js,Ki).call(this),lt){case c.AnnotationEditorType.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case c.AnnotationEditorType.INK:this.addInkEditorIfNeeded(!1),this.disableTextSelection(),this.togglePointerEvents(!0),this.disableClick();break;case c.AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const A of t(es,bs).values())e.toggle(`${A._type}Editing`,lt===A._editorType);this.div.hidden=!1}hasTextLayer(lt){var e;return lt===((e=t(this,Ye))==null?void 0:e.div)}addInkEditorIfNeeded(lt){if(t(this,ue).getMode()===c.AnnotationEditorType.INK){if(!lt){for(const e of t(this,Qe).values())if(e.isEmpty()){e.setInBackground();return}}this.createAndAddNewEditor({offsetX:0,offsetY:0},!1).setInBackground()}}setEditingState(lt){t(this,ue).setEditingState(lt)}addCommands(lt){t(this,ue).addCommands(lt)}togglePointerEvents(lt=!1){this.div.classList.toggle("disabled",!lt)}toggleAnnotationLayerPointerEvents(lt=!1){var e;(e=t(this,as))==null||e.div.classList.toggle("disabled",!lt)}enable(){this.div.tabIndex=0,this.togglePointerEvents(!0);const lt=new Set;for(const A of t(this,Qe).values())A.enableEditing(),A.show(!0),A.annotationElementId&&(t(this,ue).removeChangedExistingAnnotation(A),lt.add(A.annotationElementId));if(!t(this,as))return;const e=t(this,as).getEditableAnnotations();for(const A of e){if(A.hide(),t(this,ue).isDeletedAnnotationElement(A.data.id)||lt.has(A.data.id))continue;const G=this.deserialize(A);G&&(this.addOrRebuild(G),G.enableEditing())}}disable(){var G;w(this,Vs,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const lt=new Map,e=new Map;for(const X of t(this,Qe).values())if(X.disableEditing(),!!X.annotationElementId){if(X.serialize()!==null){lt.set(X.annotationElementId,X);continue}else e.set(X.annotationElementId,X);(G=this.getEditableAnnotation(X.annotationElementId))==null||G.show(),X.remove()}if(t(this,as)){const X=t(this,as).getEditableAnnotations();for(const ct of X){const{id:xt}=ct.data;if(t(this,ue).isDeletedAnnotationElement(xt))continue;let kt=e.get(xt);if(kt){kt.resetAnnotationElement(ct),kt.show(!1),ct.show();continue}kt=lt.get(xt),kt&&(t(this,ue).addChangedExistingAnnotation(kt),kt.renderAnnotationElement(ct),kt.show(!1)),ct.show()}}v(this,js,Ki).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:A}=this.div;for(const X of t(es,bs).values())A.remove(`${X._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),w(this,Vs,!1)}getEditableAnnotation(lt){var e;return((e=t(this,as))==null?void 0:e.getEditableAnnotation(lt))||null}setActiveEditor(lt){t(this,ue).getActive()!==lt&&t(this,ue).setActiveEditor(lt)}enableTextSelection(){var lt;this.div.tabIndex=-1,(lt=t(this,Ye))!=null&&lt.div&&!t(this,ds)&&(w(this,ds,v(this,Ri,La).bind(this)),t(this,Ye).div.addEventListener("pointerdown",t(this,ds)),t(this,Ye).div.classList.add("highlighting"))}disableTextSelection(){var lt;this.div.tabIndex=0,(lt=t(this,Ye))!=null&&lt.div&&t(this,ds)&&(t(this,Ye).div.removeEventListener("pointerdown",t(this,ds)),w(this,ds,null),t(this,Ye).div.classList.remove("highlighting"))}enableClick(){t(this,cs)||(w(this,cs,this.pointerdown.bind(this)),w(this,Ms,this.pointerup.bind(this)),this.div.addEventListener("pointerdown",t(this,cs)),this.div.addEventListener("pointerup",t(this,Ms)))}disableClick(){t(this,cs)&&(this.div.removeEventListener("pointerdown",t(this,cs)),this.div.removeEventListener("pointerup",t(this,Ms)),w(this,cs,null),w(this,Ms,null))}attach(lt){t(this,Qe).set(lt.id,lt);const{annotationElementId:e}=lt;e&&t(this,ue).isDeletedAnnotationElement(e)&&t(this,ue).removeDeletedAnnotationElement(lt)}detach(lt){var e;t(this,Qe).delete(lt.id),(e=t(this,Ts))==null||e.removePointerInTextLayer(lt.contentDiv),!t(this,Vs)&&lt.annotationElementId&&t(this,ue).addDeletedAnnotationElement(lt)}remove(lt){this.detach(lt),t(this,ue).removeEditor(lt),lt.div.remove(),lt.isAttachedToDOM=!1,t(this,zs)||this.addInkEditorIfNeeded(!1)}changeParent(lt){var e;lt.parent!==this&&(lt.parent&&lt.annotationElementId&&(t(this,ue).addDeletedAnnotationElement(lt.annotationElementId),at.AnnotationEditor.deleteAnnotationElement(lt),lt.annotationElementId=null),this.attach(lt),(e=lt.parent)==null||e.detach(lt),lt.setParent(this),lt.div&&lt.isAttachedToDOM&&(lt.div.remove(),this.div.append(lt.div)))}add(lt){if(!(lt.parent===this&&lt.isAttachedToDOM)){if(this.changeParent(lt),t(this,ue).addEditor(lt),this.attach(lt),!lt.isAttachedToDOM){const e=lt.render();this.div.append(e),lt.isAttachedToDOM=!0}lt.fixAndSetPosition(),lt.onceAdded(),t(this,ue).addToAnnotationStorage(lt),lt._reportTelemetry(lt.telemetryInitialData)}}moveEditorInDOM(lt){var A;if(!lt.isAttachedToDOM)return;const{activeElement:e}=document;lt.div.contains(e)&&!t(this,us)&&(lt._focusEventsAllowed=!1,w(this,us,setTimeout(()=>{w(this,us,null),lt.div.contains(document.activeElement)?lt._focusEventsAllowed=!0:(lt.div.addEventListener("focusin",()=>{lt._focusEventsAllowed=!0},{once:!0}),e.focus())},0))),lt._structTreeParentId=(A=t(this,Ts))==null?void 0:A.moveElementInDOM(this.div,lt.div,lt.contentDiv,!0)}addOrRebuild(lt){lt.needsToBeRebuilt()?(lt.parent||(lt.parent=this),lt.rebuild(),lt.show()):this.add(lt)}addUndoableEditor(lt){const e=()=>lt._uiManager.rebuild(lt),A=()=>{lt.remove()};this.addCommands({cmd:e,undo:A,mustExec:!1})}getNextId(){return t(this,ue).getId()}canCreateNewEmptyEditor(){var lt;return(lt=t(this,ni,Rn))==null?void 0:lt.canCreateNewEmptyEditor()}pasteEditor(lt,e){t(this,ue).updateToolbar(lt),t(this,ue).updateMode(lt);const{offsetX:A,offsetY:G}=v(this,ai,kn).call(this),X=this.getNextId(),ct=v(this,ri,Ln).call(this,{parent:this,id:X,x:A,y:G,uiManager:t(this,ue),isCentered:!0,...e});ct&&this.add(ct)}deserialize(lt){var e;return((e=t(es,bs).get(lt.annotationType??lt.annotationEditorType))==null?void 0:e.deserialize(lt,this,t(this,ue)))||null}createAndAddNewEditor(lt,e,A={}){const G=this.getNextId(),X=v(this,ri,Ln).call(this,{parent:this,id:G,x:lt.offsetX,y:lt.offsetY,uiManager:t(this,ue),isCentered:e,...A});return X&&this.add(X),X}addNewEditor(){this.createAndAddNewEditor(v(this,ai,kn).call(this),!0)}setSelected(lt){t(this,ue).setSelected(lt)}toggleSelected(lt){t(this,ue).toggleSelected(lt)}isSelected(lt){return t(this,ue).isSelected(lt)}unselect(lt){t(this,ue).unselect(lt)}pointerup(lt){const{isMac:e}=c.FeatureTest.platform;if(!(lt.button!==0||lt.ctrlKey&&e)&&lt.target===this.div&&t(this,As)){if(w(this,As,!1),!t(this,Hs)){w(this,Hs,!0);return}if(t(this,ue).getMode()===c.AnnotationEditorType.STAMP){t(this,ue).unselectAll();return}this.createAndAddNewEditor(lt,!1)}}pointerdown(lt){if(t(this,ue).getMode()===c.AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),t(this,As)){w(this,As,!1);return}const{isMac:e}=c.FeatureTest.platform;if(lt.button!==0||lt.ctrlKey&&e||lt.target!==this.div)return;w(this,As,!0);const A=t(this,ue).getActive();w(this,Hs,!A||A.isEmpty())}findNewParent(lt,e,A){const G=t(this,ue).findParent(e,A);return G===null||G===this?!1:(G.changeParent(lt),!0)}destroy(){var lt,e;((lt=t(this,ue).getActive())==null?void 0:lt.parent)===this&&(t(this,ue).commitOrRemove(),t(this,ue).setActiveEditor(null)),t(this,us)&&(clearTimeout(t(this,us)),w(this,us,null));for(const A of t(this,Qe).values())(e=t(this,Ts))==null||e.removePointerInTextLayer(A.contentDiv),A.setParent(null),A.isAttachedToDOM=!1,A.div.remove();this.div=null,t(this,Qe).clear(),t(this,ue).removeLayer(this)}render({viewport:lt}){this.viewport=lt,(0,j.setLayerDimensions)(this.div,lt);for(const e of t(this,ue).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:lt}){t(this,ue).commitOrRemove(),v(this,js,Ki).call(this);const e=this.viewport.rotation,A=lt.rotation;if(this.viewport=lt,(0,j.setLayerDimensions)(this.div,{rotation:A}),e!==A)for(const G of t(this,Qe).values())G.rotate(A);this.addInkEditorIfNeeded(!1)}get pageDimensions(){const{pageWidth:lt,pageHeight:e}=this.viewport.rawDims;return[lt,e]}get scale(){return t(this,ue).viewParameters.realScale}};Ts=new WeakMap,Hs=new WeakMap,as=new WeakMap,Ms=new WeakMap,cs=new WeakMap,ds=new WeakMap,us=new WeakMap,Qe=new WeakMap,As=new WeakMap,zs=new WeakMap,Vs=new WeakMap,Ye=new WeakMap,ue=new WeakMap,bs=new WeakMap,Ri=new WeakSet,La=function(lt){if(t(this,ue).unselectAll(),lt.target===t(this,Ye).div){const{isMac:e}=c.FeatureTest.platform;if(lt.button!==0||lt.ctrlKey&&e)return;t(this,ue).showAllEditors("highlight",!0,!0),t(this,Ye).div.classList.add("free"),I.startHighlighting(this,t(this,ue).direction==="ltr",lt),t(this,Ye).div.addEventListener("pointerup",()=>{t(this,Ye).div.classList.remove("free")},{once:!0}),lt.preventDefault()}},ni=new WeakSet,Rn=function(){return t(es,bs).get(t(this,ue).getMode())},ri=new WeakSet,Ln=function(lt){const e=t(this,ni,Rn);return e?new e.prototype.constructor(lt):null},ai=new WeakSet,kn=function(){const{x:lt,y:e,width:A,height:G}=this.div.getBoundingClientRect(),X=Math.max(0,lt),ct=Math.max(0,e),xt=Math.min(window.innerWidth,lt+A),kt=Math.min(window.innerHeight,e+G),_t=(X+xt)/2-lt,jt=(ct+kt)/2-e,[Vt,be]=this.viewport.rotation%180===0?[_t,jt]:[jt,_t];return{offsetX:Vt,offsetY:be}},js=new WeakSet,Ki=function(){w(this,zs,!0);for(const lt of t(this,Qe).values())lt.isEmpty()&&lt.remove();w(this,zs,!1)},Ae(es,"_initialized",!1),r(es,bs,new Map([V,C,F,I].map(lt=>[lt._editorType,lt])));let D=es},259:(le,Wt,ut)=>{var bt,V,O,k,j,I,C,F,D,z,pt,tt,L,Pn,T,In,$,ka,wt,ks,Ct,Pa,Mt,ys;ut.d(Wt,{ColorPicker:()=>nt});var c=ut(292),at=ut(830),U=ut(419);const $t=class $t{constructor({editor:it=null,uiManager:St=null}){r(this,L);r(this,T);r(this,$);r(this,wt);r(this,Ct);r(this,Mt);r(this,bt,v(this,$,ka).bind(this));r(this,V,v(this,Ct,Pa).bind(this));r(this,O,null);r(this,k,null);r(this,j,void 0);r(this,I,null);r(this,C,!1);r(this,F,!1);r(this,D,null);r(this,z,void 0);r(this,pt,null);r(this,tt,void 0);var Gt;it?(w(this,F,!1),w(this,tt,c.AnnotationEditorParamsType.HIGHLIGHT_COLOR),w(this,D,it)):(w(this,F,!0),w(this,tt,c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR)),w(this,pt,(it==null?void 0:it._uiManager)||St),w(this,z,t(this,pt)._eventBus),w(this,j,(it==null?void 0:it.color)||((Gt=t(this,pt))==null?void 0:Gt.highlightColors.values().next().value)||"#FFFF98")}static get _keyboardManager(){return(0,c.shadow)(this,"_keyboardManager",new at.KeyboardManager([[["Escape","mac+Escape"],$t.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],$t.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],$t.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],$t.prototype._moveToPrevious],[["Home","mac+Home"],$t.prototype._moveToBeginning],[["End","mac+End"],$t.prototype._moveToEnd]]))}renderButton(){const it=w(this,O,document.createElement("button"));it.className="colorPicker",it.tabIndex="0",it.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),it.setAttribute("aria-haspopup",!0),it.addEventListener("click",v(this,wt,ks).bind(this)),it.addEventListener("keydown",t(this,bt));const St=w(this,k,document.createElement("span"));return St.className="swatch",St.setAttribute("aria-hidden",!0),St.style.backgroundColor=t(this,j),it.append(St),it}renderMainDropdown(){const it=w(this,I,v(this,L,Pn).call(this));return it.setAttribute("aria-orientation","horizontal"),it.setAttribute("aria-labelledby","highlightColorPickerLabel"),it}_colorSelectFromKeyboard(it){if(it.target===t(this,O)){v(this,wt,ks).call(this,it);return}const St=it.target.getAttribute("data-color");St&&v(this,T,In).call(this,St,it)}_moveToNext(it){var St,Gt;if(!t(this,Mt,ys)){v(this,wt,ks).call(this,it);return}if(it.target===t(this,O)){(St=t(this,I).firstChild)==null||St.focus();return}(Gt=it.target.nextSibling)==null||Gt.focus()}_moveToPrevious(it){var St,Gt;if(it.target===((St=t(this,I))==null?void 0:St.firstChild)||it.target===t(this,O)){t(this,Mt,ys)&&this._hideDropdownFromKeyboard();return}t(this,Mt,ys)||v(this,wt,ks).call(this,it),(Gt=it.target.previousSibling)==null||Gt.focus()}_moveToBeginning(it){var St;if(!t(this,Mt,ys)){v(this,wt,ks).call(this,it);return}(St=t(this,I).firstChild)==null||St.focus()}_moveToEnd(it){var St;if(!t(this,Mt,ys)){v(this,wt,ks).call(this,it);return}(St=t(this,I).lastChild)==null||St.focus()}hideDropdown(){var it;(it=t(this,I))==null||it.classList.add("hidden"),window.removeEventListener("pointerdown",t(this,V))}_hideDropdownFromKeyboard(){var it;if(!t(this,F)){if(!t(this,Mt,ys)){(it=t(this,D))==null||it.unselect();return}this.hideDropdown(),t(this,O).focus({preventScroll:!0,focusVisible:t(this,C)})}}updateColor(it){if(t(this,k)&&(t(this,k).style.backgroundColor=it),!t(this,I))return;const St=t(this,pt).highlightColors.values();for(const Gt of t(this,I).children)Gt.setAttribute("aria-selected",St.next().value===it)}destroy(){var it,St;(it=t(this,O))==null||it.remove(),w(this,O,null),w(this,k,null),(St=t(this,I))==null||St.remove(),w(this,I,null)}};bt=new WeakMap,V=new WeakMap,O=new WeakMap,k=new WeakMap,j=new WeakMap,I=new WeakMap,C=new WeakMap,F=new WeakMap,D=new WeakMap,z=new WeakMap,pt=new WeakMap,tt=new WeakMap,L=new WeakSet,Pn=function(){const it=document.createElement("div");it.addEventListener("contextmenu",U.noContextMenu),it.className="dropdown",it.role="listbox",it.setAttribute("aria-multiselectable",!1),it.setAttribute("aria-orientation","vertical"),it.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[St,Gt]of t(this,pt).highlightColors){const zt=document.createElement("button");zt.tabIndex="0",zt.role="option",zt.setAttribute("data-color",Gt),zt.title=St,zt.setAttribute("data-l10n-id",`pdfjs-editor-colorpicker-${St}`);const ie=document.createElement("span");zt.append(ie),ie.className="swatch",ie.style.backgroundColor=Gt,zt.setAttribute("aria-selected",Gt===t(this,j)),zt.addEventListener("click",v(this,T,In).bind(this,Gt)),it.append(zt)}return it.addEventListener("keydown",t(this,bt)),it},T=new WeakSet,In=function(it,St){St.stopPropagation(),t(this,z).dispatch("switchannotationeditorparams",{source:this,type:t(this,tt),value:it})},$=new WeakSet,ka=function(it){$t._keyboardManager.exec(this,it)},wt=new WeakSet,ks=function(it){if(t(this,Mt,ys)){this.hideDropdown();return}if(w(this,C,it.detail===0),window.addEventListener("pointerdown",t(this,V)),t(this,I)){t(this,I).classList.remove("hidden");return}const St=w(this,I,v(this,L,Pn).call(this));t(this,O).append(St)},Ct=new WeakSet,Pa=function(it){var St;(St=t(this,I))!=null&&St.contains(it.target)||this.hideDropdown()},Mt=new WeakSet,ys=function(){return t(this,I)&&!t(this,I).classList.contains("hidden")};let nt=$t},310:(le,Wt,ut)=>{var k,j,I,C,F,D,z,pt,Dn,N,T,M,$,et,wt,Pt,Ct,Nt,Mt,qt,$t,Kt,it,St,Gt,zt,ie,ae,he,ye,Oe,Fn,fe,Nn,re,On,Yt,Ia,te,Da,s,Bn,a,Un,n,Hn,u,Fa,b,Na,o,Oa,x,Ba,K,zn,gt,bi;ut.d(Wt,{AnnotationEditor:()=>V});var c=ut(830),at=ut(292),U=ut(419);const L=class L{constructor(E){r(this,pt);r(this,k,"");r(this,j,!1);r(this,I,null);r(this,C,null);r(this,F,null);r(this,D,!1);r(this,z,null);w(this,z,E)}static initialize(E){L._l10nPromise||(L._l10nPromise=E)}async render(){const E=w(this,I,document.createElement("button"));E.className="altText";const R=await L._l10nPromise.get("pdfjs-editor-alt-text-button-label");E.textContent=R,E.setAttribute("aria-label",R),E.tabIndex="0",E.addEventListener("contextmenu",U.noContextMenu),E.addEventListener("pointerdown",W=>W.stopPropagation());const Q=W=>{W.preventDefault(),t(this,z)._uiManager.editAltText(t(this,z))};return E.addEventListener("click",Q,{capture:!0}),E.addEventListener("keydown",W=>{W.target===E&&W.key==="Enter"&&(w(this,D,!0),Q(W))}),await v(this,pt,Dn).call(this),E}finish(){t(this,I)&&(t(this,I).focus({focusVisible:t(this,D)}),w(this,D,!1))}isEmpty(){return!t(this,k)&&!t(this,j)}get data(){return{altText:t(this,k),decorative:t(this,j)}}set data({altText:E,decorative:R}){t(this,k)===E&&t(this,j)===R||(w(this,k,E),w(this,j,R),v(this,pt,Dn).call(this))}toggle(E=!1){t(this,I)&&(!E&&t(this,F)&&(clearTimeout(t(this,F)),w(this,F,null)),t(this,I).disabled=!E)}destroy(){var E;(E=t(this,I))==null||E.remove(),w(this,I,null),w(this,C,null)}};k=new WeakMap,j=new WeakMap,I=new WeakMap,C=new WeakMap,F=new WeakMap,D=new WeakMap,z=new WeakMap,pt=new WeakSet,Dn=async function(){var Q,W;const E=t(this,I);if(!E)return;if(!t(this,k)&&!t(this,j)){E.classList.remove("done"),(Q=t(this,C))==null||Q.remove();return}E.classList.add("done"),L._l10nPromise.get("pdfjs-editor-alt-text-edit-button-label").then(vt=>{E.setAttribute("aria-label",vt)});let R=t(this,C);if(!R){w(this,C,R=document.createElement("span")),R.className="tooltip",R.setAttribute("role","tooltip");const vt=R.id=`alt-text-tooltip-${t(this,z).id}`;E.setAttribute("aria-describedby",vt);const J=100;E.addEventListener("mouseenter",()=>{w(this,F,setTimeout(()=>{w(this,F,null),t(this,C).classList.add("show"),t(this,z)._reportTelemetry({action:"alt_text_tooltip"})},J))}),E.addEventListener("mouseleave",()=>{var y;t(this,F)&&(clearTimeout(t(this,F)),w(this,F,null)),(y=t(this,C))==null||y.classList.remove("show")})}R.innerText=t(this,j)?await L._l10nPromise.get("pdfjs-editor-alt-text-decorative-tooltip"):t(this,k),R.parentNode||E.append(R),(W=t(this,z).getImageForAltText())==null||W.setAttribute("aria-describedby",R.id)},Ae(L,"_l10nPromise",null);let nt=L;var bt=ut(362);const ot=class ot{constructor(E){r(this,Oe);r(this,re);r(this,Yt);r(this,te);r(this,s);r(this,a);r(this,n);r(this,u);r(this,b);r(this,o);r(this,x);r(this,K);r(this,gt);r(this,N,null);r(this,T,null);r(this,M,!1);r(this,$,!1);r(this,et,null);r(this,wt,null);r(this,Pt,this.focusin.bind(this));r(this,Ct,this.focusout.bind(this));r(this,Nt,null);r(this,Mt,"");r(this,qt,!1);r(this,$t,null);r(this,Kt,!1);r(this,it,!1);r(this,St,!1);r(this,Gt,null);r(this,zt,0);r(this,ie,0);r(this,ae,null);Ae(this,"_initialOptions",Object.create(null));Ae(this,"_isVisible",!0);Ae(this,"_uiManager",null);Ae(this,"_focusEventsAllowed",!0);Ae(this,"_l10nPromise",null);r(this,he,!1);r(this,ye,ot._zIndex++);this.constructor===ot&&(0,at.unreachable)("Cannot initialize AnnotationEditor."),this.parent=E.parent,this.id=E.id,this.width=this.height=null,this.pageIndex=E.parent.pageIndex,this.name=E.name,this.div=null,this._uiManager=E.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=E.isCentered,this._structTreeParentId=null;const{rotation:R,rawDims:{pageWidth:Q,pageHeight:W,pageX:vt,pageY:J}}=this.parent.viewport;this.rotation=R,this.pageRotation=(360+R-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Q,W],this.pageTranslation=[vt,J];const[y,P]=this.parentDimensions;this.x=E.x/y,this.y=E.y/P,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const E=ot.prototype._resizeWithKeyboard,R=c.AnnotationEditorUIManager.TRANSLATE_SMALL,Q=c.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,at.shadow)(this,"_resizerKeyboardManager",new c.KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],E,{args:[-R,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],E,{args:[-Q,0]}],[["ArrowRight","mac+ArrowRight"],E,{args:[R,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],E,{args:[Q,0]}],[["ArrowUp","mac+ArrowUp"],E,{args:[0,-R]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],E,{args:[0,-Q]}],[["ArrowDown","mac+ArrowDown"],E,{args:[0,R]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],E,{args:[0,Q]}],[["Escape","mac+Escape"],ot.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,at.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(E){const R=new O({id:E.parent.getNextId(),parent:E.parent,uiManager:E._uiManager});R.annotationElementId=E.annotationElementId,R.deleted=!0,R._uiManager.addToAnnotationStorage(R)}static initialize(E,R,Q){if(ot._l10nPromise||(ot._l10nPromise=new Map(["pdfjs-editor-alt-text-button-label","pdfjs-editor-alt-text-edit-button-label","pdfjs-editor-alt-text-decorative-tooltip","pdfjs-editor-resizer-label-topLeft","pdfjs-editor-resizer-label-topMiddle","pdfjs-editor-resizer-label-topRight","pdfjs-editor-resizer-label-middleRight","pdfjs-editor-resizer-label-bottomRight","pdfjs-editor-resizer-label-bottomMiddle","pdfjs-editor-resizer-label-bottomLeft","pdfjs-editor-resizer-label-middleLeft"].map(vt=>[vt,E.get(vt.replaceAll(/([A-Z])/g,J=>`-${J.toLowerCase()}`))]))),Q==null?void 0:Q.strings)for(const vt of Q.strings)ot._l10nPromise.set(vt,E.get(vt));if(ot._borderLineWidth!==-1)return;const W=getComputedStyle(document.documentElement);ot._borderLineWidth=parseFloat(W.getPropertyValue("--outline-width"))||0}static updateDefaultParams(E,R){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(E){return!1}static paste(E,R){(0,at.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return t(this,he)}set _isDraggable(E){var R;w(this,he,E),(R=this.div)==null||R.classList.toggle("draggable",E)}get isEnterHandled(){return!0}center(){const[E,R]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*R/(E*2),this.y+=this.width*E/(R*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*R/(E*2),this.y-=this.width*E/(R*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(E){this._uiManager.addCommands(E)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=t(this,ye)}setParent(E){E!==null?(this.pageIndex=E.pageIndex,this.pageDimensions=E.pageDimensions):v(this,gt,bi).call(this),this.parent=E}focusin(E){this._focusEventsAllowed&&(t(this,qt)?w(this,qt,!1):this.parent.setSelected(this))}focusout(E){var R,Q;!this._focusEventsAllowed||!this.isAttachedToDOM||(R=E.relatedTarget)!=null&&R.closest(`#${this.id}`)||(E.preventDefault(),(Q=this.parent)!=null&&Q.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(E,R,Q,W){const[vt,J]=this.parentDimensions;[Q,W]=this.screenToPageTranslation(Q,W),this.x=(E+Q)/vt,this.y=(R+W)/J,this.fixAndSetPosition()}translate(E,R){v(this,Oe,Fn).call(this,this.parentDimensions,E,R)}translateInPage(E,R){t(this,$t)||w(this,$t,[this.x,this.y]),v(this,Oe,Fn).call(this,this.pageDimensions,E,R),this.div.scrollIntoView({block:"nearest"})}drag(E,R){t(this,$t)||w(this,$t,[this.x,this.y]);const[Q,W]=this.parentDimensions;if(this.x+=E/Q,this.y+=R/W,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:H,y:ht}=this.div.getBoundingClientRect();this.parent.findNewParent(this,H,ht)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:vt,y:J}=this;const[y,P]=this.getBaseTranslation();vt+=y,J+=P,this.div.style.left=`${(100*vt).toFixed(2)}%`,this.div.style.top=`${(100*J).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}get _hasBeenMoved(){return!!t(this,$t)&&(t(this,$t)[0]!==this.x||t(this,$t)[1]!==this.y)}getBaseTranslation(){const[E,R]=this.parentDimensions,{_borderLineWidth:Q}=ot,W=Q/E,vt=Q/R;switch(this.rotation){case 90:return[-W,vt];case 180:return[W,vt];case 270:return[W,-vt];default:return[-W,-vt]}}get _mustFixPosition(){return!0}fixAndSetPosition(E=this.rotation){const[R,Q]=this.pageDimensions;let{x:W,y:vt,width:J,height:y}=this;if(J*=R,y*=Q,W*=R,vt*=Q,this._mustFixPosition)switch(E){case 0:W=Math.max(0,Math.min(R-J,W)),vt=Math.max(0,Math.min(Q-y,vt));break;case 90:W=Math.max(0,Math.min(R-y,W)),vt=Math.min(Q,Math.max(J,vt));break;case 180:W=Math.min(R,Math.max(J,W)),vt=Math.min(Q,Math.max(y,vt));break;case 270:W=Math.min(R,Math.max(y,W)),vt=Math.max(0,Math.min(Q-J,vt));break}this.x=W/=R,this.y=vt/=Q;const[P,H]=this.getBaseTranslation();W+=P,vt+=H;const{style:ht}=this.div;ht.left=`${(100*W).toFixed(2)}%`,ht.top=`${(100*vt).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(E,R){var Q;return v(Q=ot,fe,Nn).call(Q,E,R,this.parentRotation)}pageTranslationToScreen(E,R){var Q;return v(Q=ot,fe,Nn).call(Q,E,R,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:E,pageDimensions:[R,Q]}=this,W=R*E,vt=Q*E;return at.FeatureTest.isCSSRoundSupported?[Math.round(W),Math.round(vt)]:[W,vt]}setDims(E,R){const[Q,W]=this.parentDimensions;this.div.style.width=`${(100*E/Q).toFixed(2)}%`,t(this,$)||(this.div.style.height=`${(100*R/W).toFixed(2)}%`)}fixDims(){const{style:E}=this.div,{height:R,width:Q}=E,W=Q.endsWith("%"),vt=!t(this,$)&&R.endsWith("%");if(W&&vt)return;const[J,y]=this.parentDimensions;W||(E.width=`${(100*parseFloat(Q)/J).toFixed(2)}%`),!t(this,$)&&!vt&&(E.height=`${(100*parseFloat(R)/y).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}altTextFinish(){var E;(E=t(this,T))==null||E.finish()}async addEditToolbar(){return t(this,Nt)||t(this,it)?t(this,Nt):(w(this,Nt,new bt.EditorToolbar(this)),this.div.append(t(this,Nt).render()),t(this,T)&&t(this,Nt).addAltTextButton(await t(this,T).render()),t(this,Nt))}removeEditToolbar(){var E;t(this,Nt)&&(t(this,Nt).remove(),w(this,Nt,null),(E=t(this,T))==null||E.destroy())}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){t(this,T)||(nt.initialize(ot._l10nPromise),w(this,T,new nt(this)),await this.addEditToolbar())}get altTextData(){var E;return(E=t(this,T))==null?void 0:E.data}set altTextData(E){t(this,T)&&(t(this,T).data=E)}hasAltText(){var E;return!((E=t(this,T))!=null&&E.isEmpty())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=t(this,M)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.div.addEventListener("focusin",t(this,Pt)),this.div.addEventListener("focusout",t(this,Ct));const[E,R]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*R/E).toFixed(2)}%`,this.div.style.maxHeight=`${(100*E/R).toFixed(2)}%`);const[Q,W]=this.getInitialTranslation();return this.translate(Q,W),(0,c.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(E){const{isMac:R}=at.FeatureTest.platform;if(E.button!==0||E.ctrlKey&&R){E.preventDefault();return}if(w(this,qt,!0),this._isDraggable){v(this,u,Fa).call(this,E);return}v(this,n,Hn).call(this,E)}moveInDOM(){t(this,Gt)&&clearTimeout(t(this,Gt)),w(this,Gt,setTimeout(()=>{var E;w(this,Gt,null),(E=this.parent)==null||E.moveEditorInDOM(this)},0))}_setParentAndPosition(E,R,Q){E.changeParent(this),this.x=R,this.y=Q,this.fixAndSetPosition()}getRect(E,R,Q=this.rotation){const W=this.parentScale,[vt,J]=this.pageDimensions,[y,P]=this.pageTranslation,H=E/W,ht=R/W,Et=this.x*vt,Tt=this.y*J,Bt=this.width*vt,Zt=this.height*J;switch(Q){case 0:return[Et+H+y,J-Tt-ht-Zt+P,Et+H+Bt+y,J-Tt-ht+P];case 90:return[Et+ht+y,J-Tt+H+P,Et+ht+Zt+y,J-Tt+H+Bt+P];case 180:return[Et-H-Bt+y,J-Tt+ht+P,Et-H+y,J-Tt+ht+Zt+P];case 270:return[Et-ht-Zt+y,J-Tt-H-Bt+P,Et-ht+y,J-Tt-H+P];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(E,R){const[Q,W,vt,J]=E,y=vt-Q,P=J-W;switch(this.rotation){case 0:return[Q,R-J,y,P];case 90:return[Q,R-W,P,y];case 180:return[vt,R-W,y,P];case 270:return[vt,R-J,P,y];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){w(this,it,!0)}disableEditMode(){w(this,it,!1)}isInEditMode(){return t(this,it)}shouldGetKeyboardEvents(){return t(this,St)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var E,R;(E=this.div)==null||E.addEventListener("focusin",t(this,Pt)),(R=this.div)==null||R.addEventListener("focusout",t(this,Ct))}rotate(E){}serialize(E=!1,R=null){(0,at.unreachable)("An editor must be serializable")}static deserialize(E,R,Q){const W=new this.prototype.constructor({parent:R,id:R.getNextId(),uiManager:Q});W.rotation=E.rotation;const[vt,J]=W.pageDimensions,[y,P,H,ht]=W.getRectInCurrentCoords(E.rect,J);return W.x=y/vt,W.y=P/J,W.width=H/vt,W.height=ht/J,W}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.div.removeEventListener("focusin",t(this,Pt)),this.div.removeEventListener("focusout",t(this,Ct)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),t(this,Gt)&&(clearTimeout(t(this,Gt)),w(this,Gt,null)),v(this,gt,bi).call(this),this.removeEditToolbar(),t(this,ae)){for(const E of t(this,ae).values())clearTimeout(E);w(this,ae,null)}this.parent=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(v(this,Yt,Ia).call(this),t(this,et).classList.remove("hidden"),(0,c.bindEvents)(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(E){if(!this.isResizable||E.target!==this.div||E.key!=="Enter")return;this._uiManager.setSelected(this),w(this,wt,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const R=t(this,et).children;if(!t(this,N)){w(this,N,Array.from(R));const J=v(this,b,Na).bind(this),y=v(this,o,Oa).bind(this);for(const P of t(this,N)){const H=P.getAttribute("data-resizer-name");P.setAttribute("role","spinbutton"),P.addEventListener("keydown",J),P.addEventListener("blur",y),P.addEventListener("focus",v(this,x,Ba).bind(this,H)),ot._l10nPromise.get(`pdfjs-editor-resizer-label-${H}`).then(ht=>P.setAttribute("aria-label",ht))}}const Q=t(this,N)[0];let W=0;for(const J of R){if(J===Q)break;W++}const vt=(360-this.rotation+this.parentRotation)%360/90*(t(this,N).length/4);if(vt!==W){if(vt<W)for(let y=0;y<W-vt;y++)t(this,et).append(t(this,et).firstChild);else if(vt>W)for(let y=0;y<vt-W;y++)t(this,et).firstChild.before(t(this,et).lastChild);let J=0;for(const y of R){const P=t(this,N)[J++].getAttribute("data-resizer-name");ot._l10nPromise.get(`pdfjs-editor-resizer-label-${P}`).then(H=>y.setAttribute("aria-label",H))}}v(this,K,zn).call(this,0),w(this,St,!0),t(this,et).firstChild.focus({focusVisible:!0}),E.preventDefault(),E.stopImmediatePropagation()}_resizeWithKeyboard(E,R){t(this,St)&&v(this,a,Un).call(this,t(this,Mt),{movementX:E,movementY:R})}_stopResizingWithKeyboard(){v(this,gt,bi).call(this),this.div.focus()}select(){var E,R;if(this.makeResizable(),(E=this.div)==null||E.classList.add("selectedEditor"),!t(this,Nt)){this.addEditToolbar().then(()=>{var Q,W;(Q=this.div)!=null&&Q.classList.contains("selectedEditor")&&((W=t(this,Nt))==null||W.show())});return}(R=t(this,Nt))==null||R.show()}unselect(){var E,R,Q,W;(E=t(this,et))==null||E.classList.add("hidden"),(R=this.div)==null||R.classList.remove("selectedEditor"),(Q=this.div)!=null&&Q.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(W=t(this,Nt))==null||W.hide()}updateParams(E,R){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return t(this,Kt)}set isEditing(E){w(this,Kt,E),this.parent&&(E?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(E,R){w(this,$,!0);const Q=E/R,{style:W}=this.div;W.aspectRatio=Q,W.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(E,R=!1){if(R){t(this,ae)||w(this,ae,new Map);const{action:Q}=E;let W=t(this,ae).get(Q);W&&clearTimeout(W),W=setTimeout(()=>{this._reportTelemetry(E),t(this,ae).delete(Q),t(this,ae).size===0&&w(this,ae,null)},ot._telemetryTimeout),t(this,ae).set(Q,W);return}E.type||(E.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:E}})}show(E=this._isVisible){this.div.classList.toggle("hidden",!E),this._isVisible=E}enable(){this.div&&(this.div.tabIndex=0),w(this,M,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,M,!0)}renderAnnotationElement(E){let R=E.container.querySelector(".annotationContent");if(!R)R=document.createElement("div"),R.classList.add("annotationContent",this.editorType),E.container.prepend(R);else if(R.nodeName==="CANVAS"){const Q=R;R=document.createElement("div"),R.classList.add("annotationContent",this.editorType),Q.before(R)}return R}resetAnnotationElement(E){const{firstChild:R}=E.container;R.nodeName==="DIV"&&R.classList.contains("annotationContent")&&R.remove()}};N=new WeakMap,T=new WeakMap,M=new WeakMap,$=new WeakMap,et=new WeakMap,wt=new WeakMap,Pt=new WeakMap,Ct=new WeakMap,Nt=new WeakMap,Mt=new WeakMap,qt=new WeakMap,$t=new WeakMap,Kt=new WeakMap,it=new WeakMap,St=new WeakMap,Gt=new WeakMap,zt=new WeakMap,ie=new WeakMap,ae=new WeakMap,he=new WeakMap,ye=new WeakMap,Oe=new WeakSet,Fn=function([E,R],Q,W){[Q,W]=this.screenToPageTranslation(Q,W),this.x+=Q/E,this.y+=W/R,this.fixAndSetPosition()},fe=new WeakSet,Nn=function(E,R,Q){switch(Q){case 90:return[R,-E];case 180:return[-E,-R];case 270:return[-R,E];default:return[E,R]}},re=new WeakSet,On=function(E){switch(E){case 90:{const[R,Q]=this.pageDimensions;return[0,-R/Q,Q/R,0]}case 180:return[-1,0,0,-1];case 270:{const[R,Q]=this.pageDimensions;return[0,R/Q,-Q/R,0]}default:return[1,0,0,1]}},Yt=new WeakSet,Ia=function(){if(t(this,et))return;w(this,et,document.createElement("div")),t(this,et).classList.add("resizers");const E=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"];for(const R of E){const Q=document.createElement("div");t(this,et).append(Q),Q.classList.add("resizer",R),Q.setAttribute("data-resizer-name",R),Q.addEventListener("pointerdown",v(this,te,Da).bind(this,R)),Q.addEventListener("contextmenu",U.noContextMenu),Q.tabIndex=-1}this.div.prepend(t(this,et))},te=new WeakSet,Da=function(E,R){var Zt;R.preventDefault();const{isMac:Q}=at.FeatureTest.platform;if(R.button!==0||R.ctrlKey&&Q)return;(Zt=t(this,T))==null||Zt.toggle(!1);const W=v(this,a,Un).bind(this,E),vt=this._isDraggable;this._isDraggable=!1;const J={passive:!0,capture:!0};this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",W,J),window.addEventListener("contextmenu",U.noContextMenu);const y=this.x,P=this.y,H=this.width,ht=this.height,Et=this.parent.div.style.cursor,Tt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(R.target).cursor;const Bt=()=>{var De;this.parent.togglePointerEvents(!0),(De=t(this,T))==null||De.toggle(!0),this._isDraggable=vt,window.removeEventListener("pointerup",Bt),window.removeEventListener("blur",Bt),window.removeEventListener("pointermove",W,J),window.removeEventListener("contextmenu",U.noContextMenu),this.parent.div.style.cursor=Et,this.div.style.cursor=Tt,v(this,s,Bn).call(this,y,P,H,ht)};window.addEventListener("pointerup",Bt),window.addEventListener("blur",Bt)},s=new WeakSet,Bn=function(E,R,Q,W){const vt=this.x,J=this.y,y=this.width,P=this.height;vt===E&&J===R&&y===Q&&P===W||this.addCommands({cmd:()=>{this.width=y,this.height=P,this.x=vt,this.y=J;const[H,ht]=this.parentDimensions;this.setDims(H*y,ht*P),this.fixAndSetPosition()},undo:()=>{this.width=Q,this.height=W,this.x=E,this.y=R;const[H,ht]=this.parentDimensions;this.setDims(H*Q,ht*W),this.fixAndSetPosition()},mustExec:!0})},a=new WeakSet,Un=function(E,R){const[Q,W]=this.parentDimensions,vt=this.x,J=this.y,y=this.width,P=this.height,H=ot.MIN_SIZE/Q,ht=ot.MIN_SIZE/W,Et=yt=>Math.round(yt*1e4)/1e4,Tt=v(this,re,On).call(this,this.rotation),Bt=(yt,Lt)=>[Tt[0]*yt+Tt[2]*Lt,Tt[1]*yt+Tt[3]*Lt],Zt=v(this,re,On).call(this,360-this.rotation),De=(yt,Lt)=>[Zt[0]*yt+Zt[2]*Lt,Zt[1]*yt+Zt[3]*Lt];let me,Ee,de=!1,Me=!1;switch(E){case"topLeft":de=!0,me=(yt,Lt)=>[0,0],Ee=(yt,Lt)=>[yt,Lt];break;case"topMiddle":me=(yt,Lt)=>[yt/2,0],Ee=(yt,Lt)=>[yt/2,Lt];break;case"topRight":de=!0,me=(yt,Lt)=>[yt,0],Ee=(yt,Lt)=>[0,Lt];break;case"middleRight":Me=!0,me=(yt,Lt)=>[yt,Lt/2],Ee=(yt,Lt)=>[0,Lt/2];break;case"bottomRight":de=!0,me=(yt,Lt)=>[yt,Lt],Ee=(yt,Lt)=>[0,0];break;case"bottomMiddle":me=(yt,Lt)=>[yt/2,Lt],Ee=(yt,Lt)=>[yt/2,0];break;case"bottomLeft":de=!0,me=(yt,Lt)=>[0,Lt],Ee=(yt,Lt)=>[yt,0];break;case"middleLeft":Me=!0,me=(yt,Lt)=>[0,Lt/2],Ee=(yt,Lt)=>[yt,Lt/2];break}const we=me(y,P),ze=Ee(y,P);let Le=Bt(...ze);const Jt=Et(vt+Le[0]),m=Et(J+Le[1]);let f=1,B=1,[Z,st]=this.screenToPageTranslation(R.movementX,R.movementY);if([Z,st]=De(Z/Q,st/W),de){const yt=Math.hypot(y,P);f=B=Math.max(Math.min(Math.hypot(ze[0]-we[0]-Z,ze[1]-we[1]-st)/yt,1/y,1/P),H/y,ht/P)}else Me?f=Math.max(H,Math.min(1,Math.abs(ze[0]-we[0]-Z)))/y:B=Math.max(ht,Math.min(1,Math.abs(ze[1]-we[1]-st)))/P;const dt=Et(y*f),ft=Et(P*B);Le=Bt(...Ee(dt,ft));const Ht=Jt-Le[0],It=m-Le[1];this.width=dt,this.height=ft,this.x=Ht,this.y=It,this.setDims(Q*dt,W*ft),this.fixAndSetPosition()},n=new WeakSet,Hn=function(E){const{isMac:R}=at.FeatureTest.platform;E.ctrlKey&&!R||E.shiftKey||E.metaKey&&R?this.parent.toggleSelected(this):this.parent.setSelected(this)},u=new WeakSet,Fa=function(E){const R=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Q,W;R&&(this.div.classList.add("moving"),Q={passive:!0,capture:!0},w(this,zt,E.clientX),w(this,ie,E.clientY),W=J=>{const{clientX:y,clientY:P}=J,[H,ht]=this.screenToPageTranslation(y-t(this,zt),P-t(this,ie));w(this,zt,y),w(this,ie,P),this._uiManager.dragSelectedEditors(H,ht)},window.addEventListener("pointermove",W,Q));const vt=()=>{window.removeEventListener("pointerup",vt),window.removeEventListener("blur",vt),R&&(this.div.classList.remove("moving"),window.removeEventListener("pointermove",W,Q)),w(this,qt,!1),this._uiManager.endDragSession()||v(this,n,Hn).call(this,E)};window.addEventListener("pointerup",vt),window.addEventListener("blur",vt)},b=new WeakSet,Na=function(E){ot._resizerKeyboardManager.exec(this,E)},o=new WeakSet,Oa=function(E){var R;t(this,St)&&((R=E.relatedTarget)==null?void 0:R.parentNode)!==t(this,et)&&v(this,gt,bi).call(this)},x=new WeakSet,Ba=function(E){w(this,Mt,t(this,St)?E:"")},K=new WeakSet,zn=function(E){if(t(this,N))for(const R of t(this,N))R.tabIndex=E},gt=new WeakSet,bi=function(){if(w(this,St,!1),v(this,K,zn).call(this,-1),t(this,wt)){const{savedX:E,savedY:R,savedWidth:Q,savedHeight:W}=t(this,wt);v(this,s,Bn).call(this,E,R,Q,W),w(this,wt,null)}},r(ot,fe),Ae(ot,"_borderLineWidth",-1),Ae(ot,"_colorManager",new c.ColorManager),Ae(ot,"_zIndex",1),Ae(ot,"_telemetryTimeout",1e3);let V=ot;class O extends V{constructor(E){super(E),this.annotationElementId=E.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},61:(le,Wt,ut)=>{var O,k,j,I,Ua,F,Yi,z,Ha,tt,za,N,Vn,M,$,et,wt,Pt,Ct,Nt,Mt,qt,$t,Kt,it,St,Gt,zt,ie,ae,he,ye,jn,fe,ne,re,Re,Yt,Be,te,q,vi,i,yi,l,Va;ut.d(Wt,{FreeOutliner:()=>bt,Outliner:()=>at});var c=ut(292);class at{constructor(u,p=0,b=0,d=!0){r(this,I);r(this,F);r(this,z);r(this,tt);r(this,N);r(this,O,void 0);r(this,k,[]);r(this,j,[]);let o=1/0,h=-1/0,x=1/0,S=-1/0;const K=10**-4;for(const{x:R,y:Q,width:W,height:vt}of u){const J=Math.floor((R-p)/K)*K,y=Math.ceil((R+W+p)/K)*K,P=Math.floor((Q-p)/K)*K,H=Math.ceil((Q+vt+p)/K)*K,ht=[J,P,H,!0],Et=[y,P,H,!1];t(this,k).push(ht,Et),o=Math.min(o,J),h=Math.max(h,y),x=Math.min(x,P),S=Math.max(S,H)}const Y=h-o+2*b,gt=S-x+2*b,mt=o-b,ot=x-b,At=t(this,k).at(d?-1:-2),E=[At[0],At[2]];for(const R of t(this,k)){const[Q,W,vt]=R;R[0]=(Q-mt)/Y,R[1]=(W-ot)/gt,R[2]=(vt-ot)/gt}w(this,O,{x:mt,y:ot,width:Y,height:gt,lastPoint:E})}getOutlines(){t(this,k).sort((p,b)=>p[0]-b[0]||p[1]-b[1]||p[2]-b[2]);const u=[];for(const p of t(this,k))p[3]?(u.push(...v(this,N,Vn).call(this,p)),v(this,z,Ha).call(this,p)):(v(this,tt,za).call(this,p),u.push(...v(this,N,Vn).call(this,p)));return v(this,I,Ua).call(this,u)}}O=new WeakMap,k=new WeakMap,j=new WeakMap,I=new WeakSet,Ua=function(u){const p=[],b=new Set;for(const h of u){const[x,S,K]=h;p.push([x,S,h],[x,K,h])}p.sort((h,x)=>h[1]-x[1]||h[0]-x[0]);for(let h=0,x=p.length;h<x;h+=2){const S=p[h][2],K=p[h+1][2];S.push(K),K.push(S),b.add(S),b.add(K)}const d=[];let o;for(;b.size>0;){const h=b.values().next().value;let[x,S,K,Y,gt]=h;b.delete(h);let mt=x,ot=S;for(o=[x,K],d.push(o);;){let At;if(b.has(Y))At=Y;else if(b.has(gt))At=gt;else break;b.delete(At),[x,S,K,Y,gt]=At,mt!==x&&(o.push(mt,ot,x,ot===S?S:K),mt=x),ot=ot===S?K:S}o.push(mt,ot)}return new nt(d,t(this,O))},F=new WeakSet,Yi=function(u){const p=t(this,j);let b=0,d=p.length-1;for(;b<=d;){const o=b+d>>1,h=p[o][0];if(h===u)return o;h<u?b=o+1:d=o-1}return d+1},z=new WeakSet,Ha=function([,u,p]){const b=v(this,F,Yi).call(this,u);t(this,j).splice(b,0,[u,p])},tt=new WeakSet,za=function([,u,p]){const b=v(this,F,Yi).call(this,u);for(let d=b;d<t(this,j).length;d++){const[o,h]=t(this,j)[d];if(o!==u)break;if(o===u&&h===p){t(this,j).splice(d,1);return}}for(let d=b-1;d>=0;d--){const[o,h]=t(this,j)[d];if(o!==u)break;if(o===u&&h===p){t(this,j).splice(d,1);return}}},N=new WeakSet,Vn=function(u){const[p,b,d]=u,o=[[p,b,d]],h=v(this,F,Yi).call(this,d);for(let x=0;x<h;x++){const[S,K]=t(this,j)[x];for(let Y=0,gt=o.length;Y<gt;Y++){const[,mt,ot]=o[Y];if(!(K<=mt||ot<=S)){if(mt>=S){if(ot>K)o[Y][1]=K;else{if(gt===1)return[];o.splice(Y,1),Y--,gt--}continue}o[Y][2]=S,ot>K&&o.push([p,K,ot])}}}return o};class U{toSVGPath(){throw new Error("Abstract method `toSVGPath` must be implemented.")}get box(){throw new Error("Abstract getter `box` must be implemented.")}serialize(u,p){throw new Error("Abstract method `serialize` must be implemented.")}get free(){return this instanceof V}}class nt extends U{constructor(p,b){super();r(this,M,void 0);r(this,$,void 0);w(this,$,p),w(this,M,b)}toSVGPath(){const p=[];for(const b of t(this,$)){let[d,o]=b;p.push(`M${d} ${o}`);for(let h=2;h<b.length;h+=2){const x=b[h],S=b[h+1];x===d?(p.push(`V${S}`),o=S):S===o&&(p.push(`H${x}`),d=x)}p.push("Z")}return p.join(" ")}serialize([p,b,d,o],h){const x=[],S=d-p,K=o-b;for(const Y of t(this,$)){const gt=new Array(Y.length);for(let mt=0;mt<Y.length;mt+=2)gt[mt]=p+Y[mt]*S,gt[mt+1]=o-Y[mt+1]*K;x.push(gt)}return x}get box(){return t(this,M)}}M=new WeakMap,$=new WeakMap;const ce=class ce{constructor({x:u,y:p},b,d,o,h,x=0){r(this,ye);r(this,et,void 0);r(this,wt,[]);r(this,Pt,void 0);r(this,Ct,void 0);r(this,Nt,[]);r(this,Mt,new Float64Array(18));r(this,qt,void 0);r(this,$t,void 0);r(this,Kt,void 0);r(this,it,void 0);r(this,St,void 0);r(this,Gt,void 0);r(this,zt,[]);w(this,et,b),w(this,Gt,o*d),w(this,Ct,h),t(this,Mt).set([NaN,NaN,NaN,NaN,u,p],6),w(this,Pt,x),w(this,it,t(ce,ie)*d),w(this,Kt,t(ce,he)*d),w(this,St,d),t(this,zt).push(u,p)}get free(){return!0}isEmpty(){return isNaN(t(this,Mt)[8])}add({x:u,y:p}){var ht;w(this,qt,u),w(this,$t,p);const[b,d,o,h]=t(this,et);let[x,S,K,Y]=t(this,Mt).subarray(8,12);const gt=u-K,mt=p-Y,ot=Math.hypot(gt,mt);if(ot<t(this,Kt))return!1;const At=ot-t(this,it),E=At/ot,R=E*gt,Q=E*mt;let W=x,vt=S;x=K,S=Y,K+=R,Y+=Q,(ht=t(this,zt))==null||ht.push(u,p);const J=-Q/At,y=R/At,P=J*t(this,Gt),H=y*t(this,Gt);return t(this,Mt).set(t(this,Mt).subarray(2,8),0),t(this,Mt).set([K+P,Y+H],4),t(this,Mt).set(t(this,Mt).subarray(14,18),12),t(this,Mt).set([K-P,Y-H],16),isNaN(t(this,Mt)[6])?(t(this,Nt).length===0&&(t(this,Mt).set([x+P,S+H],2),t(this,Nt).push(NaN,NaN,NaN,NaN,(x+P-b)/o,(S+H-d)/h),t(this,Mt).set([x-P,S-H],14),t(this,wt).push(NaN,NaN,NaN,NaN,(x-P-b)/o,(S-H-d)/h)),t(this,Mt).set([W,vt,x,S,K,Y],6),!this.isEmpty()):(t(this,Mt).set([W,vt,x,S,K,Y],6),Math.abs(Math.atan2(vt-S,W-x)-Math.atan2(Q,R))<Math.PI/2?([x,S,K,Y]=t(this,Mt).subarray(2,6),t(this,Nt).push(NaN,NaN,NaN,NaN,((x+K)/2-b)/o,((S+Y)/2-d)/h),[x,S,W,vt]=t(this,Mt).subarray(14,18),t(this,wt).push(NaN,NaN,NaN,NaN,((W+x)/2-b)/o,((vt+S)/2-d)/h),!0):([W,vt,x,S,K,Y]=t(this,Mt).subarray(0,6),t(this,Nt).push(((W+5*x)/6-b)/o,((vt+5*S)/6-d)/h,((5*x+K)/6-b)/o,((5*S+Y)/6-d)/h,((x+K)/2-b)/o,((S+Y)/2-d)/h),[K,Y,x,S,W,vt]=t(this,Mt).subarray(12,18),t(this,wt).push(((W+5*x)/6-b)/o,((vt+5*S)/6-d)/h,((5*x+K)/6-b)/o,((5*S+Y)/6-d)/h,((x+K)/2-b)/o,((S+Y)/2-d)/h),!0))}toSVGPath(){if(this.isEmpty())return"";const u=t(this,Nt),p=t(this,wt),b=t(this,Mt).subarray(4,6),d=t(this,Mt).subarray(16,18),[o,h,x,S]=t(this,et),[K,Y,gt,mt]=v(this,ye,jn).call(this);if(isNaN(t(this,Mt)[6])&&!this.isEmpty())return`M${(t(this,Mt)[2]-o)/x} ${(t(this,Mt)[3]-h)/S} L${(t(this,Mt)[4]-o)/x} ${(t(this,Mt)[5]-h)/S} L${K} ${Y} L${gt} ${mt} L${(t(this,Mt)[16]-o)/x} ${(t(this,Mt)[17]-h)/S} L${(t(this,Mt)[14]-o)/x} ${(t(this,Mt)[15]-h)/S} Z`;const ot=[];ot.push(`M${u[4]} ${u[5]}`);for(let At=6;At<u.length;At+=6)isNaN(u[At])?ot.push(`L${u[At+4]} ${u[At+5]}`):ot.push(`C${u[At]} ${u[At+1]} ${u[At+2]} ${u[At+3]} ${u[At+4]} ${u[At+5]}`);ot.push(`L${(b[0]-o)/x} ${(b[1]-h)/S} L${K} ${Y} L${gt} ${mt} L${(d[0]-o)/x} ${(d[1]-h)/S}`);for(let At=p.length-6;At>=6;At-=6)isNaN(p[At])?ot.push(`L${p[At+4]} ${p[At+5]}`):ot.push(`C${p[At]} ${p[At+1]} ${p[At+2]} ${p[At+3]} ${p[At+4]} ${p[At+5]}`);return ot.push(`L${p[4]} ${p[5]} Z`),ot.join(" ")}getOutlines(){var Q;const u=t(this,Nt),p=t(this,wt),b=t(this,Mt),d=b.subarray(4,6),o=b.subarray(16,18),[h,x,S,K]=t(this,et),Y=new Float64Array((((Q=t(this,zt))==null?void 0:Q.length)??0)+2);for(let W=0,vt=Y.length-2;W<vt;W+=2)Y[W]=(t(this,zt)[W]-h)/S,Y[W+1]=(t(this,zt)[W+1]-x)/K;Y[Y.length-2]=(t(this,qt)-h)/S,Y[Y.length-1]=(t(this,$t)-x)/K;const[gt,mt,ot,At]=v(this,ye,jn).call(this);if(isNaN(b[6])&&!this.isEmpty()){const W=new Float64Array(36);return W.set([NaN,NaN,NaN,NaN,(b[2]-h)/S,(b[3]-x)/K,NaN,NaN,NaN,NaN,(b[4]-h)/S,(b[5]-x)/K,NaN,NaN,NaN,NaN,gt,mt,NaN,NaN,NaN,NaN,ot,At,NaN,NaN,NaN,NaN,(b[16]-h)/S,(b[17]-x)/K,NaN,NaN,NaN,NaN,(b[14]-h)/S,(b[15]-x)/K],0),new V(W,Y,t(this,et),t(this,St),t(this,Pt),t(this,Ct))}const E=new Float64Array(t(this,Nt).length+24+t(this,wt).length);let R=u.length;for(let W=0;W<R;W+=2){if(isNaN(u[W])){E[W]=E[W+1]=NaN;continue}E[W]=u[W],E[W+1]=u[W+1]}E.set([NaN,NaN,NaN,NaN,(d[0]-h)/S,(d[1]-x)/K,NaN,NaN,NaN,NaN,gt,mt,NaN,NaN,NaN,NaN,ot,At,NaN,NaN,NaN,NaN,(o[0]-h)/S,(o[1]-x)/K],R),R+=24;for(let W=p.length-6;W>=6;W-=6)for(let vt=0;vt<6;vt+=2){if(isNaN(p[W+vt])){E[R]=E[R+1]=NaN,R+=2;continue}E[R]=p[W+vt],E[R+1]=p[W+vt+1],R+=2}return E.set([NaN,NaN,NaN,NaN,p[4],p[5]],R),new V(E,Y,t(this,et),t(this,St),t(this,Pt),t(this,Ct))}};et=new WeakMap,wt=new WeakMap,Pt=new WeakMap,Ct=new WeakMap,Nt=new WeakMap,Mt=new WeakMap,qt=new WeakMap,$t=new WeakMap,Kt=new WeakMap,it=new WeakMap,St=new WeakMap,Gt=new WeakMap,zt=new WeakMap,ie=new WeakMap,ae=new WeakMap,he=new WeakMap,ye=new WeakSet,jn=function(){const u=t(this,Mt).subarray(4,6),p=t(this,Mt).subarray(16,18),[b,d,o,h]=t(this,et);return[(t(this,qt)+(u[0]-p[0])/2-b)/o,(t(this,$t)+(u[1]-p[1])/2-d)/h,(t(this,qt)+(p[0]-u[0])/2-b)/o,(t(this,$t)+(p[1]-u[1])/2-d)/h]},r(ce,ie,8),r(ce,ae,2),r(ce,he,t(ce,ie)+t(ce,ae));let bt=ce;class V extends U{constructor(p,b,d,o,h,x){super();r(this,q);r(this,i);r(this,l);r(this,fe,void 0);r(this,ne,null);r(this,re,void 0);r(this,Re,void 0);r(this,Yt,void 0);r(this,Be,void 0);r(this,te,void 0);w(this,te,p),w(this,Yt,b),w(this,fe,d),w(this,Be,o),w(this,re,h),w(this,Re,x),v(this,l,Va).call(this,x);const{x:S,y:K,width:Y,height:gt}=t(this,ne);for(let mt=0,ot=p.length;mt<ot;mt+=2)p[mt]=(p[mt]-S)/Y,p[mt+1]=(p[mt+1]-K)/gt;for(let mt=0,ot=b.length;mt<ot;mt+=2)b[mt]=(b[mt]-S)/Y,b[mt+1]=(b[mt+1]-K)/gt}toSVGPath(){const p=[`M${t(this,te)[4]} ${t(this,te)[5]}`];for(let b=6,d=t(this,te).length;b<d;b+=6){if(isNaN(t(this,te)[b])){p.push(`L${t(this,te)[b+4]} ${t(this,te)[b+5]}`);continue}p.push(`C${t(this,te)[b]} ${t(this,te)[b+1]} ${t(this,te)[b+2]} ${t(this,te)[b+3]} ${t(this,te)[b+4]} ${t(this,te)[b+5]}`)}return p.push("Z"),p.join(" ")}serialize([p,b,d,o],h){const x=d-p,S=o-b;let K,Y;switch(h){case 0:K=v(this,q,vi).call(this,t(this,te),p,o,x,-S),Y=v(this,q,vi).call(this,t(this,Yt),p,o,x,-S);break;case 90:K=v(this,i,yi).call(this,t(this,te),p,b,x,S),Y=v(this,i,yi).call(this,t(this,Yt),p,b,x,S);break;case 180:K=v(this,q,vi).call(this,t(this,te),d,b,-x,S),Y=v(this,q,vi).call(this,t(this,Yt),d,b,-x,S);break;case 270:K=v(this,i,yi).call(this,t(this,te),d,o,-x,-S),Y=v(this,i,yi).call(this,t(this,Yt),d,o,-x,-S);break}return{outline:Array.from(K),points:[Array.from(Y)]}}get box(){return t(this,ne)}getNewOutline(p,b){const{x:d,y:o,width:h,height:x}=t(this,ne),[S,K,Y,gt]=t(this,fe),mt=h*Y,ot=x*gt,At=d*Y+S,E=o*gt+K,R=new bt({x:t(this,Yt)[0]*mt+At,y:t(this,Yt)[1]*ot+E},t(this,fe),t(this,Be),p,t(this,Re),b??t(this,re));for(let Q=2;Q<t(this,Yt).length;Q+=2)R.add({x:t(this,Yt)[Q]*mt+At,y:t(this,Yt)[Q+1]*ot+E});return R.getOutlines()}}fe=new WeakMap,ne=new WeakMap,re=new WeakMap,Re=new WeakMap,Yt=new WeakMap,Be=new WeakMap,te=new WeakMap,q=new WeakSet,vi=function(p,b,d,o,h){const x=new Float64Array(p.length);for(let S=0,K=p.length;S<K;S+=2)x[S]=b+p[S]*o,x[S+1]=d+p[S+1]*h;return x},i=new WeakSet,yi=function(p,b,d,o,h){const x=new Float64Array(p.length);for(let S=0,K=p.length;S<K;S+=2)x[S]=b+p[S+1]*o,x[S+1]=d+p[S]*h;return x},l=new WeakSet,Va=function(p){const b=t(this,te);let d=b[4],o=b[5],h=d,x=o,S=d,K=o,Y=d,gt=o;const mt=p?Math.max:Math.min;for(let Q=6,W=b.length;Q<W;Q+=6){if(isNaN(b[Q]))h=Math.min(h,b[Q+4]),x=Math.min(x,b[Q+5]),S=Math.max(S,b[Q+4]),K=Math.max(K,b[Q+5]),gt<b[Q+5]?(Y=b[Q+4],gt=b[Q+5]):gt===b[Q+5]&&(Y=mt(Y,b[Q+4]));else{const vt=c.Util.bezierBoundingBox(d,o,...b.slice(Q,Q+6));h=Math.min(h,vt[0]),x=Math.min(x,vt[1]),S=Math.max(S,vt[2]),K=Math.max(K,vt[3]),gt<vt[3]?(Y=vt[2],gt=vt[3]):gt===vt[3]&&(Y=mt(Y,vt[2]))}d=b[Q+4],o=b[Q+5]}const ot=h-t(this,re),At=x-t(this,re),E=S-h+2*t(this,re),R=K-x+2*t(this,re);w(this,ne,{x:ot,y:At,width:E,height:R,lastPoint:[Y,gt]})}},362:(le,Wt,ut)=>{var nt,bt,V,O,k,ja,I,qa,F,Ga,z,Ji,tt,Wa,N,qn,$,et,wt,Pt,$a,Nt,Xa,qt,Ka;ut.d(Wt,{EditorToolbar:()=>at,HighlightToolbar:()=>U});var c=ut(419);const M=class M{constructor(it){r(this,I);r(this,F);r(this,z);r(this,tt);r(this,N);r(this,nt,null);r(this,bt,null);r(this,V,void 0);r(this,O,null);w(this,V,it)}render(){const it=w(this,nt,document.createElement("div"));it.className="editToolbar",it.setAttribute("role","toolbar"),it.addEventListener("contextmenu",c.noContextMenu),it.addEventListener("pointerdown",v(M,k,ja));const St=w(this,O,document.createElement("div"));St.className="buttons",it.append(St);const Gt=t(this,V).toolbarPosition;if(Gt){const{style:zt}=it,ie=t(this,V)._uiManager.direction==="ltr"?1-Gt[0]:Gt[0];zt.insetInlineEnd=`${100*ie}%`,zt.top=`calc(${100*Gt[1]}% + var(--editor-toolbar-vert-offset))`}return v(this,tt,Wa).call(this),it}hide(){var it;t(this,nt).classList.add("hidden"),(it=t(this,bt))==null||it.hideDropdown()}show(){t(this,nt).classList.remove("hidden")}addAltTextButton(it){v(this,z,Ji).call(this,it),t(this,O).prepend(it,t(this,N,qn))}addColorPicker(it){w(this,bt,it);const St=it.renderButton();v(this,z,Ji).call(this,St),t(this,O).prepend(St,t(this,N,qn))}remove(){var it;t(this,nt).remove(),(it=t(this,bt))==null||it.destroy(),w(this,bt,null)}};nt=new WeakMap,bt=new WeakMap,V=new WeakMap,O=new WeakMap,k=new WeakSet,ja=function(it){it.stopPropagation()},I=new WeakSet,qa=function(it){t(this,V)._focusEventsAllowed=!1,it.preventDefault(),it.stopPropagation()},F=new WeakSet,Ga=function(it){t(this,V)._focusEventsAllowed=!0,it.preventDefault(),it.stopPropagation()},z=new WeakSet,Ji=function(it){it.addEventListener("focusin",v(this,I,qa).bind(this),{capture:!0}),it.addEventListener("focusout",v(this,F,Ga).bind(this),{capture:!0}),it.addEventListener("contextmenu",c.noContextMenu)},tt=new WeakSet,Wa=function(){const it=document.createElement("button");it.className="delete",it.tabIndex=0,it.setAttribute("data-l10n-id",`pdfjs-editor-remove-${t(this,V).editorType}-button`),v(this,z,Ji).call(this,it),it.addEventListener("click",St=>{t(this,V)._uiManager.delete()}),t(this,O).append(it)},N=new WeakSet,qn=function(){const it=document.createElement("div");return it.className="divider",it},r(M,k);let at=M;class U{constructor(it){r(this,Pt);r(this,Nt);r(this,qt);r(this,$,null);r(this,et,null);r(this,wt,void 0);w(this,wt,it)}show(it,St,Gt){const[zt,ie]=v(this,Nt,Xa).call(this,St,Gt),{style:ae}=t(this,et)||w(this,et,v(this,Pt,$a).call(this));it.append(t(this,et)),ae.insetInlineEnd=`${100*zt}%`,ae.top=`calc(${100*ie}% + var(--editor-toolbar-vert-offset))`}hide(){t(this,et).remove()}}$=new WeakMap,et=new WeakMap,wt=new WeakMap,Pt=new WeakSet,$a=function(){const it=w(this,et,document.createElement("div"));it.className="editToolbar",it.setAttribute("role","toolbar"),it.addEventListener("contextmenu",c.noContextMenu);const St=w(this,$,document.createElement("div"));return St.className="buttons",it.append(St),v(this,qt,Ka).call(this),it},Nt=new WeakSet,Xa=function(it,St){let Gt=0,zt=0;for(const ie of it){const ae=ie.y+ie.height;if(ae<Gt)continue;const he=ie.x+(St?ie.width:0);if(ae>Gt){zt=he,Gt=ae;continue}St?he>zt&&(zt=he):he<zt&&(zt=he)}return[St?1-zt:zt,Gt]},qt=new WeakSet,Ka=function(){const it=document.createElement("button");it.className="highlightButton",it.tabIndex=0,it.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const St=document.createElement("span");it.append(St),St.className="visuallyHidden",St.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label"),it.addEventListener("contextmenu",c.noContextMenu),it.addEventListener("click",()=>{t(this,wt).highlightSelection("floating_button")}),t(this,$).append(it)}},830:(le,Wt,ut)=>{var F,D,z,pt,tt,Gn,T,M,$,et,wt,Ya,Nt,Mt,qt,$t,Kt,it,St,Gt,zt,ie,ae,he,ye,Oe,ce,fe,ne,re,Re,Yt,Be,te,q,s,i,a,l,n,g,u,p,b,d,o,h,x,S,K,Y,gt,mt,ot,At,E,R,Q,W,Qi,J,Ja,P,Qa,ht,Zi,Tt,Za,Zt,to,me,eo,de,Wn,we,$n,Le,Xn,m,Kn,B,Yn,st,Je,ft,ws,It,so,Lt,io,Dt,Jn,Xt,no,ge,wi,Ie,Qn;ut.d(Wt,{AnnotationEditorUIManager:()=>C,ColorManager:()=>I,KeyboardManager:()=>j,bindEvents:()=>nt,opacityToHex:()=>bt});var c=ut(292),at=ut(419),U=ut(362);function nt(We,_,rt){for(const Rt of rt)_.addEventListener(Rt,We[Rt].bind(We))}function bt(We){return Math.round(Math.min(255,Math.max(1,255*We))).toString(16).padStart(2,"0")}class V{constructor(){r(this,F,0)}get id(){return`${c.AnnotationEditorPrefix}${ps(this,F)._++}`}}F=new WeakMap;const N=class N{constructor(){r(this,tt);r(this,D,(0,c.getUuid)());r(this,z,0);r(this,pt,null)}static get _isSVGFittingCanvas(){const _='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',rt=new OffscreenCanvas(1,3).getContext("2d"),Rt=new Image;Rt.src=_;const Ot=Rt.decode().then(()=>(rt.drawImage(Rt,0,0,1,1,0,0,1,3),new Uint32Array(rt.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,c.shadow)(this,"_isSVGFittingCanvas",Ot)}async getFromFile(_){const{lastModified:rt,name:Rt,size:Ot,type:Ut}=_;return v(this,tt,Gn).call(this,`${rt}_${Rt}_${Ot}_${Ut}`,_)}async getFromUrl(_){return v(this,tt,Gn).call(this,_,_)}async getFromId(_){t(this,pt)||w(this,pt,new Map);const rt=t(this,pt).get(_);return rt?rt.bitmap?(rt.refCounter+=1,rt):rt.file?this.getFromFile(rt.file):this.getFromUrl(rt.url):null}getSvgUrl(_){const rt=t(this,pt).get(_);return rt!=null&&rt.isSvg?rt.svgUrl:null}deleteId(_){t(this,pt)||w(this,pt,new Map);const rt=t(this,pt).get(_);rt&&(rt.refCounter-=1,rt.refCounter===0&&(rt.bitmap=null))}isValidId(_){return _.startsWith(`image_${t(this,D)}_`)}};D=new WeakMap,z=new WeakMap,pt=new WeakMap,tt=new WeakSet,Gn=async function(_,rt){t(this,pt)||w(this,pt,new Map);let Rt=t(this,pt).get(_);if(Rt===null)return null;if(Rt!=null&&Rt.bitmap)return Rt.refCounter+=1,Rt;try{Rt||(Rt={bitmap:null,id:`image_${t(this,D)}_${ps(this,z)._++}`,refCounter:0,isSvg:!1});let Ot;if(typeof rt=="string"?(Rt.url=rt,Ot=await(0,at.fetchData)(rt,"blob")):Ot=Rt.file=rt,Ot.type==="image/svg+xml"){const Ut=N._isSVGFittingCanvas,Qt=new FileReader,se=new Image,_e=new Promise((xe,Ke)=>{se.onload=()=>{Rt.bitmap=se,Rt.isSvg=!0,xe()},Qt.onload=async()=>{const Ve=Rt.svgUrl=Qt.result;se.src=await Ut?`${Ve}#svgView(preserveAspectRatio(none))`:Ve},se.onerror=Qt.onerror=Ke});Qt.readAsDataURL(Ot),await _e}else Rt.bitmap=await createImageBitmap(Ot);Rt.refCounter=1}catch(Ot){console.error(Ot),Rt=null}return t(this,pt).set(_,Rt),Rt&&t(this,pt).set(Rt.id,Rt),Rt};let O=N;class k{constructor(_=128){r(this,T,[]);r(this,M,!1);r(this,$,void 0);r(this,et,-1);w(this,$,_)}add({cmd:_,undo:rt,post:Rt,mustExec:Ot,type:Ut=NaN,overwriteIfSameType:Qt=!1,keepUndo:se=!1}){if(Ot&&_(),t(this,M))return;const _e={cmd:_,undo:rt,post:Rt,type:Ut};if(t(this,et)===-1){t(this,T).length>0&&(t(this,T).length=0),w(this,et,0),t(this,T).push(_e);return}if(Qt&&t(this,T)[t(this,et)].type===Ut){se&&(_e.undo=t(this,T)[t(this,et)].undo),t(this,T)[t(this,et)]=_e;return}const xe=t(this,et)+1;xe===t(this,$)?t(this,T).splice(0,1):(w(this,et,xe),xe<t(this,T).length&&t(this,T).splice(xe)),t(this,T).push(_e)}undo(){if(t(this,et)===-1)return;w(this,M,!0);const{undo:_,post:rt}=t(this,T)[t(this,et)];_(),rt==null||rt(),w(this,M,!1),w(this,et,t(this,et)-1)}redo(){if(t(this,et)<t(this,T).length-1){w(this,et,t(this,et)+1),w(this,M,!0);const{cmd:_,post:rt}=t(this,T)[t(this,et)];_(),rt==null||rt(),w(this,M,!1)}}hasSomethingToUndo(){return t(this,et)!==-1}hasSomethingToRedo(){return t(this,et)<t(this,T).length-1}destroy(){w(this,T,null)}}T=new WeakMap,M=new WeakMap,$=new WeakMap,et=new WeakMap;class j{constructor(_){r(this,wt);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:rt}=c.FeatureTest.platform;for(const[Rt,Ot,Ut={}]of _)for(const Qt of Rt){const se=Qt.startsWith("mac+");rt&&se?(this.callbacks.set(Qt.slice(4),{callback:Ot,options:Ut}),this.allKeys.add(Qt.split("+").at(-1))):!rt&&!se&&(this.callbacks.set(Qt,{callback:Ot,options:Ut}),this.allKeys.add(Qt.split("+").at(-1)))}}exec(_,rt){if(!this.allKeys.has(rt.key))return;const Rt=this.callbacks.get(v(this,wt,Ya).call(this,rt));if(!Rt)return;const{callback:Ot,options:{bubbles:Ut=!1,args:Qt=[],checker:se=null}}=Rt;se&&!se(_,rt)||(Ot.bind(_,...Qt,rt)(),Ut||(rt.stopPropagation(),rt.preventDefault()))}}wt=new WeakSet,Ya=function(_){_.altKey&&this.buffer.push("alt"),_.ctrlKey&&this.buffer.push("ctrl"),_.metaKey&&this.buffer.push("meta"),_.shiftKey&&this.buffer.push("shift"),this.buffer.push(_.key);const rt=this.buffer.join("+");return this.buffer.length=0,rt};const Ct=class Ct{get _colors(){const _=new Map([["CanvasText",null],["Canvas",null]]);return(0,at.getColorValues)(_),(0,c.shadow)(this,"_colors",_)}convert(_){const rt=(0,at.getRGB)(_);if(!window.matchMedia("(forced-colors: active)").matches)return rt;for(const[Rt,Ot]of this._colors)if(Ot.every((Ut,Qt)=>Ut===rt[Qt]))return Ct._colorsMapping.get(Rt);return rt}getHexCode(_){const rt=this._colors.get(_);return rt?c.Util.makeHexColor(...rt):_}};Ae(Ct,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let I=Ct;const qe=class qe{constructor(_,rt,Rt,Ot,Ut,Qt,se,_e,xe){r(this,W);r(this,J);r(this,P);r(this,ht);r(this,Tt);r(this,Zt);r(this,me);r(this,de);r(this,we);r(this,Le);r(this,m);r(this,B);r(this,st);r(this,ft);r(this,It);r(this,Lt);r(this,Dt);r(this,Xt);r(this,ge);r(this,Ie);r(this,Nt,null);r(this,Mt,new Map);r(this,qt,new Map);r(this,$t,null);r(this,Kt,null);r(this,it,null);r(this,St,new k);r(this,Gt,0);r(this,zt,new Set);r(this,ie,null);r(this,ae,null);r(this,he,new Set);r(this,ye,!1);r(this,Oe,null);r(this,ce,null);r(this,fe,null);r(this,ne,!1);r(this,re,null);r(this,Re,new V);r(this,Yt,!1);r(this,Be,!1);r(this,te,null);r(this,q,null);r(this,s,null);r(this,i,c.AnnotationEditorType.NONE);r(this,a,new Set);r(this,l,null);r(this,n,null);r(this,g,null);r(this,u,this.blur.bind(this));r(this,p,this.focus.bind(this));r(this,b,this.copy.bind(this));r(this,d,this.cut.bind(this));r(this,o,this.paste.bind(this));r(this,h,this.keydown.bind(this));r(this,x,this.keyup.bind(this));r(this,S,this.onEditingAction.bind(this));r(this,K,this.onPageChanging.bind(this));r(this,Y,this.onScaleChanging.bind(this));r(this,gt,v(this,P,Qa).bind(this));r(this,mt,this.onRotationChanging.bind(this));r(this,ot,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});r(this,At,[0,0]);r(this,E,null);r(this,R,null);r(this,Q,null);w(this,R,_),w(this,Q,rt),w(this,$t,Rt),this._eventBus=Ot,this._eventBus._on("editingaction",t(this,S)),this._eventBus._on("pagechanging",t(this,K)),this._eventBus._on("scalechanging",t(this,Y)),this._eventBus._on("rotationchanging",t(this,mt)),v(this,Tt,Za).call(this),v(this,we,$n).call(this),w(this,Kt,Ut.annotationStorage),w(this,Oe,Ut.filterFactory),w(this,n,Qt),w(this,fe,se||null),w(this,ye,_e),w(this,s,xe||null),this.viewParameters={realScale:at.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1}static get _keyboardManager(){const _=qe.prototype,rt=Qt=>t(Qt,R).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&Qt.hasSomethingToControl(),Rt=(Qt,{target:se})=>{if(se instanceof HTMLInputElement){const{type:_e}=se;return _e!=="text"&&_e!=="number"}return!0},Ot=this.TRANSLATE_SMALL,Ut=this.TRANSLATE_BIG;return(0,c.shadow)(this,"_keyboardManager",new j([[["ctrl+a","mac+meta+a"],_.selectAll,{checker:Rt}],[["ctrl+z","mac+meta+z"],_.undo,{checker:Rt}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],_.redo,{checker:Rt}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],_.delete,{checker:Rt}],[["Enter","mac+Enter"],_.addNewEditorFromKeyboard,{checker:(Qt,{target:se})=>!(se instanceof HTMLButtonElement)&&t(Qt,R).contains(se)&&!Qt.isEnterHandled}],[[" ","mac+ "],_.addNewEditorFromKeyboard,{checker:(Qt,{target:se})=>!(se instanceof HTMLButtonElement)&&t(Qt,R).contains(document.activeElement)}],[["Escape","mac+Escape"],_.unselectAll],[["ArrowLeft","mac+ArrowLeft"],_.translateSelectedEditors,{args:[-Ot,0],checker:rt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],_.translateSelectedEditors,{args:[-Ut,0],checker:rt}],[["ArrowRight","mac+ArrowRight"],_.translateSelectedEditors,{args:[Ot,0],checker:rt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],_.translateSelectedEditors,{args:[Ut,0],checker:rt}],[["ArrowUp","mac+ArrowUp"],_.translateSelectedEditors,{args:[0,-Ot],checker:rt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],_.translateSelectedEditors,{args:[0,-Ut],checker:rt}],[["ArrowDown","mac+ArrowDown"],_.translateSelectedEditors,{args:[0,Ot],checker:rt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],_.translateSelectedEditors,{args:[0,Ut],checker:rt}]]))}destroy(){var _,rt;v(this,Le,Xn).call(this),v(this,de,Wn).call(this),this._eventBus._off("editingaction",t(this,S)),this._eventBus._off("pagechanging",t(this,K)),this._eventBus._off("scalechanging",t(this,Y)),this._eventBus._off("rotationchanging",t(this,mt));for(const Rt of t(this,qt).values())Rt.destroy();t(this,qt).clear(),t(this,Mt).clear(),t(this,he).clear(),w(this,Nt,null),t(this,a).clear(),t(this,St).destroy(),(_=t(this,$t))==null||_.destroy(),(rt=t(this,re))==null||rt.hide(),w(this,re,null),t(this,ce)&&(clearTimeout(t(this,ce)),w(this,ce,null)),t(this,E)&&(clearTimeout(t(this,E)),w(this,E,null)),v(this,Zt,to).call(this)}async mlGuess(_){var rt;return((rt=t(this,s))==null?void 0:rt.guess(_))||null}get hasMLManager(){return!!t(this,s)}get hcmFilter(){return(0,c.shadow)(this,"hcmFilter",t(this,n)?t(this,Oe).addHCMFilter(t(this,n).foreground,t(this,n).background):"none")}get direction(){return(0,c.shadow)(this,"direction",getComputedStyle(t(this,R)).direction)}get highlightColors(){return(0,c.shadow)(this,"highlightColors",t(this,fe)?new Map(t(this,fe).split(",").map(_=>_.split("=").map(rt=>rt.trim()))):null)}get highlightColorNames(){return(0,c.shadow)(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,_=>_.reverse())):null)}setMainHighlightColorPicker(_){w(this,q,_)}editAltText(_){var rt;(rt=t(this,$t))==null||rt.editAltText(this,_)}onPageChanging({pageNumber:_}){w(this,Gt,_-1)}focusMainContainer(){t(this,R).focus()}findParent(_,rt){for(const Rt of t(this,qt).values()){const{x:Ot,y:Ut,width:Qt,height:se}=Rt.div.getBoundingClientRect();if(_>=Ot&&_<=Ot+Qt&&rt>=Ut&&rt<=Ut+se)return Rt}return null}disableUserSelect(_=!1){t(this,Q).classList.toggle("noUserSelect",_)}addShouldRescale(_){t(this,he).add(_)}removeShouldRescale(_){t(this,he).delete(_)}onScaleChanging({scale:_}){this.commitOrRemove(),this.viewParameters.realScale=_*at.PixelsPerInch.PDF_TO_CSS_UNITS;for(const rt of t(this,he))rt.onScaleChanging()}onRotationChanging({pagesRotation:_}){this.commitOrRemove(),this.viewParameters.rotation=_}highlightSelection(_=""){const rt=document.getSelection();if(!rt||rt.isCollapsed)return;const{anchorNode:Rt,anchorOffset:Ot,focusNode:Ut,focusOffset:Qt}=rt,se=rt.toString(),_e=v(this,W,Qi).call(this,rt).closest(".textLayer"),xe=this.getSelectionBoxes(_e);if(xe){rt.empty(),t(this,i)===c.AnnotationEditorType.NONE&&(this._eventBus.dispatch("showannotationeditorui",{source:this,mode:c.AnnotationEditorType.HIGHLIGHT}),this.showAllEditors("highlight",!0,!0));for(const Ke of t(this,qt).values())if(Ke.hasTextLayer(_e)){Ke.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:_,boxes:xe,anchorNode:Rt,anchorOffset:Ot,focusNode:Ut,focusOffset:Qt,text:se});break}}}addToAnnotationStorage(_){!_.isEmpty()&&t(this,Kt)&&!t(this,Kt).has(_.id)&&t(this,Kt).setValue(_.id,_)}blur(){if(this.isShiftKeyDown=!1,t(this,ne)&&(w(this,ne,!1),v(this,ht,Zi).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:_}=document;for(const rt of t(this,a))if(rt.div.contains(_)){w(this,te,[rt,_]),rt._focusEventsAllowed=!1;break}}focus(){if(!t(this,te))return;const[_,rt]=t(this,te);w(this,te,null),rt.addEventListener("focusin",()=>{_._focusEventsAllowed=!0},{once:!0}),rt.focus()}addEditListeners(){v(this,we,$n).call(this),v(this,m,Kn).call(this)}removeEditListeners(){v(this,Le,Xn).call(this),v(this,B,Yn).call(this)}copy(_){var Rt;if(_.preventDefault(),(Rt=t(this,Nt))==null||Rt.commitOrRemove(),!this.hasSelection)return;const rt=[];for(const Ot of t(this,a)){const Ut=Ot.serialize(!0);Ut&&rt.push(Ut)}rt.length!==0&&_.clipboardData.setData("application/pdfjs",JSON.stringify(rt))}cut(_){this.copy(_),this.delete()}paste(_){_.preventDefault();const{clipboardData:rt}=_;for(const Ut of rt.items)for(const Qt of t(this,ae))if(Qt.isHandlingMimeForPasting(Ut.type)){Qt.paste(Ut,this.currentLayer);return}let Rt=rt.getData("application/pdfjs");if(!Rt)return;try{Rt=JSON.parse(Rt)}catch(Ut){(0,c.warn)(`paste: "${Ut.message}".`);return}if(!Array.isArray(Rt))return;this.unselectAll();const Ot=this.currentLayer;try{const Ut=[];for(const _e of Rt){const xe=Ot.deserialize(_e);if(!xe)return;Ut.push(xe)}const Qt=()=>{for(const _e of Ut)v(this,Dt,Jn).call(this,_e);v(this,Ie,Qn).call(this,Ut)},se=()=>{for(const _e of Ut)_e.remove()};this.addCommands({cmd:Qt,undo:se,mustExec:!0})}catch(Ut){(0,c.warn)(`paste: "${Ut.message}".`)}}keydown(_){!this.isShiftKeyDown&&_.key==="Shift"&&(this.isShiftKeyDown=!0),t(this,i)!==c.AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&qe._keyboardManager.exec(this,_)}keyup(_){this.isShiftKeyDown&&_.key==="Shift"&&(this.isShiftKeyDown=!1,t(this,ne)&&(w(this,ne,!1),v(this,ht,Zi).call(this,"main_toolbar")))}onEditingAction({name:_}){switch(_){case"undo":case"redo":case"delete":case"selectAll":this[_]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(_){_?(v(this,me,eo).call(this),v(this,m,Kn).call(this),v(this,st,Je).call(this,{isEditing:t(this,i)!==c.AnnotationEditorType.NONE,isEmpty:v(this,ge,wi).call(this),hasSomethingToUndo:t(this,St).hasSomethingToUndo(),hasSomethingToRedo:t(this,St).hasSomethingToRedo(),hasSelectedEditor:!1})):(v(this,de,Wn).call(this),v(this,B,Yn).call(this),v(this,st,Je).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(_){if(!t(this,ae)){w(this,ae,_);for(const rt of t(this,ae))v(this,ft,ws).call(this,rt.defaultPropertiesToUpdate)}}getId(){return t(this,Re).id}get currentLayer(){return t(this,qt).get(t(this,Gt))}getLayer(_){return t(this,qt).get(_)}get currentPageIndex(){return t(this,Gt)}addLayer(_){t(this,qt).set(_.pageIndex,_),t(this,Yt)?_.enable():_.disable()}removeLayer(_){t(this,qt).delete(_.pageIndex)}updateMode(_,rt=null,Rt=!1){if(t(this,i)!==_){if(w(this,i,_),_===c.AnnotationEditorType.NONE){this.setEditingState(!1),v(this,Lt,io).call(this);return}this.setEditingState(!0),v(this,It,so).call(this),this.unselectAll();for(const Ot of t(this,qt).values())Ot.updateMode(_);if(!rt&&Rt){this.addNewEditorFromKeyboard();return}if(rt){for(const Ot of t(this,Mt).values())if(Ot.annotationElementId===rt){this.setSelected(Ot),Ot.enterInEditMode();break}}}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(_){_!==t(this,i)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:_})}updateParams(_,rt){var Rt;if(t(this,ae)){switch(_){case c.AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor();return;case c.AnnotationEditorParamsType.HIGHLIGHT_DEFAULT_COLOR:(Rt=t(this,q))==null||Rt.updateColor(rt);break;case c.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(t(this,g)||w(this,g,new Map)).set(_,rt),this.showAllEditors("highlight",rt);break}for(const Ot of t(this,a))Ot.updateParams(_,rt);for(const Ot of t(this,ae))Ot.updateDefaultParams(_,rt)}}showAllEditors(_,rt,Rt=!1){var Ot;for(const Ut of t(this,Mt).values())Ut.editorType===_&&Ut.show(rt);(((Ot=t(this,g))==null?void 0:Ot.get(c.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL))??!0)!==rt&&v(this,ft,ws).call(this,[[c.AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,rt]])}enableWaiting(_=!1){if(t(this,Be)!==_){w(this,Be,_);for(const rt of t(this,qt).values())_?rt.disableClick():rt.enableClick(),rt.div.classList.toggle("waiting",_)}}getEditors(_){const rt=[];for(const Rt of t(this,Mt).values())Rt.pageIndex===_&&rt.push(Rt);return rt}getEditor(_){return t(this,Mt).get(_)}addEditor(_){t(this,Mt).set(_.id,_)}removeEditor(_){var rt;_.div.contains(document.activeElement)&&(t(this,ce)&&clearTimeout(t(this,ce)),w(this,ce,setTimeout(()=>{this.focusMainContainer(),w(this,ce,null)},0))),t(this,Mt).delete(_.id),this.unselect(_),(!_.annotationElementId||!t(this,zt).has(_.annotationElementId))&&((rt=t(this,Kt))==null||rt.remove(_.id))}addDeletedAnnotationElement(_){t(this,zt).add(_.annotationElementId),this.addChangedExistingAnnotation(_),_.deleted=!0}isDeletedAnnotationElement(_){return t(this,zt).has(_)}removeDeletedAnnotationElement(_){t(this,zt).delete(_.annotationElementId),this.removeChangedExistingAnnotation(_),_.deleted=!1}setActiveEditor(_){t(this,Nt)!==_&&(w(this,Nt,_),_&&v(this,ft,ws).call(this,_.propertiesToUpdate))}updateUI(_){t(this,Xt,no)===_&&v(this,ft,ws).call(this,_.propertiesToUpdate)}toggleSelected(_){if(t(this,a).has(_)){t(this,a).delete(_),_.unselect(),v(this,st,Je).call(this,{hasSelectedEditor:this.hasSelection});return}t(this,a).add(_),_.select(),v(this,ft,ws).call(this,_.propertiesToUpdate),v(this,st,Je).call(this,{hasSelectedEditor:!0})}setSelected(_){for(const rt of t(this,a))rt!==_&&rt.unselect();t(this,a).clear(),t(this,a).add(_),_.select(),v(this,ft,ws).call(this,_.propertiesToUpdate),v(this,st,Je).call(this,{hasSelectedEditor:!0})}isSelected(_){return t(this,a).has(_)}get firstSelectedEditor(){return t(this,a).values().next().value}unselect(_){_.unselect(),t(this,a).delete(_),v(this,st,Je).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return t(this,a).size!==0}get isEnterHandled(){return t(this,a).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){t(this,St).undo(),v(this,st,Je).call(this,{hasSomethingToUndo:t(this,St).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:v(this,ge,wi).call(this)})}redo(){t(this,St).redo(),v(this,st,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:t(this,St).hasSomethingToRedo(),isEmpty:v(this,ge,wi).call(this)})}addCommands(_){t(this,St).add(_),v(this,st,Je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:v(this,ge,wi).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const _=[...t(this,a)],rt=()=>{for(const Ot of _)Ot.remove()},Rt=()=>{for(const Ot of _)v(this,Dt,Jn).call(this,Ot)};this.addCommands({cmd:rt,undo:Rt,mustExec:!0})}commitOrRemove(){var _;(_=t(this,Nt))==null||_.commitOrRemove()}hasSomethingToControl(){return t(this,Nt)||this.hasSelection}selectAll(){for(const _ of t(this,a))_.commit();v(this,Ie,Qn).call(this,t(this,Mt).values())}unselectAll(){if(!(t(this,Nt)&&(t(this,Nt).commitOrRemove(),t(this,i)!==c.AnnotationEditorType.NONE))&&this.hasSelection){for(const _ of t(this,a))_.unselect();t(this,a).clear(),v(this,st,Je).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(_,rt,Rt=!1){if(Rt||this.commitOrRemove(),!this.hasSelection)return;t(this,At)[0]+=_,t(this,At)[1]+=rt;const[Ot,Ut]=t(this,At),Qt=[...t(this,a)];t(this,E)&&clearTimeout(t(this,E)),w(this,E,setTimeout(()=>{w(this,E,null),t(this,At)[0]=t(this,At)[1]=0,this.addCommands({cmd:()=>{for(const _e of Qt)t(this,Mt).has(_e.id)&&_e.translateInPage(Ot,Ut)},undo:()=>{for(const _e of Qt)t(this,Mt).has(_e.id)&&_e.translateInPage(-Ot,-Ut)},mustExec:!1})},1e3));for(const _e of Qt)_e.translateInPage(_,rt)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,ie,new Map);for(const _ of t(this,a))t(this,ie).set(_,{savedX:_.x,savedY:_.y,savedPageIndex:_.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!t(this,ie))return!1;this.disableUserSelect(!1);const _=t(this,ie);w(this,ie,null);let rt=!1;for(const[{x:Ot,y:Ut,pageIndex:Qt},se]of _)se.newX=Ot,se.newY=Ut,se.newPageIndex=Qt,rt||(rt=Ot!==se.savedX||Ut!==se.savedY||Qt!==se.savedPageIndex);if(!rt)return!1;const Rt=(Ot,Ut,Qt,se)=>{if(t(this,Mt).has(Ot.id)){const _e=t(this,qt).get(se);_e?Ot._setParentAndPosition(_e,Ut,Qt):(Ot.pageIndex=se,Ot.x=Ut,Ot.y=Qt)}};return this.addCommands({cmd:()=>{for(const[Ot,{newX:Ut,newY:Qt,newPageIndex:se}]of _)Rt(Ot,Ut,Qt,se)},undo:()=>{for(const[Ot,{savedX:Ut,savedY:Qt,savedPageIndex:se}]of _)Rt(Ot,Ut,Qt,se)},mustExec:!0}),!0}dragSelectedEditors(_,rt){if(t(this,ie))for(const Rt of t(this,ie).keys())Rt.drag(_,rt)}rebuild(_){if(_.parent===null){const rt=this.getLayer(_.pageIndex);rt?(rt.changeParent(_),rt.addOrRebuild(_)):(this.addEditor(_),this.addToAnnotationStorage(_),_.rebuild())}else _.parent.addOrRebuild(_)}get isEditorHandlingKeyboard(){var _;return((_=this.getActive())==null?void 0:_.shouldGetKeyboardEvents())||t(this,a).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(_){return t(this,Nt)===_}getActive(){return t(this,Nt)}getMode(){return t(this,i)}get imageManager(){return(0,c.shadow)(this,"imageManager",new O)}getSelectionBoxes(_){if(!_)return null;const rt=document.getSelection();for(let xe=0,Ke=rt.rangeCount;xe<Ke;xe++)if(!_.contains(rt.getRangeAt(xe).commonAncestorContainer))return null;const{x:Rt,y:Ot,width:Ut,height:Qt}=_.getBoundingClientRect();let se;switch(_.getAttribute("data-main-rotation")){case"90":se=(xe,Ke,Ve,Ze)=>({x:(Ke-Ot)/Qt,y:1-(xe+Ve-Rt)/Ut,width:Ze/Qt,height:Ve/Ut});break;case"180":se=(xe,Ke,Ve,Ze)=>({x:1-(xe+Ve-Rt)/Ut,y:1-(Ke+Ze-Ot)/Qt,width:Ve/Ut,height:Ze/Qt});break;case"270":se=(xe,Ke,Ve,Ze)=>({x:1-(Ke+Ze-Ot)/Qt,y:(xe-Rt)/Ut,width:Ze/Qt,height:Ve/Ut});break;default:se=(xe,Ke,Ve,Ze)=>({x:(xe-Rt)/Ut,y:(Ke-Ot)/Qt,width:Ve/Ut,height:Ze/Qt});break}const _e=[];for(let xe=0,Ke=rt.rangeCount;xe<Ke;xe++){const Ve=rt.getRangeAt(xe);if(!Ve.collapsed)for(const{x:Ze,y:Ps,width:er,height:Es}of Ve.getClientRects())er===0||Es===0||_e.push(se(Ze,Ps,er,Es))}return _e.length===0?null:_e}addChangedExistingAnnotation({annotationElementId:_,id:rt}){(t(this,it)||w(this,it,new Map)).set(_,rt)}removeChangedExistingAnnotation({annotationElementId:_}){var rt;(rt=t(this,it))==null||rt.delete(_)}renderAnnotationElement(_){var Ot;const rt=(Ot=t(this,it))==null?void 0:Ot.get(_.data.id);if(!rt)return;const Rt=t(this,Kt).getRawValue(rt);Rt&&(t(this,i)===c.AnnotationEditorType.NONE&&!Rt.hasBeenModified||Rt.renderAnnotationElement(_))}};Nt=new WeakMap,Mt=new WeakMap,qt=new WeakMap,$t=new WeakMap,Kt=new WeakMap,it=new WeakMap,St=new WeakMap,Gt=new WeakMap,zt=new WeakMap,ie=new WeakMap,ae=new WeakMap,he=new WeakMap,ye=new WeakMap,Oe=new WeakMap,ce=new WeakMap,fe=new WeakMap,ne=new WeakMap,re=new WeakMap,Re=new WeakMap,Yt=new WeakMap,Be=new WeakMap,te=new WeakMap,q=new WeakMap,s=new WeakMap,i=new WeakMap,a=new WeakMap,l=new WeakMap,n=new WeakMap,g=new WeakMap,u=new WeakMap,p=new WeakMap,b=new WeakMap,d=new WeakMap,o=new WeakMap,h=new WeakMap,x=new WeakMap,S=new WeakMap,K=new WeakMap,Y=new WeakMap,gt=new WeakMap,mt=new WeakMap,ot=new WeakMap,At=new WeakMap,E=new WeakMap,R=new WeakMap,Q=new WeakMap,W=new WeakSet,Qi=function({anchorNode:_}){return _.nodeType===Node.TEXT_NODE?_.parentElement:_},J=new WeakSet,Ja=function(){const _=document.getSelection();if(!_||_.isCollapsed)return;const rt=v(this,W,Qi).call(this,_).closest(".textLayer"),Rt=this.getSelectionBoxes(rt);Rt&&(t(this,re)||w(this,re,new U.HighlightToolbar(this)),t(this,re).show(rt,Rt,this.direction==="ltr"))},P=new WeakSet,Qa=function(){var Rt,Ot,Ut;const _=document.getSelection();if(!_||_.isCollapsed){t(this,l)&&((Rt=t(this,re))==null||Rt.hide(),w(this,l,null),v(this,st,Je).call(this,{hasSelectedText:!1}));return}const{anchorNode:rt}=_;if(rt!==t(this,l)){if(!v(this,W,Qi).call(this,_).closest(".textLayer")){t(this,l)&&((Ot=t(this,re))==null||Ot.hide(),w(this,l,null),v(this,st,Je).call(this,{hasSelectedText:!1}));return}if((Ut=t(this,re))==null||Ut.hide(),w(this,l,rt),v(this,st,Je).call(this,{hasSelectedText:!0}),!(t(this,i)!==c.AnnotationEditorType.HIGHLIGHT&&t(this,i)!==c.AnnotationEditorType.NONE)&&(t(this,i)===c.AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,ne,this.isShiftKeyDown),!this.isShiftKeyDown)){const Qt=se=>{se.type==="pointerup"&&se.button!==0||(window.removeEventListener("pointerup",Qt),window.removeEventListener("blur",Qt),se.type==="pointerup"&&v(this,ht,Zi).call(this,"main_toolbar"))};window.addEventListener("pointerup",Qt),window.addEventListener("blur",Qt)}}},ht=new WeakSet,Zi=function(_=""){t(this,i)===c.AnnotationEditorType.HIGHLIGHT?this.highlightSelection(_):t(this,ye)&&v(this,J,Ja).call(this)},Tt=new WeakSet,Za=function(){document.addEventListener("selectionchange",t(this,gt))},Zt=new WeakSet,to=function(){document.removeEventListener("selectionchange",t(this,gt))},me=new WeakSet,eo=function(){window.addEventListener("focus",t(this,p)),window.addEventListener("blur",t(this,u))},de=new WeakSet,Wn=function(){window.removeEventListener("focus",t(this,p)),window.removeEventListener("blur",t(this,u))},we=new WeakSet,$n=function(){window.addEventListener("keydown",t(this,h)),window.addEventListener("keyup",t(this,x))},Le=new WeakSet,Xn=function(){window.removeEventListener("keydown",t(this,h)),window.removeEventListener("keyup",t(this,x))},m=new WeakSet,Kn=function(){document.addEventListener("copy",t(this,b)),document.addEventListener("cut",t(this,d)),document.addEventListener("paste",t(this,o))},B=new WeakSet,Yn=function(){document.removeEventListener("copy",t(this,b)),document.removeEventListener("cut",t(this,d)),document.removeEventListener("paste",t(this,o))},st=new WeakSet,Je=function(_){Object.entries(_).some(([rt,Rt])=>t(this,ot)[rt]!==Rt)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(t(this,ot),_)}),t(this,i)===c.AnnotationEditorType.HIGHLIGHT&&_.hasSelectedEditor===!1&&v(this,ft,ws).call(this,[[c.AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))},ft=new WeakSet,ws=function(_){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:_})},It=new WeakSet,so=function(){if(!t(this,Yt)){w(this,Yt,!0);for(const _ of t(this,qt).values())_.enable();for(const _ of t(this,Mt).values())_.enable()}},Lt=new WeakSet,io=function(){if(this.unselectAll(),t(this,Yt)){w(this,Yt,!1);for(const _ of t(this,qt).values())_.disable();for(const _ of t(this,Mt).values())_.disable()}},Dt=new WeakSet,Jn=function(_){const rt=t(this,qt).get(_.pageIndex);rt?rt.addOrRebuild(_):(this.addEditor(_),this.addToAnnotationStorage(_))},Xt=new WeakSet,no=function(){let _=null;for(_ of t(this,a));return _},ge=new WeakSet,wi=function(){if(t(this,Mt).size===0)return!0;if(t(this,Mt).size===1)for(const _ of t(this,Mt).values())return _.isEmpty();return!1},Ie=new WeakSet,Qn=function(_){for(const rt of t(this,a))rt.unselect();t(this,a).clear();for(const rt of _)rt.isEmpty()||(t(this,a).add(rt),rt.select());v(this,st,Je).call(this,{hasSelectedEditor:this.hasSelection})},Ae(qe,"TRANSLATE_SMALL",1),Ae(qe,"TRANSLATE_BIG",10);let C=qe},94:(le,Wt,ut)=>{ut.d(Wt,{PDFFetchStream:()=>V});var c=ut(292),at=ut(490);function U(j,I,C){return{method:"GET",headers:j,signal:C.signal,mode:"cors",credentials:I?"include":"same-origin",redirect:"follow"}}function nt(j){const I=new Headers;for(const C in j){const F=j[C];F!==void 0&&I.append(C,F)}return I}function bt(j){return j instanceof Uint8Array?j.buffer:j instanceof ArrayBuffer?j:((0,c.warn)(`getArrayBuffer - unexpected data format: ${j}`),new Uint8Array(j).buffer)}class V{constructor(I){this.source=I,this.isHttp=/^https?:/i.test(I.url),this.httpHeaders=this.isHttp&&I.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var I;return((I=this._fullRequestReader)==null?void 0:I._loaded)??0}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new O(this),this._fullRequestReader}getRangeReader(I,C){if(C<=this._progressiveDataLength)return null;const F=new k(this,I,C);return this._rangeRequestReaders.push(F),F}cancelAllRequests(I){var C;(C=this._fullRequestReader)==null||C.cancel(I);for(const F of this._rangeRequestReaders.slice(0))F.cancel(I)}}class O{constructor(I){this._stream=I,this._reader=null,this._loaded=0,this._filename=null;const C=I.source;this._withCredentials=C.withCredentials||!1,this._contentLength=C.length,this._headersCapability=Promise.withResolvers(),this._disableRange=C.disableRange||!1,this._rangeChunkSize=C.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!C.disableStream,this._isRangeSupported=!C.disableRange,this._headers=nt(this._stream.httpHeaders);const F=C.url;fetch(F,U(this._headers,this._withCredentials,this._abortController)).then(D=>{if(!(0,at.validateResponseStatus)(D.status))throw(0,at.createResponseStatusError)(D.status,F);this._reader=D.body.getReader(),this._headersCapability.resolve();const z=L=>D.headers.get(L),{allowRangeRequests:pt,suggestedLength:tt}=(0,at.validateRangeRequestCapabilities)({getResponseHeader:z,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=pt,this._contentLength=tt||this._contentLength,this._filename=(0,at.extractFilenameFromHeader)(z),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new c.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._headersCapability.promise;const{value:I,done:C}=await this._reader.read();return C?{value:I,done:C}:(this._loaded+=I.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded,total:this._contentLength}),{value:bt(I),done:!1})}cancel(I){var C;(C=this._reader)==null||C.cancel(I),this._abortController.abort()}}class k{constructor(I,C,F){this._stream=I,this._reader=null,this._loaded=0;const D=I.source;this._withCredentials=D.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!D.disableStream,this._abortController=new AbortController,this._headers=nt(this._stream.httpHeaders),this._headers.append("Range",`bytes=${C}-${F-1}`);const z=D.url;fetch(z,U(this._headers,this._withCredentials,this._abortController)).then(pt=>{if(!(0,at.validateResponseStatus)(pt.status))throw(0,at.createResponseStatusError)(pt.status,z);this._readCapability.resolve(),this._reader=pt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var F;await this._readCapability.promise;const{value:I,done:C}=await this._reader.read();return C?{value:I,done:C}:(this._loaded+=I.byteLength,(F=this.onProgress)==null||F.call(this,{loaded:this._loaded}),{value:bt(I),done:!1})}cancel(I){var C;(C=this._reader)==null||C.cancel(I),this._abortController.abort()}}},10:(le,Wt,ut)=>{var nt;ut.d(Wt,{FontFaceObject:()=>U,FontLoader:()=>at});var c=ut(292);class at{constructor({ownerDocument:V=globalThis.document,styleElement:O=null}){r(this,nt,new Set);this._document=V,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(V){this.nativeFontFaces.add(V),this._document.fonts.add(V)}removeNativeFontFace(V){this.nativeFontFaces.delete(V),this._document.fonts.delete(V)}insertRule(V){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const O=this.styleElement.sheet;O.insertRule(V,O.cssRules.length)}clear(){for(const V of this.nativeFontFaces)this._document.fonts.delete(V);this.nativeFontFaces.clear(),t(this,nt).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:V,_inspectFont:O}){if(!(!V||t(this,nt).has(V.loadedName))){if((0,c.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:k,src:j,style:I}=V,C=new FontFace(k,j,I);this.addNativeFontFace(C);try{await C.load(),t(this,nt).add(k),O==null||O(V)}catch{(0,c.warn)(`Cannot load system font: ${V.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(C)}return}(0,c.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(V){if(V.attached||V.missingFile&&!V.systemFontInfo)return;if(V.attached=!0,V.systemFontInfo){await this.loadSystemFont(V);return}if(this.isFontLoadingAPISupported){const k=V.createNativeFontFace();if(k){this.addNativeFontFace(k);try{await k.loaded}catch(j){throw(0,c.warn)(`Failed to load font '${k.family}': '${j}'.`),V.disableFontFace=!0,j}}return}const O=V.createFontFaceRule();if(O){if(this.insertRule(O),this.isSyncFontLoadingSupported)return;await new Promise(k=>{const j=this._queueLoadingCallback(k);this._prepareFontLoadEvent(V,j)})}}get isFontLoadingAPISupported(){var O;const V=!!((O=this._document)!=null&&O.fonts);return(0,c.shadow)(this,"isFontLoadingAPISupported",V)}get isSyncFontLoadingSupported(){let V=!1;return(c.isNodeJS||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(V=!0),(0,c.shadow)(this,"isSyncFontLoadingSupported",V)}_queueLoadingCallback(V){function O(){for((0,c.assert)(!j.done,"completeRequest() cannot be called twice."),j.done=!0;k.length>0&&k[0].done;){const I=k.shift();setTimeout(I.callback,0)}}const{loadingRequests:k}=this,j={done:!1,complete:O,callback:V};return k.push(j),j}get _loadTestFont(){const V=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,c.shadow)(this,"_loadTestFont",V)}_prepareFontLoadEvent(V,O){function k(Pt,Ct){return Pt.charCodeAt(Ct)<<24|Pt.charCodeAt(Ct+1)<<16|Pt.charCodeAt(Ct+2)<<8|Pt.charCodeAt(Ct+3)&255}function j(Pt,Ct,Nt,Mt){const qt=Pt.substring(0,Ct),$t=Pt.substring(Ct+Nt);return qt+Mt+$t}let I,C;const F=this._document.createElement("canvas");F.width=1,F.height=1;const D=F.getContext("2d");let z=0;function pt(Pt,Ct){if(++z>30){(0,c.warn)("Load test font never loaded."),Ct();return}if(D.font="30px "+Pt,D.fillText(".",0,20),D.getImageData(0,0,1,1).data[3]>0){Ct();return}setTimeout(pt.bind(null,Pt,Ct))}const tt=`lt${Date.now()}${this.loadTestFontId++}`;let L=this._loadTestFont;L=j(L,976,tt.length,tt);const N=16,T=1482184792;let M=k(L,N);for(I=0,C=tt.length-3;I<C;I+=4)M=M-T+k(tt,I)|0;I<tt.length&&(M=M-T+k(tt+"XXX",I)|0),L=j(L,N,4,(0,c.string32)(M));const $=`url(data:font/opentype;base64,${btoa(L)});`,et=`@font-face {font-family:"${tt}";src:${$}}`;this.insertRule(et);const wt=this._document.createElement("div");wt.style.visibility="hidden",wt.style.width=wt.style.height="10px",wt.style.position="absolute",wt.style.top=wt.style.left="0px";for(const Pt of[V.loadedName,tt]){const Ct=this._document.createElement("span");Ct.textContent="Hi",Ct.style.fontFamily=Pt,wt.append(Ct)}this._document.body.append(wt),pt(tt,()=>{wt.remove(),O.complete()})}}nt=new WeakMap;class U{constructor(V,{disableFontFace:O=!1,ignoreErrors:k=!1,inspectFont:j=null}){this.compiledGlyphs=Object.create(null);for(const I in V)this[I]=V[I];this.disableFontFace=O===!0,this.ignoreErrors=k===!0,this._inspectFont=j}createNativeFontFace(){var O;if(!this.data||this.disableFontFace)return null;let V;if(!this.cssFontInfo)V=new FontFace(this.loadedName,this.data,{});else{const k={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(k.style=`oblique ${this.cssFontInfo.italicAngle}deg`),V=new FontFace(this.cssFontInfo.fontFamily,this.data,k)}return(O=this._inspectFont)==null||O.call(this,this),V}createFontFaceRule(){var j;if(!this.data||this.disableFontFace)return null;const V=(0,c.bytesToString)(this.data),O=`url(data:${this.mimetype};base64,${btoa(V)});`;let k;if(!this.cssFontInfo)k=`@font-face {font-family:"${this.loadedName}";src:${O}}`;else{let I=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(I+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),k=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${I}src:${O}}`}return(j=this._inspectFont)==null||j.call(this,this,O),k}getPathGenerator(V,O){if(this.compiledGlyphs[O]!==void 0)return this.compiledGlyphs[O];let k;try{k=V.get(this.loadedName+"_path_"+O)}catch(I){if(!this.ignoreErrors)throw I;(0,c.warn)(`getPathGenerator - ignoring character: "${I}".`)}if(!Array.isArray(k)||k.length===0)return this.compiledGlyphs[O]=function(I,C){};const j=[];for(let I=0,C=k.length;I<C;)switch(k[I++]){case c.FontRenderOps.BEZIER_CURVE_TO:{const[F,D,z,pt,tt,L]=k.slice(I,I+6);j.push(N=>N.bezierCurveTo(F,D,z,pt,tt,L)),I+=6}break;case c.FontRenderOps.MOVE_TO:{const[F,D]=k.slice(I,I+2);j.push(z=>z.moveTo(F,D)),I+=2}break;case c.FontRenderOps.LINE_TO:{const[F,D]=k.slice(I,I+2);j.push(z=>z.lineTo(F,D)),I+=2}break;case c.FontRenderOps.QUADRATIC_CURVE_TO:{const[F,D,z,pt]=k.slice(I,I+4);j.push(tt=>tt.quadraticCurveTo(F,D,z,pt)),I+=4}break;case c.FontRenderOps.RESTORE:j.push(F=>F.restore());break;case c.FontRenderOps.SAVE:j.push(F=>F.save());break;case c.FontRenderOps.SCALE:(0,c.assert)(j.length===2,"Scale command is only valid at the third position.");break;case c.FontRenderOps.TRANSFORM:{const[F,D,z,pt,tt,L]=k.slice(I,I+6);j.push(N=>N.transform(F,D,z,pt,tt,L)),I+=6}break;case c.FontRenderOps.TRANSLATE:{const[F,D]=k.slice(I,I+2);j.push(z=>z.translate(F,D)),I+=2}break}return this.compiledGlyphs[O]=function(I,C){j[0](I),j[1](I),I.scale(C,-C);for(let F=2,D=j.length;F<D;F++)j[F](I)}}}},62:(le,Wt,ut)=>{var U,nt;ut.d(Wt,{Metadata:()=>at});var c=ut(292);class at{constructor({parsedData:V,rawData:O}){r(this,U,void 0);r(this,nt,void 0);w(this,U,V),w(this,nt,O)}getRaw(){return t(this,nt)}get(V){return t(this,U).get(V)??null}getAll(){return(0,c.objectFromMap)(t(this,U))}has(V){return t(this,U).has(V)}}U=new WeakMap,nt=new WeakMap},457:(le,Wt,ut)=>{ut.d(Wt,{PDFNetworkStream:()=>O});var c=ut(292),at=ut(490);const U=200,nt=206;function bt(I){const C=I.response;return typeof C!="string"?C:(0,c.stringToBytes)(C).buffer}class V{constructor(C,F={}){this.url=C,this.isHttp=/^https?:/i.test(C),this.httpHeaders=this.isHttp&&F.httpHeaders||Object.create(null),this.withCredentials=F.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(C,F,D){const z={begin:C,end:F};for(const pt in D)z[pt]=D[pt];return this.request(z)}requestFull(C){return this.request(C)}request(C){const F=new XMLHttpRequest,D=this.currXhrId++,z=this.pendingRequests[D]={xhr:F};F.open("GET",this.url),F.withCredentials=this.withCredentials;for(const pt in this.httpHeaders){const tt=this.httpHeaders[pt];tt!==void 0&&F.setRequestHeader(pt,tt)}return this.isHttp&&"begin"in C&&"end"in C?(F.setRequestHeader("Range",`bytes=${C.begin}-${C.end-1}`),z.expectedStatus=nt):z.expectedStatus=U,F.responseType="arraybuffer",C.onError&&(F.onerror=function(pt){C.onError(F.status)}),F.onreadystatechange=this.onStateChange.bind(this,D),F.onprogress=this.onProgress.bind(this,D),z.onHeadersReceived=C.onHeadersReceived,z.onDone=C.onDone,z.onError=C.onError,z.onProgress=C.onProgress,F.send(null),D}onProgress(C,F){var z;const D=this.pendingRequests[C];D&&((z=D.onProgress)==null||z.call(D,F))}onStateChange(C,F){var L,N,T;const D=this.pendingRequests[C];if(!D)return;const z=D.xhr;if(z.readyState>=2&&D.onHeadersReceived&&(D.onHeadersReceived(),delete D.onHeadersReceived),z.readyState!==4||!(C in this.pendingRequests))return;if(delete this.pendingRequests[C],z.status===0&&this.isHttp){(L=D.onError)==null||L.call(D,z.status);return}const pt=z.status||U;if(!(pt===U&&D.expectedStatus===nt)&&pt!==D.expectedStatus){(N=D.onError)==null||N.call(D,z.status);return}const tt=bt(z);if(pt===nt){const M=z.getResponseHeader("Content-Range"),$=/bytes (\d+)-(\d+)\/(\d+)/.exec(M);D.onDone({begin:parseInt($[1],10),chunk:tt})}else tt?D.onDone({begin:0,chunk:tt}):(T=D.onError)==null||T.call(D,z.status)}getRequestXhr(C){return this.pendingRequests[C].xhr}isPendingRequest(C){return C in this.pendingRequests}abortRequest(C){const F=this.pendingRequests[C].xhr;delete this.pendingRequests[C],F.abort()}}class O{constructor(C){this._source=C,this._manager=new V(C.url,{httpHeaders:C.httpHeaders,withCredentials:C.withCredentials}),this._rangeChunkSize=C.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(C){const F=this._rangeRequestReaders.indexOf(C);F>=0&&this._rangeRequestReaders.splice(F,1)}getFullReader(){return(0,c.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new k(this._manager,this._source),this._fullRequestReader}getRangeReader(C,F){const D=new j(this._manager,C,F);return D.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(D),D}cancelAllRequests(C){var F;(F=this._fullRequestReader)==null||F.cancel(C);for(const D of this._rangeRequestReaders.slice(0))D.cancel(C)}}class k{constructor(C,F){this._manager=C;const D={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=F.url,this._fullRequestId=C.requestFull(D),this._headersReceivedCapability=Promise.withResolvers(),this._disableRange=F.disableRange||!1,this._contentLength=F.length,this._rangeChunkSize=F.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const C=this._fullRequestId,F=this._manager.getRequestXhr(C),D=tt=>F.getResponseHeader(tt),{allowRangeRequests:z,suggestedLength:pt}=(0,at.validateRangeRequestCapabilities)({getResponseHeader:D,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});z&&(this._isRangeSupported=!0),this._contentLength=pt||this._contentLength,this._filename=(0,at.extractFilenameFromHeader)(D),this._isRangeSupported&&this._manager.abortRequest(C),this._headersReceivedCapability.resolve()}_onDone(C){if(C&&(this._requests.length>0?this._requests.shift().resolve({value:C.chunk,done:!1}):this._cachedChunks.push(C.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(C){this._storedError=(0,at.createResponseStatusError)(C,this._url),this._headersReceivedCapability.reject(this._storedError);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(C){var F;(F=this.onProgress)==null||F.call(this,{loaded:C.loaded,total:C.lengthComputable?C.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const C=Promise.withResolvers();return this._requests.push(C),C.promise}cancel(C){this._done=!0,this._headersReceivedCapability.reject(C);for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class j{constructor(C,F,D){this._manager=C;const z={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=C.url,this._requestId=C.requestRange(F,D,z),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var C;(C=this.onClosed)==null||C.call(this,this)}_onDone(C){const F=C.chunk;this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunk=F,this._done=!0;for(const D of this._requests)D.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(C){this._storedError=(0,at.createResponseStatusError)(C,this._url);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(C){var F;this.isStreamingSupported||((F=this.onProgress)==null||F.call(this,{loaded:C.loaded}))}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const F=this._queuedChunk;return this._queuedChunk=null,{value:F,done:!1}}if(this._done)return{value:void 0,done:!0};const C=Promise.withResolvers();return this._requests.push(C),C.promise}cancel(C){this._done=!0;for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},490:(le,Wt,ut)=>{ut.d(Wt,{createResponseStatusError:()=>V,extractFilenameFromHeader:()=>bt,validateRangeRequestCapabilities:()=>nt,validateResponseStatus:()=>O});var c=ut(292);function at(k){let j=!0,I=C("filename\\*","i").exec(k);if(I){I=I[1];let N=pt(I);return N=unescape(N),N=tt(N),N=L(N),D(N)}if(I=z(k),I){const N=L(I);return D(N)}if(I=C("filename","i").exec(k),I){I=I[1];let N=pt(I);return N=L(N),D(N)}function C(N,T){return new RegExp("(?:^|;)\\s*"+N+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',T)}function F(N,T){if(N){if(!/^[\x00-\xFF]+$/.test(T))return T;try{const M=new TextDecoder(N,{fatal:!0}),$=(0,c.stringToBytes)(T);T=M.decode($),j=!1}catch{}}return T}function D(N){return j&&/[\x80-\xff]/.test(N)&&(N=F("utf-8",N),j&&(N=F("iso-8859-1",N))),N}function z(N){const T=[];let M;const $=C("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(M=$.exec(N))!==null;){let[,wt,Pt,Ct]=M;if(wt=parseInt(wt,10),wt in T){if(wt===0)break;continue}T[wt]=[Pt,Ct]}const et=[];for(let wt=0;wt<T.length&&wt in T;++wt){let[Pt,Ct]=T[wt];Ct=pt(Ct),Pt&&(Ct=unescape(Ct),wt===0&&(Ct=tt(Ct))),et.push(Ct)}return et.join("")}function pt(N){if(N.startsWith('"')){const T=N.slice(1).split('\\"');for(let M=0;M<T.length;++M){const $=T[M].indexOf('"');$!==-1&&(T[M]=T[M].slice(0,$),T.length=M+1),T[M]=T[M].replaceAll(/\\(.)/g,"$1")}N=T.join('"')}return N}function tt(N){const T=N.indexOf("'");if(T===-1)return N;const M=N.slice(0,T),$=N.slice(T+1).replace(/^[^']*'/,"");return F(M,$)}function L(N){return!N.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(N)?N:N.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(T,M,$,et){if($==="q"||$==="Q")return et=et.replaceAll("_"," "),et=et.replaceAll(/=([0-9a-fA-F]{2})/g,function(wt,Pt){return String.fromCharCode(parseInt(Pt,16))}),F(M,et);try{et=atob(et)}catch{}return F(M,et)})}return""}var U=ut(419);function nt({getResponseHeader:k,isHttp:j,rangeChunkSize:I,disableRange:C}){const F={allowRangeRequests:!1,suggestedLength:void 0},D=parseInt(k("Content-Length"),10);return!Number.isInteger(D)||(F.suggestedLength=D,D<=2*I)||C||!j||k("Accept-Ranges")!=="bytes"||(k("Content-Encoding")||"identity")!=="identity"||(F.allowRangeRequests=!0),F}function bt(k){const j=k("Content-Disposition");if(j){let I=at(j);if(I.includes("%"))try{I=decodeURIComponent(I)}catch{}if((0,U.isPdfFile)(I))return I}return null}function V(k,j){return k===404||k===0&&j.startsWith("file:")?new c.MissingPDFException('Missing PDF "'+j+'".'):new c.UnexpectedResponseException(`Unexpected server response (${k}) while retrieving PDF "${j}".`,k)}function O(k){return k===200||k===206}},786:(le,Wt,ut)=>{ut.a(le,async(c,at)=>{try{let bt=function(T){const M=I.parse(T);return M.protocol==="file:"||M.host?M:/^[a-z]:[/\\]/i.test(T)?I.parse(`file:///${T}`):(M.host||(M.protocol="file:"),M)},V=function(T,M){return{protocol:T.protocol,auth:T.auth,host:T.hostname,port:T.port,path:T.path,method:"GET",headers:M}};ut.d(Wt,{PDFNodeStream:()=>F});var U=ut(292),nt=ut(490);let O,k,j,I;U.isNodeJS&&(O=await vs(()=>import("./index-J3ZDATS2.js").then(async T=>(await T.__tla,T)).then(T=>T.a2),__vite__mapDeps([0,1])),k=await vs(()=>import("./index-J3ZDATS2.js").then(async T=>(await T.__tla,T)).then(T=>T.a2),__vite__mapDeps([0,1])),j=await vs(()=>import("./index-J3ZDATS2.js").then(async T=>(await T.__tla,T)).then(T=>T.a2),__vite__mapDeps([0,1])),I=await vs(()=>import("./index-J3ZDATS2.js").then(async T=>(await T.__tla,T)).then(T=>T.a2),__vite__mapDeps([0,1])));const C=/^file:\/\/\/[a-zA-Z]:\//;class F{constructor(M){this.source=M,this.url=bt(M.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&M.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var M;return((M=this._fullRequestReader)==null?void 0:M._loaded)??0}getFullReader(){return(0,U.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new L(this):new pt(this),this._fullRequestReader}getRangeReader(M,$){if($<=this._progressiveDataLength)return null;const et=this.isFsUrl?new N(this,M,$):new tt(this,M,$);return this._rangeRequestReaders.push(et),et}cancelAllRequests(M){var $;($=this._fullRequestReader)==null||$.cancel(M);for(const et of this._rangeRequestReaders.slice(0))et.cancel(M)}}class D{constructor(M){this._url=M.url,this._done=!1,this._storedError=null,this.onProgress=null;const $=M.source;this._contentLength=$.length,this._loaded=0,this._filename=null,this._disableRange=$.disableRange||!1,this._rangeChunkSize=$.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!$.disableStream,this._isRangeSupported=!$.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var $;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const M=this._readableStream.read();return M===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=M.length,($=this.onProgress)==null||$.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(M).buffer,done:!1})}cancel(M){if(!this._readableStream){this._error(M);return}this._readableStream.destroy(M)}_error(M){this._storedError=M,this._readCapability.resolve()}_setReadableStream(M){this._readableStream=M,M.on("readable",()=>{this._readCapability.resolve()}),M.on("end",()=>{M.destroy(),this._done=!0,this._readCapability.resolve()}),M.on("error",$=>{this._error($)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new U.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class z{constructor(M){this._url=M.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const $=M.source;this._isStreamingSupported=!$.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var $;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const M=this._readableStream.read();return M===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=M.length,($=this.onProgress)==null||$.call(this,{loaded:this._loaded}),{value:new Uint8Array(M).buffer,done:!1})}cancel(M){if(!this._readableStream){this._error(M);return}this._readableStream.destroy(M)}_error(M){this._storedError=M,this._readCapability.resolve()}_setReadableStream(M){this._readableStream=M,M.on("readable",()=>{this._readCapability.resolve()}),M.on("end",()=>{M.destroy(),this._done=!0,this._readCapability.resolve()}),M.on("error",$=>{this._error($)}),this._storedError&&this._readableStream.destroy(this._storedError)}}class pt extends D{constructor(M){super(M);const $=et=>{if(et.statusCode===404){const Nt=new U.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Nt,this._headersCapability.reject(Nt);return}this._headersCapability.resolve(),this._setReadableStream(et);const wt=Nt=>this._readableStream.headers[Nt.toLowerCase()],{allowRangeRequests:Pt,suggestedLength:Ct}=(0,nt.validateRangeRequestCapabilities)({getResponseHeader:wt,isHttp:M.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Pt,this._contentLength=Ct||this._contentLength,this._filename=(0,nt.extractFilenameFromHeader)(wt)};this._request=null,this._url.protocol==="http:"?this._request=k.request(V(this._url,M.httpHeaders),$):this._request=j.request(V(this._url,M.httpHeaders),$),this._request.on("error",et=>{this._storedError=et,this._headersCapability.reject(et)}),this._request.end()}}class tt extends z{constructor(M,$,et){super(M),this._httpHeaders={};for(const Pt in M.httpHeaders){const Ct=M.httpHeaders[Pt];Ct!==void 0&&(this._httpHeaders[Pt]=Ct)}this._httpHeaders.Range=`bytes=${$}-${et-1}`;const wt=Pt=>{if(Pt.statusCode===404){const Ct=new U.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Ct;return}this._setReadableStream(Pt)};this._request=null,this._url.protocol==="http:"?this._request=k.request(V(this._url,this._httpHeaders),wt):this._request=j.request(V(this._url,this._httpHeaders),wt),this._request.on("error",Pt=>{this._storedError=Pt}),this._request.end()}}class L extends D{constructor(M){super(M);let $=decodeURIComponent(this._url.path);C.test(this._url.href)&&($=$.replace(/^\//,"")),O.promises.lstat($).then(et=>{this._contentLength=et.size,this._setReadableStream(O.createReadStream($)),this._headersCapability.resolve()},et=>{et.code==="ENOENT"&&(et=new U.MissingPDFException(`Missing PDF "${$}".`)),this._storedError=et,this._headersCapability.reject(et)})}}class N extends z{constructor(M,$,et){super(M);let wt=decodeURIComponent(this._url.path);C.test(this._url.href)&&(wt=wt.replace(/^\//,"")),this._setReadableStream(O.createReadStream(wt,{start:$,end:et-1}))}}at()}catch(bt){at(bt)}},1)},573:(le,Wt,ut)=>{ut.a(le,async(c,at)=>{try{ut.d(Wt,{NodeCMapReaderFactory:()=>C,NodeCanvasFactory:()=>I,NodeFilterFactory:()=>j,NodeStandardFontDataFactory:()=>F});var U=ut(583),nt=ut(292);let bt,V,O;if(nt.isNodeJS){bt=await vs(()=>import("./index-J3ZDATS2.js").then(async D=>(await D.__tla,D)).then(D=>D.a2),__vite__mapDeps([0,1]));try{V=await vs(()=>import("./index-J3ZDATS2.js").then(async D=>(await D.__tla,D)).then(D=>D.a2),__vite__mapDeps([0,1]))}catch{}try{O=await vs(()=>import("./index-KxCSKDtb.js"),__vite__mapDeps([]))}catch{}}const k=function(D){return bt.promises.readFile(D).then(z=>new Uint8Array(z))};class j extends U.BaseFilterFactory{}class I extends U.BaseCanvasFactory{_createCanvas(z,pt){return V.createCanvas(z,pt)}}class C extends U.BaseCMapReaderFactory{_fetchData(z,pt){return k(z).then(tt=>({cMapData:tt,compressionType:pt}))}}class F extends U.BaseStandardFontDataFactory{_fetchData(z){return k(z)}}at()}catch(bt){at(bt)}},1)},626:(le,Wt,ut)=>{var V,O,k,j,I,C,F,D,z,Zn;ut.d(Wt,{OptionalContentConfig:()=>bt});var c=ut(292),at=ut(651);const U=Symbol("INTERNAL");class nt{constructor(L,{name:N,intent:T,usage:M}){r(this,V,!1);r(this,O,!1);r(this,k,!1);r(this,j,!0);w(this,V,!!(L&c.RenderingIntentFlag.DISPLAY)),w(this,O,!!(L&c.RenderingIntentFlag.PRINT)),this.name=N,this.intent=T,this.usage=M}get visible(){if(t(this,k))return t(this,j);if(!t(this,j))return!1;const{print:L,view:N}=this.usage;return t(this,V)?(N==null?void 0:N.viewState)!=="OFF":t(this,O)?(L==null?void 0:L.printState)!=="OFF":!0}_setVisible(L,N,T=!1){L!==U&&(0,c.unreachable)("Internal method `_setVisible` called."),w(this,k,T),w(this,j,N)}}V=new WeakMap,O=new WeakMap,k=new WeakMap,j=new WeakMap;class bt{constructor(L,N=c.RenderingIntentFlag.DISPLAY){r(this,z);r(this,I,null);r(this,C,new Map);r(this,F,null);r(this,D,null);if(this.renderingIntent=N,this.name=null,this.creator=null,L!==null){this.name=L.name,this.creator=L.creator,w(this,D,L.order);for(const T of L.groups)t(this,C).set(T.id,new nt(N,T));if(L.baseState==="OFF")for(const T of t(this,C).values())T._setVisible(U,!1);for(const T of L.on)t(this,C).get(T)._setVisible(U,!0);for(const T of L.off)t(this,C).get(T)._setVisible(U,!1);w(this,F,this.getHash())}}isVisible(L){if(t(this,C).size===0)return!0;if(!L)return(0,c.info)("Optional content group not defined."),!0;if(L.type==="OCG")return t(this,C).has(L.id)?t(this,C).get(L.id).visible:((0,c.warn)(`Optional content group not found: ${L.id}`),!0);if(L.type==="OCMD"){if(L.expression)return v(this,z,Zn).call(this,L.expression);if(!L.policy||L.policy==="AnyOn"){for(const N of L.ids){if(!t(this,C).has(N))return(0,c.warn)(`Optional content group not found: ${N}`),!0;if(t(this,C).get(N).visible)return!0}return!1}else if(L.policy==="AllOn"){for(const N of L.ids){if(!t(this,C).has(N))return(0,c.warn)(`Optional content group not found: ${N}`),!0;if(!t(this,C).get(N).visible)return!1}return!0}else if(L.policy==="AnyOff"){for(const N of L.ids){if(!t(this,C).has(N))return(0,c.warn)(`Optional content group not found: ${N}`),!0;if(!t(this,C).get(N).visible)return!0}return!1}else if(L.policy==="AllOff"){for(const N of L.ids){if(!t(this,C).has(N))return(0,c.warn)(`Optional content group not found: ${N}`),!0;if(t(this,C).get(N).visible)return!1}return!0}return(0,c.warn)(`Unknown optional content policy ${L.policy}.`),!0}return(0,c.warn)(`Unknown group type ${L.type}.`),!0}setVisibility(L,N=!0){const T=t(this,C).get(L);if(!T){(0,c.warn)(`Optional content group not found: ${L}`);return}T._setVisible(U,!!N,!0),w(this,I,null)}setOCGState({state:L,preserveRB:N}){let T;for(const M of L){switch(M){case"ON":case"OFF":case"Toggle":T=M;continue}const $=t(this,C).get(M);if($)switch(T){case"ON":$._setVisible(U,!0);break;case"OFF":$._setVisible(U,!1);break;case"Toggle":$._setVisible(U,!$.visible);break}}w(this,I,null)}get hasInitialVisibility(){return t(this,F)===null||this.getHash()===t(this,F)}getOrder(){return t(this,C).size?t(this,D)?t(this,D).slice():[...t(this,C).keys()]:null}getGroups(){return t(this,C).size>0?(0,c.objectFromMap)(t(this,C)):null}getGroup(L){return t(this,C).get(L)||null}getHash(){if(t(this,I)!==null)return t(this,I);const L=new at.MurmurHash3_64;for(const[N,T]of t(this,C))L.update(`${N}:${T.visible}`);return w(this,I,L.hexdigest())}}I=new WeakMap,C=new WeakMap,F=new WeakMap,D=new WeakMap,z=new WeakSet,Zn=function(L){const N=L.length;if(N<2)return!0;const T=L[0];for(let M=1;M<N;M++){const $=L[M];let et;if(Array.isArray($))et=v(this,z,Zn).call(this,$);else if(t(this,C).has($))et=t(this,C).get($).visible;else return(0,c.warn)(`Optional content group not found: ${$}`),!0;switch(T){case"And":if(!et)return!1;break;case"Or":if(et)return!0;break;case"Not":return!et;default:return!0}}return T==="And"}},814:(le,Wt,ut)=>{ut.d(Wt,{cleanupTextLayer:()=>j,renderTextLayer:()=>pt,updateTextLayer:()=>tt});var c=ut(292),at=ut(419);const U=1e5,nt=30,bt=.8,V=new Map;let O=null;function k(){if(!O){const L=document.createElement("canvas");L.className="hiddenCanvasElement",document.body.append(L),O=L.getContext("2d",{alpha:!1})}return O}function j(){O==null||O.canvas.remove(),O=null}function I(L){const N=V.get(L);if(N)return N;const T=k(),M=T.font;T.canvas.width=T.canvas.height=nt,T.font=`${nt}px ${L}`;const $=T.measureText("");let et=$.fontBoundingBoxAscent,wt=Math.abs($.fontBoundingBoxDescent);if(et){const Ct=et/(et+wt);return V.set(L,Ct),T.canvas.width=T.canvas.height=0,T.font=M,Ct}T.strokeStyle="red",T.clearRect(0,0,nt,nt),T.strokeText("g",0,0);let Pt=T.getImageData(0,0,nt,nt).data;wt=0;for(let Ct=Pt.length-1-3;Ct>=0;Ct-=4)if(Pt[Ct]>0){wt=Math.ceil(Ct/4/nt);break}T.clearRect(0,0,nt,nt),T.strokeText("A",0,nt),Pt=T.getImageData(0,0,nt,nt).data,et=0;for(let Ct=0,Nt=Pt.length;Ct<Nt;Ct+=4)if(Pt[Ct]>0){et=nt-Math.floor(Ct/4/nt);break}if(T.canvas.width=T.canvas.height=0,T.font=M,et){const Ct=et/(et+wt);return V.set(L,Ct),Ct}return V.set(L,bt),bt}function C(L,N,T){const M=document.createElement("span"),$={angle:0,canvasWidth:0,hasText:N.str!=="",hasEOL:N.hasEOL,fontSize:0};L._textDivs.push(M);const et=c.Util.transform(L._transform,N.transform);let wt=Math.atan2(et[1],et[0]);const Pt=T[N.fontName];Pt.vertical&&(wt+=Math.PI/2);const Ct=L._fontInspectorEnabled&&Pt.fontSubstitution||Pt.fontFamily,Nt=Math.hypot(et[2],et[3]),Mt=Nt*I(Ct);let qt,$t;wt===0?(qt=et[4],$t=et[5]-Mt):(qt=et[4]+Mt*Math.sin(wt),$t=et[5]-Mt*Math.cos(wt));const Kt="calc(var(--scale-factor)*",it=M.style;L._container===L._rootContainer?(it.left=`${(100*qt/L._pageWidth).toFixed(2)}%`,it.top=`${(100*$t/L._pageHeight).toFixed(2)}%`):(it.left=`${Kt}${qt.toFixed(2)}px)`,it.top=`${Kt}${$t.toFixed(2)}px)`),it.fontSize=`${Kt}${Nt.toFixed(2)}px)`,it.fontFamily=Ct,$.fontSize=Nt,M.setAttribute("role","presentation"),M.textContent=N.str,M.dir=N.dir,L._fontInspectorEnabled&&(M.dataset.fontName=Pt.fontSubstitutionLoadedName||N.fontName),wt!==0&&($.angle=wt*(180/Math.PI));let St=!1;if(N.str.length>1)St=!0;else if(N.str!==" "&&N.transform[0]!==N.transform[3]){const Gt=Math.abs(N.transform[0]),zt=Math.abs(N.transform[3]);Gt!==zt&&Math.max(Gt,zt)/Math.min(Gt,zt)>1.5&&(St=!0)}St&&($.canvasWidth=Pt.vertical?N.height:N.width),L._textDivProperties.set(M,$),L._isReadableStream&&L._layoutText(M)}function F(L){const{div:N,scale:T,properties:M,ctx:$,prevFontSize:et,prevFontFamily:wt}=L,{style:Pt}=N;let Ct="";if(M.canvasWidth!==0&&M.hasText){const{fontFamily:Nt}=Pt,{canvasWidth:Mt,fontSize:qt}=M;(et!==qt||wt!==Nt)&&($.font=`${qt*T}px ${Nt}`,L.prevFontSize=qt,L.prevFontFamily=Nt);const{width:$t}=$.measureText(N.textContent);$t>0&&(Ct=`scaleX(${Mt*T/$t})`)}M.angle!==0&&(Ct=`rotate(${M.angle}deg) ${Ct}`),Ct.length>0&&(Pt.transform=Ct)}function D(L){if(L._canceled)return;const N=L._textDivs,T=L._capability;if(N.length>U){T.resolve();return}if(!L._isReadableStream)for(const M of N)L._layoutText(M);T.resolve()}class z{constructor({textContentSource:N,container:T,viewport:M,textDivs:$,textDivProperties:et,textContentItemsStr:wt}){var qt;this._textContentSource=N,this._isReadableStream=N instanceof ReadableStream,this._container=this._rootContainer=T,this._textDivs=$||[],this._textContentItemsStr=wt||[],this._fontInspectorEnabled=!!((qt=globalThis.FontInspector)!=null&&qt.enabled),this._reader=null,this._textDivProperties=et||new WeakMap,this._canceled=!1,this._capability=Promise.withResolvers(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:M.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:k()};const{pageWidth:Pt,pageHeight:Ct,pageX:Nt,pageY:Mt}=M.rawDims;this._transform=[1,0,0,-1,-Nt,Mt+Ct],this._pageWidth=Pt,this._pageHeight=Ct,(0,at.setLayerDimensions)(T,M),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new c.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new c.AbortException("TextLayer task cancelled."))}_processItems(N,T){for(const M of N){if(M.str===void 0){if(M.type==="beginMarkedContentProps"||M.type==="beginMarkedContent"){const $=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),M.id!==null&&this._container.setAttribute("id",`${M.id}`),$.append(this._container)}else M.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(M.str),C(this,M,T)}}_layoutText(N){const T=this._layoutTextParams.properties=this._textDivProperties.get(N);if(this._layoutTextParams.div=N,F(this._layoutTextParams),T.hasText&&this._container.append(N),T.hasEOL){const M=document.createElement("br");M.setAttribute("role","presentation"),this._container.append(M)}}_render(){const{promise:N,resolve:T,reject:M}=Promise.withResolvers();let $=Object.create(null);if(this._isReadableStream){const et=()=>{this._reader.read().then(({value:wt,done:Pt})=>{if(Pt){T();return}Object.assign($,wt.styles),this._processItems(wt.items,$),et()},M)};this._reader=this._textContentSource.getReader(),et()}else if(this._textContentSource){const{items:et,styles:wt}=this._textContentSource;this._processItems(et,wt),T()}else throw new Error('No "textContentSource" parameter specified.');N.then(()=>{$=null,D(this)},this._capability.reject)}}function pt(L){const N=new z(L);return N._render(),N}function tt({container:L,viewport:N,textDivs:T,textDivProperties:M,mustRotate:$=!0,mustRescale:et=!0}){if($&&(0,at.setLayerDimensions)(L,{rotation:N.rotation}),et){const wt=k(),Pt={prevFontSize:null,prevFontFamily:null,div:null,scale:N.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:wt};for(const Ct of T)Pt.properties=M.get(Ct),Pt.div=Ct,F(Pt)}}},585:(le,Wt,ut)=>{ut.d(Wt,{PDFDataTransportStream:()=>U});var c=ut(292),at=ut(419);class U{constructor(O,{disableRange:k=!1,disableStream:j=!1}){(0,c.assert)(O,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:I,initialData:C,progressiveDone:F,contentDispositionFilename:D}=O;if(this._queuedChunks=[],this._progressiveDone=F,this._contentDispositionFilename=D,(C==null?void 0:C.length)>0){const z=C instanceof Uint8Array&&C.byteLength===C.buffer.byteLength?C.buffer:new Uint8Array(C).buffer;this._queuedChunks.push(z)}this._pdfDataRangeTransport=O,this._isStreamingSupported=!j,this._isRangeSupported=!k,this._contentLength=I,this._fullRequestReader=null,this._rangeReaders=[],O.addRangeListener((z,pt)=>{this._onReceiveData({begin:z,chunk:pt})}),O.addProgressListener((z,pt)=>{this._onProgress({loaded:z,total:pt})}),O.addProgressiveReadListener(z=>{this._onReceiveData({chunk:z})}),O.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),O.transportReady()}_onReceiveData({begin:O,chunk:k}){const j=k instanceof Uint8Array&&k.byteLength===k.buffer.byteLength?k.buffer:new Uint8Array(k).buffer;if(O===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(j):this._queuedChunks.push(j);else{const I=this._rangeReaders.some(function(C){return C._begin!==O?!1:(C._enqueue(j),!0)});(0,c.assert)(I,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var O;return((O=this._fullRequestReader)==null?void 0:O._loaded)??0}_onProgress(O){var k,j,I,C;O.total===void 0?(j=(k=this._rangeReaders[0])==null?void 0:k.onProgress)==null||j.call(k,{loaded:O.loaded}):(C=(I=this._fullRequestReader)==null?void 0:I.onProgress)==null||C.call(I,{loaded:O.loaded,total:O.total})}_onProgressiveDone(){var O;(O=this._fullRequestReader)==null||O.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(O){const k=this._rangeReaders.indexOf(O);k>=0&&this._rangeReaders.splice(k,1)}getFullReader(){(0,c.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const O=this._queuedChunks;return this._queuedChunks=null,new nt(this,O,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(O,k){if(k<=this._progressiveDataLength)return null;const j=new bt(this,O,k);return this._pdfDataRangeTransport.requestDataRange(O,k),this._rangeReaders.push(j),j}cancelAllRequests(O){var k;(k=this._fullRequestReader)==null||k.cancel(O);for(const j of this._rangeReaders.slice(0))j.cancel(O);this._pdfDataRangeTransport.abort()}}class nt{constructor(O,k,j=!1,I=null){this._stream=O,this._done=j||!1,this._filename=(0,at.isPdfFile)(I)?I:null,this._queuedChunks=k||[],this._loaded=0;for(const C of this._queuedChunks)this._loaded+=C.byteLength;this._requests=[],this._headersReady=Promise.resolve(),O._fullRequestReader=this,this.onProgress=null}_enqueue(O){this._done||(this._requests.length>0?this._requests.shift().resolve({value:O,done:!1}):this._queuedChunks.push(O),this._loaded+=O.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const O=Promise.withResolvers();return this._requests.push(O),O.promise}cancel(O){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class bt{constructor(O,k,j){this._stream=O,this._begin=k,this._end=j,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(O){if(!this._done){if(this._requests.length===0)this._queuedChunk=O;else{this._requests.shift().resolve({value:O,done:!1});for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const k=this._queuedChunk;return this._queuedChunk=null,{value:k,done:!1}}if(this._done)return{value:void 0,done:!0};const O=Promise.withResolvers();return this._requests.push(O),O.promise}cancel(O){this._done=!0;for(const k of this._requests)k.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},164:(le,Wt,ut)=>{var at,U;ut.d(Wt,{GlobalWorkerOptions:()=>c});class c{static get workerPort(){return t(this,at)}static set workerPort(bt){if(!(typeof Worker<"u"&&bt instanceof Worker)&&bt!==null)throw new Error("Invalid `workerPort` type.");w(this,at,bt)}static get workerSrc(){return t(this,U)}static set workerSrc(bt){if(typeof bt!="string")throw new Error("Invalid `workerSrc` type.");w(this,U,bt)}}at=new WeakMap,U=new WeakMap,r(c,at,null),r(c,U,"")},284:(le,Wt,ut)=>{ut.d(Wt,{XfaLayer:()=>at});var c=ut(50);class at{static setupStorage(nt,bt,V,O,k){const j=O.getValue(bt,{value:null});switch(V.name){case"textarea":if(j.value!==null&&(nt.textContent=j.value),k==="print")break;nt.addEventListener("input",I=>{O.setValue(bt,{value:I.target.value})});break;case"input":if(V.attributes.type==="radio"||V.attributes.type==="checkbox"){if(j.value===V.attributes.xfaOn?nt.setAttribute("checked",!0):j.value===V.attributes.xfaOff&&nt.removeAttribute("checked"),k==="print")break;nt.addEventListener("change",I=>{O.setValue(bt,{value:I.target.checked?I.target.getAttribute("xfaOn"):I.target.getAttribute("xfaOff")})})}else{if(j.value!==null&&nt.setAttribute("value",j.value),k==="print")break;nt.addEventListener("input",I=>{O.setValue(bt,{value:I.target.value})})}break;case"select":if(j.value!==null){nt.setAttribute("value",j.value);for(const I of V.children)I.attributes.value===j.value?I.attributes.selected=!0:I.attributes.hasOwnProperty("selected")&&delete I.attributes.selected}nt.addEventListener("input",I=>{const C=I.target.options,F=C.selectedIndex===-1?"":C[C.selectedIndex].value;O.setValue(bt,{value:F})});break}}static setAttributes({html:nt,element:bt,storage:V=null,intent:O,linkService:k}){const{attributes:j}=bt,I=nt instanceof HTMLAnchorElement;j.type==="radio"&&(j.name=`${j.name}-${O}`);for(const[C,F]of Object.entries(j))if(F!=null)switch(C){case"class":F.length&&nt.setAttribute(C,F.join(" "));break;case"dataId":break;case"id":nt.setAttribute("data-element-id",F);break;case"style":Object.assign(nt.style,F);break;case"textContent":nt.textContent=F;break;default:(!I||C!=="href"&&C!=="newWindow")&&nt.setAttribute(C,F)}I&&k.addLinkAttributes(nt,j.href,j.newWindow),V&&j.dataId&&this.setupStorage(nt,j.dataId,bt,V)}static render(nt){var z,pt;const bt=nt.annotationStorage,V=nt.linkService,O=nt.xfaHtml,k=nt.intent||"display",j=document.createElement(O.name);O.attributes&&this.setAttributes({html:j,element:O,intent:k,linkService:V});const I=k!=="richText",C=nt.div;if(C.append(j),nt.viewport){const tt=`matrix(${nt.viewport.transform.join(",")})`;C.style.transform=tt}I&&C.setAttribute("class","xfaLayer xfaFont");const F=[];if(O.children.length===0){if(O.value){const tt=document.createTextNode(O.value);j.append(tt),I&&c.XfaText.shouldBuildText(O.name)&&F.push(tt)}return{textDivs:F}}const D=[[O,-1,j]];for(;D.length>0;){const[tt,L,N]=D.at(-1);if(L+1===tt.children.length){D.pop();continue}const T=tt.children[++D.at(-1)[1]];if(T===null)continue;const{name:M}=T;if(M==="#text"){const et=document.createTextNode(T.value);F.push(et),N.append(et);continue}const $=(z=T==null?void 0:T.attributes)!=null&&z.xmlns?document.createElementNS(T.attributes.xmlns,M):document.createElement(M);if(N.append($),T.attributes&&this.setAttributes({html:$,element:T,storage:bt,intent:k,linkService:V}),((pt=T.children)==null?void 0:pt.length)>0)D.push([T,-1,$]);else if(T.value){const et=document.createTextNode(T.value);I&&c.XfaText.shouldBuildText(M)&&F.push(et),$.append(et)}}for(const tt of C.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))tt.setAttribute("readOnly",!0);return{textDivs:F}}static update(nt){const bt=`matrix(${nt.viewport.transform.join(",")})`;nt.div.style.transform=bt,nt.div.hidden=!1}}},50:(le,Wt,ut)=>{ut.d(Wt,{XfaText:()=>c});class c{static textContent(U){const nt=[],bt={items:nt,styles:Object.create(null)};function V(O){var I;if(!O)return;let k=null;const j=O.name;if(j==="#text")k=O.value;else if(c.shouldBuildText(j))(I=O==null?void 0:O.attributes)!=null&&I.textContent?k=O.attributes.textContent:O.value&&(k=O.value);else return;if(k!==null&&nt.push({str:k}),!!O.children)for(const C of O.children)V(C)}return V(U),bt}static shouldBuildText(U){return!(U==="textarea"||U==="input"||U==="option"||U==="select")}}},228:(le,Wt,ut)=>{ut.a(le,async(c,at)=>{try{ut.d(Wt,{AbortException:()=>U.AbortException,AnnotationEditorLayer:()=>O.AnnotationEditorLayer,AnnotationEditorParamsType:()=>U.AnnotationEditorParamsType,AnnotationEditorType:()=>U.AnnotationEditorType,AnnotationEditorUIManager:()=>k.AnnotationEditorUIManager,AnnotationLayer:()=>j.AnnotationLayer,AnnotationMode:()=>U.AnnotationMode,CMapCompressionType:()=>U.CMapCompressionType,ColorPicker:()=>I.ColorPicker,DOMSVGFactory:()=>bt.DOMSVGFactory,DrawLayer:()=>C.DrawLayer,FeatureTest:()=>U.FeatureTest,GlobalWorkerOptions:()=>F.GlobalWorkerOptions,ImageKind:()=>U.ImageKind,InvalidPDFException:()=>U.InvalidPDFException,MissingPDFException:()=>U.MissingPDFException,OPS:()=>U.OPS,Outliner:()=>D.Outliner,PDFDataRangeTransport:()=>nt.PDFDataRangeTransport,PDFDateString:()=>bt.PDFDateString,PDFWorker:()=>nt.PDFWorker,PasswordResponses:()=>U.PasswordResponses,PermissionFlag:()=>U.PermissionFlag,PixelsPerInch:()=>bt.PixelsPerInch,RenderingCancelledException:()=>bt.RenderingCancelledException,UnexpectedResponseException:()=>U.UnexpectedResponseException,Util:()=>U.Util,VerbosityLevel:()=>U.VerbosityLevel,XfaLayer:()=>z.XfaLayer,build:()=>nt.build,createValidAbsoluteUrl:()=>U.createValidAbsoluteUrl,fetchData:()=>bt.fetchData,getDocument:()=>nt.getDocument,getFilenameFromUrl:()=>bt.getFilenameFromUrl,getPdfFilenameFromUrl:()=>bt.getPdfFilenameFromUrl,getXfaPageViewport:()=>bt.getXfaPageViewport,isDataScheme:()=>bt.isDataScheme,isPdfFile:()=>bt.isPdfFile,noContextMenu:()=>bt.noContextMenu,normalizeUnicode:()=>U.normalizeUnicode,renderTextLayer:()=>V.renderTextLayer,setLayerDimensions:()=>bt.setLayerDimensions,shadow:()=>U.shadow,updateTextLayer:()=>V.updateTextLayer,version:()=>nt.version});var U=ut(292),nt=ut(831),bt=ut(419),V=ut(814),O=ut(731),k=ut(830),j=ut(976),I=ut(259),C=ut(47),F=ut(164),D=ut(61),z=ut(284),pt=c([nt]);nt=(pt.then?(await pt)():pt)[0];const tt="4.2.67",L="49b388101";at()}catch(tt){at(tt)}})},178:(le,Wt,ut)=>{var V,ro,k,ao,I,tn;ut.d(Wt,{MessageHandler:()=>bt});var c=ut(292);const at={UNKNOWN:0,DATA:1,ERROR:2},U={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nt(F){switch(F instanceof Error||typeof F=="object"&&F!==null||(0,c.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),F.name){case"AbortException":return new c.AbortException(F.message);case"MissingPDFException":return new c.MissingPDFException(F.message);case"PasswordException":return new c.PasswordException(F.message,F.code);case"UnexpectedResponseException":return new c.UnexpectedResponseException(F.message,F.status);case"UnknownErrorException":return new c.UnknownErrorException(F.message,F.details);default:return new c.UnknownErrorException(F.message,F.toString())}}class bt{constructor(D,z,pt){r(this,V);r(this,k);r(this,I);this.sourceName=D,this.targetName=z,this.comObj=pt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=tt=>{const L=tt.data;if(L.targetName!==this.sourceName)return;if(L.stream){v(this,k,ao).call(this,L);return}if(L.callback){const T=L.callbackId,M=this.callbackCapabilities[T];if(!M)throw new Error(`Cannot resolve callback ${T}`);if(delete this.callbackCapabilities[T],L.callback===at.DATA)M.resolve(L.data);else if(L.callback===at.ERROR)M.reject(nt(L.reason));else throw new Error("Unexpected callback case");return}const N=this.actionHandler[L.action];if(!N)throw new Error(`Unknown action from worker: ${L.action}`);if(L.callbackId){const T=this.sourceName,M=L.sourceName;new Promise(function($){$(N(L.data))}).then(function($){pt.postMessage({sourceName:T,targetName:M,callback:at.DATA,callbackId:L.callbackId,data:$})},function($){pt.postMessage({sourceName:T,targetName:M,callback:at.ERROR,callbackId:L.callbackId,reason:nt($)})});return}if(L.streamId){v(this,V,ro).call(this,L);return}N(L.data)},pt.addEventListener("message",this._onComObjOnMessage)}on(D,z){const pt=this.actionHandler;if(pt[D])throw new Error(`There is already an actionName called "${D}"`);pt[D]=z}send(D,z,pt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:D,data:z},pt)}sendWithPromise(D,z,pt){const tt=this.callbackId++,L=Promise.withResolvers();this.callbackCapabilities[tt]=L;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:D,callbackId:tt,data:z},pt)}catch(N){L.reject(N)}return L.promise}sendWithStream(D,z,pt,tt){const L=this.streamId++,N=this.sourceName,T=this.targetName,M=this.comObj;return new ReadableStream({start:$=>{const et=Promise.withResolvers();return this.streamControllers[L]={controller:$,startCall:et,pullCall:null,cancelCall:null,isClosed:!1},M.postMessage({sourceName:N,targetName:T,action:D,streamId:L,data:z,desiredSize:$.desiredSize},tt),et.promise},pull:$=>{const et=Promise.withResolvers();return this.streamControllers[L].pullCall=et,M.postMessage({sourceName:N,targetName:T,stream:U.PULL,streamId:L,desiredSize:$.desiredSize}),et.promise},cancel:$=>{(0,c.assert)($ instanceof Error,"cancel must have a valid reason");const et=Promise.withResolvers();return this.streamControllers[L].cancelCall=et,this.streamControllers[L].isClosed=!0,M.postMessage({sourceName:N,targetName:T,stream:U.CANCEL,streamId:L,reason:nt($)}),et.promise}},pt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}V=new WeakSet,ro=function(D){const z=D.streamId,pt=this.sourceName,tt=D.sourceName,L=this.comObj,N=this,T=this.actionHandler[D.action],M={enqueue($,et=1,wt){if(this.isCancelled)return;const Pt=this.desiredSize;this.desiredSize-=et,Pt>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),L.postMessage({sourceName:pt,targetName:tt,stream:U.ENQUEUE,streamId:z,chunk:$},wt)},close(){this.isCancelled||(this.isCancelled=!0,L.postMessage({sourceName:pt,targetName:tt,stream:U.CLOSE,streamId:z}),delete N.streamSinks[z])},error($){(0,c.assert)($ instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,L.postMessage({sourceName:pt,targetName:tt,stream:U.ERROR,streamId:z,reason:nt($)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:D.desiredSize,ready:null};M.sinkCapability.resolve(),M.ready=M.sinkCapability.promise,this.streamSinks[z]=M,new Promise(function($){$(T(D.data,M))}).then(function(){L.postMessage({sourceName:pt,targetName:tt,stream:U.START_COMPLETE,streamId:z,success:!0})},function($){L.postMessage({sourceName:pt,targetName:tt,stream:U.START_COMPLETE,streamId:z,reason:nt($)})})},k=new WeakSet,ao=function(D){const z=D.streamId,pt=this.sourceName,tt=D.sourceName,L=this.comObj,N=this.streamControllers[z],T=this.streamSinks[z];switch(D.stream){case U.START_COMPLETE:D.success?N.startCall.resolve():N.startCall.reject(nt(D.reason));break;case U.PULL_COMPLETE:D.success?N.pullCall.resolve():N.pullCall.reject(nt(D.reason));break;case U.PULL:if(!T){L.postMessage({sourceName:pt,targetName:tt,stream:U.PULL_COMPLETE,streamId:z,success:!0});break}T.desiredSize<=0&&D.desiredSize>0&&T.sinkCapability.resolve(),T.desiredSize=D.desiredSize,new Promise(function(M){var $;M(($=T.onPull)==null?void 0:$.call(T))}).then(function(){L.postMessage({sourceName:pt,targetName:tt,stream:U.PULL_COMPLETE,streamId:z,success:!0})},function(M){L.postMessage({sourceName:pt,targetName:tt,stream:U.PULL_COMPLETE,streamId:z,reason:nt(M)})});break;case U.ENQUEUE:if((0,c.assert)(N,"enqueue should have stream controller"),N.isClosed)break;N.controller.enqueue(D.chunk);break;case U.CLOSE:if((0,c.assert)(N,"close should have stream controller"),N.isClosed)break;N.isClosed=!0,N.controller.close(),v(this,I,tn).call(this,N,z);break;case U.ERROR:(0,c.assert)(N,"error should have stream controller"),N.controller.error(nt(D.reason)),v(this,I,tn).call(this,N,z);break;case U.CANCEL_COMPLETE:D.success?N.cancelCall.resolve():N.cancelCall.reject(nt(D.reason)),v(this,I,tn).call(this,N,z);break;case U.CANCEL:if(!T)break;new Promise(function(M){var $;M(($=T.onCancel)==null?void 0:$.call(T,nt(D.reason)))}).then(function(){L.postMessage({sourceName:pt,targetName:tt,stream:U.CANCEL_COMPLETE,streamId:z,success:!0})},function(M){L.postMessage({sourceName:pt,targetName:tt,stream:U.CANCEL_COMPLETE,streamId:z,reason:nt(M)})}),T.sinkCapability.reject(nt(D.reason)),T.isCancelled=!0,delete this.streamSinks[z];break;default:throw new Error("Unexpected stream case")}},I=new WeakSet,tn=async function(D,z){var pt,tt,L;await Promise.allSettled([(pt=D.startCall)==null?void 0:pt.promise,(tt=D.pullCall)==null?void 0:tt.promise,(L=D.cancelCall)==null?void 0:L.promise]),delete this.streamControllers[z]}},651:(le,Wt,ut)=>{ut.d(Wt,{MurmurHash3_64:()=>nt});const c=3285377520,at=4294901760,U=65535;class nt{constructor(V){this.h1=V?V&4294967295:c,this.h2=V?V&4294967295:c}update(V){let O,k;if(typeof V=="string"){O=new Uint8Array(V.length*2),k=0;for(let M=0,$=V.length;M<$;M++){const et=V.charCodeAt(M);et<=255?O[k++]=et:(O[k++]=et>>>8,O[k++]=et&255)}}else if(ArrayBuffer.isView(V))O=V.slice(),k=O.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const j=k>>2,I=k-j*4,C=new Uint32Array(O.buffer,0,j);let F=0,D=0,z=this.h1,pt=this.h2;const tt=3432918353,L=461845907,N=tt&U,T=L&U;for(let M=0;M<j;M++)M&1?(F=C[M],F=F*tt&at|F*N&U,F=F<<15|F>>>17,F=F*L&at|F*T&U,z^=F,z=z<<13|z>>>19,z=z*5+3864292196):(D=C[M],D=D*tt&at|D*N&U,D=D<<15|D>>>17,D=D*L&at|D*T&U,pt^=D,pt=pt<<13|pt>>>19,pt=pt*5+3864292196);switch(F=0,I){case 3:F^=O[j*4+2]<<16;case 2:F^=O[j*4+1]<<8;case 1:F^=O[j*4],F=F*tt&at|F*N&U,F=F<<15|F>>>17,F=F*L&at|F*T&U,j&1?z^=F:pt^=F}this.h1=z,this.h2=pt}hexdigest(){let V=this.h1,O=this.h2;return V^=O>>>1,V=V*3981806797&at|V*36045&U,O=O*4283543511&at|((O<<16|V>>>16)*2950163797&at)>>>16,V^=O>>>1,V=V*444984403&at|V*60499&U,O=O*3301882366&at|((O<<16|V>>>16)*3120437893&at)>>>16,V^=O>>>1,(V>>>0).toString(16).padStart(8,"0")+(O>>>0).toString(16).padStart(8,"0")}}},292:(le,Wt,ut)=>{var g,en,p,tr;ut.d(Wt,{AbortException:()=>he,AnnotationBorderStyleType:()=>pt,AnnotationEditorParamsType:()=>I,AnnotationEditorPrefix:()=>k,AnnotationEditorType:()=>j,AnnotationMode:()=>O,AnnotationPrefix:()=>l,AnnotationType:()=>z,BaseException:()=>Kt,CMapCompressionType:()=>L,FONT_IDENTITY_MATRIX:()=>U,FeatureTest:()=>Re,FontRenderOps:()=>n,FormatError:()=>ae,IDENTITY_MATRIX:()=>at,ImageKind:()=>D,InvalidPDFException:()=>Gt,LINE_FACTOR:()=>bt,MAX_IMAGE_SIZE_TO_CACHE:()=>nt,MissingPDFException:()=>zt,OPS:()=>N,PasswordException:()=>it,PasswordResponses:()=>T,PermissionFlag:()=>C,RenderingIntentFlag:()=>V,TextRenderingMode:()=>F,UnexpectedResponseException:()=>ie,UnknownErrorException:()=>St,Util:()=>Be,VerbosityLevel:()=>tt,assert:()=>Nt,bytesToString:()=>ye,createValidAbsoluteUrl:()=>qt,getUuid:()=>a,getVerbosityLevel:()=>et,info:()=>wt,isNodeJS:()=>c,normalizeUnicode:()=>i,objectFromMap:()=>fe,setVerbosityLevel:()=>$,shadow:()=>$t,string32:()=>ce,stringToBytes:()=>Oe,unreachable:()=>Ct,warn:()=>Pt});const c=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),at=[1,0,0,1,0,0],U=[.001,0,0,.001,0,0],nt=1e7,bt=1.35,V={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},O={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},k="pdfjs_internal_editor_",j={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},I={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35},C={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},F={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},D={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},z={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},pt={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},tt={ERRORS:0,WARNINGS:1,INFOS:5},L={NONE:0,BINARY:1},N={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},T={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let M=tt.WARNINGS;function $(d){Number.isInteger(d)&&(M=d)}function et(){return M}function wt(d){M>=tt.INFOS&&console.log(`Info: ${d}`)}function Pt(d){M>=tt.WARNINGS&&console.log(`Warning: ${d}`)}function Ct(d){throw new Error(d)}function Nt(d,o){d||Ct(o)}function Mt(d){switch(d==null?void 0:d.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function qt(d,o=null,h=null){var x;if(!d)return null;try{if(h&&typeof d=="string"&&(h.addDefaultProtocol&&d.startsWith("www.")&&((x=d.match(/\./g))==null?void 0:x.length)>=2&&(d=`http://${d}`),h.tryConvertEncoding))try{d=te(d)}catch{}const S=o?new URL(d,o):new URL(d);if(Mt(S))return S}catch{}return null}function $t(d,o,h,x=!1){return Object.defineProperty(d,o,{value:h,enumerable:!x,configurable:!0,writable:!1}),h}const Kt=function(){function d(o,h){this.constructor===d&&Ct("Cannot initialize BaseException."),this.message=o,this.name=h}return d.prototype=new Error,d.constructor=d,d}();class it extends Kt{constructor(o,h){super(o,"PasswordException"),this.code=h}}class St extends Kt{constructor(o,h){super(o,"UnknownErrorException"),this.details=h}}class Gt extends Kt{constructor(o){super(o,"InvalidPDFException")}}class zt extends Kt{constructor(o){super(o,"MissingPDFException")}}class ie extends Kt{constructor(o,h){super(o,"UnexpectedResponseException"),this.status=h}}class ae extends Kt{constructor(o){super(o,"FormatError")}}class he extends Kt{constructor(o){super(o,"AbortException")}}function ye(d){(typeof d!="object"||(d==null?void 0:d.length)===void 0)&&Ct("Invalid argument for bytesToString");const o=d.length,h=8192;if(o<h)return String.fromCharCode.apply(null,d);const x=[];for(let S=0;S<o;S+=h){const K=Math.min(S+h,o),Y=d.subarray(S,K);x.push(String.fromCharCode.apply(null,Y))}return x.join("")}function Oe(d){typeof d!="string"&&Ct("Invalid argument for stringToBytes");const o=d.length,h=new Uint8Array(o);for(let x=0;x<o;++x)h[x]=d.charCodeAt(x)&255;return h}function ce(d){return String.fromCharCode(d>>24&255,d>>16&255,d>>8&255,d&255)}function fe(d){const o=Object.create(null);for(const[h,x]of d)o[h]=x;return o}function ne(){const d=new Uint8Array(4);return d[0]=1,new Uint32Array(d.buffer,0,1)[0]===1}function re(){try{return new Function(""),!0}catch{return!1}}class Re{static get isLittleEndian(){return $t(this,"isLittleEndian",ne())}static get isEvalSupported(){return $t(this,"isEvalSupported",re())}static get isOffscreenCanvasSupported(){return $t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?$t(this,"platform",{isMac:navigator.platform.includes("Mac")}):$t(this,"platform",{isMac:!1})}static get isCSSRoundSupported(){var o,h;return $t(this,"isCSSRoundSupported",(h=(o=globalThis.CSS)==null?void 0:o.supports)==null?void 0:h.call(o,"width: round(1.5px, 1px)"))}}const Yt=Array.from(Array(256).keys(),d=>d.toString(16).padStart(2,"0"));class Be{static makeHexColor(o,h,x){return`#${Yt[o]}${Yt[h]}${Yt[x]}`}static scaleMinMax(o,h){let x;o[0]?(o[0]<0&&(x=h[0],h[0]=h[2],h[2]=x),h[0]*=o[0],h[2]*=o[0],o[3]<0&&(x=h[1],h[1]=h[3],h[3]=x),h[1]*=o[3],h[3]*=o[3]):(x=h[0],h[0]=h[1],h[1]=x,x=h[2],h[2]=h[3],h[3]=x,o[1]<0&&(x=h[1],h[1]=h[3],h[3]=x),h[1]*=o[1],h[3]*=o[1],o[2]<0&&(x=h[0],h[0]=h[2],h[2]=x),h[0]*=o[2],h[2]*=o[2]),h[0]+=o[4],h[1]+=o[5],h[2]+=o[4],h[3]+=o[5]}static transform(o,h){return[o[0]*h[0]+o[2]*h[1],o[1]*h[0]+o[3]*h[1],o[0]*h[2]+o[2]*h[3],o[1]*h[2]+o[3]*h[3],o[0]*h[4]+o[2]*h[5]+o[4],o[1]*h[4]+o[3]*h[5]+o[5]]}static applyTransform(o,h){const x=o[0]*h[0]+o[1]*h[2]+h[4],S=o[0]*h[1]+o[1]*h[3]+h[5];return[x,S]}static applyInverseTransform(o,h){const x=h[0]*h[3]-h[1]*h[2],S=(o[0]*h[3]-o[1]*h[2]+h[2]*h[5]-h[4]*h[3])/x,K=(-o[0]*h[1]+o[1]*h[0]+h[4]*h[1]-h[5]*h[0])/x;return[S,K]}static getAxialAlignedBoundingBox(o,h){const x=this.applyTransform(o,h),S=this.applyTransform(o.slice(2,4),h),K=this.applyTransform([o[0],o[3]],h),Y=this.applyTransform([o[2],o[1]],h);return[Math.min(x[0],S[0],K[0],Y[0]),Math.min(x[1],S[1],K[1],Y[1]),Math.max(x[0],S[0],K[0],Y[0]),Math.max(x[1],S[1],K[1],Y[1])]}static inverseTransform(o){const h=o[0]*o[3]-o[1]*o[2];return[o[3]/h,-o[1]/h,-o[2]/h,o[0]/h,(o[2]*o[5]-o[4]*o[3])/h,(o[4]*o[1]-o[5]*o[0])/h]}static singularValueDecompose2dScale(o){const h=[o[0],o[2],o[1],o[3]],x=o[0]*h[0]+o[1]*h[2],S=o[0]*h[1]+o[1]*h[3],K=o[2]*h[0]+o[3]*h[2],Y=o[2]*h[1]+o[3]*h[3],gt=(x+Y)/2,mt=Math.sqrt((x+Y)**2-4*(x*Y-K*S))/2,ot=gt+mt||1,At=gt-mt||1;return[Math.sqrt(ot),Math.sqrt(At)]}static normalizeRect(o){const h=o.slice(0);return o[0]>o[2]&&(h[0]=o[2],h[2]=o[0]),o[1]>o[3]&&(h[1]=o[3],h[3]=o[1]),h}static intersect(o,h){const x=Math.max(Math.min(o[0],o[2]),Math.min(h[0],h[2])),S=Math.min(Math.max(o[0],o[2]),Math.max(h[0],h[2]));if(x>S)return null;const K=Math.max(Math.min(o[1],o[3]),Math.min(h[1],h[3])),Y=Math.min(Math.max(o[1],o[3]),Math.max(h[1],h[3]));return K>Y?null:[x,K,S,Y]}static bezierBoundingBox(o,h,x,S,K,Y,gt,mt,ot){return ot?(ot[0]=Math.min(ot[0],o,gt),ot[1]=Math.min(ot[1],h,mt),ot[2]=Math.max(ot[2],o,gt),ot[3]=Math.max(ot[3],h,mt)):ot=[Math.min(o,gt),Math.min(h,mt),Math.max(o,gt),Math.max(h,mt)],v(this,p,tr).call(this,o,x,K,gt,h,S,Y,mt,3*(-o+3*(x-K)+gt),6*(o-2*x+K),3*(x-o),ot),v(this,p,tr).call(this,o,x,K,gt,h,S,Y,mt,3*(-h+3*(S-Y)+mt),6*(h-2*S+Y),3*(S-h),ot),ot}}g=new WeakSet,en=function(o,h,x,S,K,Y,gt,mt,ot,At){if(ot<=0||ot>=1)return;const E=1-ot,R=ot*ot,Q=R*ot,W=E*(E*(E*o+3*ot*h)+3*R*x)+Q*S,vt=E*(E*(E*K+3*ot*Y)+3*R*gt)+Q*mt;At[0]=Math.min(At[0],W),At[1]=Math.min(At[1],vt),At[2]=Math.max(At[2],W),At[3]=Math.max(At[3],vt)},p=new WeakSet,tr=function(o,h,x,S,K,Y,gt,mt,ot,At,E,R){if(Math.abs(ot)<1e-12){Math.abs(At)>=1e-12&&v(this,g,en).call(this,o,h,x,S,K,Y,gt,mt,-E/At,R);return}const Q=At**2-4*E*ot;if(Q<0)return;const W=Math.sqrt(Q),vt=2*ot;v(this,g,en).call(this,o,h,x,S,K,Y,gt,mt,(-At+W)/vt,R),v(this,g,en).call(this,o,h,x,S,K,Y,gt,mt,(-At-W)/vt,R)},r(Be,g),r(Be,p);function te(d){return decodeURIComponent(escape(d))}let q=null,s=null;function i(d){return q||(q=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,s=new Map([["\uFB05","\u017Ft"]])),d.replaceAll(q,(o,h,x)=>h?h.normalize("NFKC"):s.get(x))}function a(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const d=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(d);else for(let o=0;o<32;o++)d[o]=Math.floor(Math.random()*255);return ye(d)}const l="pdfjs_internal_id_",n={BEZIER_CURVE_TO:0,MOVE_TO:1,LINE_TO:2,QUADRATIC_CURVE_TO:3,RESTORE:4,SAVE:5,SCALE:6,TRANSFORM:7,TRANSLATE:8}}},ke={};function Pe(le){var Wt=ke[le];if(Wt!==void 0)return Wt.exports;var ut=ke[le]={exports:{}};return Ne[le](ut,ut.exports,Pe),ut.exports}(()=>{var le=typeof Symbol=="function"?Symbol("webpack queues"):"__webpack_queues__",Wt=typeof Symbol=="function"?Symbol("webpack exports"):"__webpack_exports__",ut=typeof Symbol=="function"?Symbol("webpack error"):"__webpack_error__",c=U=>{U&&U.d<1&&(U.d=1,U.forEach(nt=>nt.r--),U.forEach(nt=>nt.r--?nt.r++:nt()))},at=U=>U.map(nt=>{if(nt!==null&&typeof nt=="object"){if(nt[le])return nt;if(nt.then){var bt=[];bt.d=0,nt.then(k=>{V[Wt]=k,c(bt)},k=>{V[ut]=k,c(bt)});var V={};return V[le]=k=>k(bt),V}}var O={};return O[le]=k=>{},O[Wt]=nt,O});Pe.a=(U,nt,bt)=>{var V;bt&&((V=[]).d=-1);var O=new Set,k=U.exports,j,I,C,F=new Promise((D,z)=>{C=z,I=D});F[Wt]=k,F[le]=D=>(V&&D(V),O.forEach(D),F.catch(z=>{})),U.exports=F,nt(D=>{j=at(D);var z,pt=()=>j.map(L=>{if(L[ut])throw L[ut];return L[Wt]}),tt=new Promise(L=>{z=()=>L(pt),z.r=0;var N=T=>T!==V&&!O.has(T)&&(O.add(T),T&&!T.d&&(z.r++,T.push(z)));j.map(T=>T[le](N))});return z.r?tt:pt()},D=>(D?C(F[ut]=D):I(k),c(V))),V&&V.d<0&&(V.d=0)}})(),Pe.d=(le,Wt)=>{for(var ut in Wt)Pe.o(Wt,ut)&&!Pe.o(le,ut)&&Object.defineProperty(le,ut,{enumerable:!0,get:Wt[ut]})},Pe.o=(le,Wt)=>Object.prototype.hasOwnProperty.call(le,Wt);var oe=Pe(228);oe=globalThis.pdfjsLib=await(globalThis.pdfjsLibPromise=oe),nr=oe.AbortException,rr=oe.AnnotationEditorLayer,ar=oe.AnnotationEditorParamsType,or=oe.AnnotationEditorType,hr=oe.AnnotationEditorUIManager,lr=oe.AnnotationLayer,cr=oe.AnnotationMode,dr=oe.CMapCompressionType,ur=oe.ColorPicker,pr=oe.DOMSVGFactory,gr=oe.DrawLayer,fr=oe.FeatureTest,mr=oe.GlobalWorkerOptions,Ar=oe.ImageKind,br=oe.InvalidPDFException,vr=oe.MissingPDFException,yr=oe.OPS,wr=oe.Outliner,Er=oe.PDFDataRangeTransport,_r=oe.PDFDateString,xr=oe.PDFWorker,Sr=oe.PasswordResponses,Cr=oe.PermissionFlag,Tr=oe.PixelsPerInch,Mr=oe.RenderingCancelledException,Rr=oe.UnexpectedResponseException,Lr=oe.Util,kr=oe.VerbosityLevel,Pr=oe.XfaLayer,Ir=oe.build,Dr=oe.createValidAbsoluteUrl,Fr=oe.fetchData,Nr=oe.getDocument,Or=oe.getFilenameFromUrl,Br=oe.getPdfFilenameFromUrl,Ur=oe.getXfaPageViewport,Hr=oe.isDataScheme,zr=oe.isPdfFile,Vr=oe.noContextMenu,jr=oe.normalizeUnicode,qr=oe.renderTextLayer,Gr=oe.setLayerDimensions,Wr=oe.shadow,$r=oe.updateTextLayer,Xr=oe.version});export{nr as AbortException,rr as AnnotationEditorLayer,ar as AnnotationEditorParamsType,or as AnnotationEditorType,hr as AnnotationEditorUIManager,lr as AnnotationLayer,cr as AnnotationMode,dr as CMapCompressionType,ur as ColorPicker,pr as DOMSVGFactory,gr as DrawLayer,fr as FeatureTest,mr as GlobalWorkerOptions,Ar as ImageKind,br as InvalidPDFException,vr as MissingPDFException,yr as OPS,wr as Outliner,Er as PDFDataRangeTransport,_r as PDFDateString,xr as PDFWorker,Sr as PasswordResponses,Cr as PermissionFlag,Tr as PixelsPerInch,Mr as RenderingCancelledException,Rr as UnexpectedResponseException,Lr as Util,kr as VerbosityLevel,Pr as XfaLayer,co as __tla,Ir as build,Dr as createValidAbsoluteUrl,Fr as fetchData,Nr as getDocument,Or as getFilenameFromUrl,Br as getPdfFilenameFromUrl,Ur as getXfaPageViewport,Hr as isDataScheme,zr as isPdfFile,Vr as noContextMenu,jr as normalizeUnicode,qr as renderTextLayer,Gr as setLayerDimensions,Wr as shadow,$r as updateTextLayer,Xr as version};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-J3ZDATS2.js","assets/index-bP9NuxJY.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
