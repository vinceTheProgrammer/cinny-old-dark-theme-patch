async function r(e){return new Promise(t=>{const s=Math.random().toString(36),n=i=>{i.data.responseKey===s&&(t(i.data.token),self.removeEventListener("message",n))};self.addEventListener("message",n),e.postMessage({responseKey:s,type:"token"})})}function a(e){if(e)return{headers:{Authorization:`Bearer ${e}`},cache:"default"}}self.addEventListener("activate",e=>{e.waitUntil(clients.claim())});self.addEventListener("fetch",e=>{const{url:t,method:s}=e.request;s==="GET"&&(!t.includes("/_matrix/client/v1/media/download")&&!t.includes("/_matrix/client/v1/media/thumbnail")||e.respondWith((async()=>{const n=await self.clients.get(e.clientId);let i;return n&&(i=await r(n)),fetch(t,a(i))})()))});
//# sourceMappingURL=sw.js.map
